<style type="text/css" >
.more-decls {
    padding-left: 50px;
}
.anal-decl {
 background-color: #F7A41D77;
}
code {
 background-color: #F7A41D77;
}
</style><style type="text/css" >
pre > code {
  display: block;
  overflow: auto;
  padding: 0.5em;
  color: black;
}

details {
  margin-bottom: 0.5em;
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Old versions of Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome, Edge, Opera and Firefox */
}

.tok {
  color: #333;
  font-style: normal;
}

.code {
  font-family: monospace;
  font-size: 0.8em;
}

.tok-kw {
  color: #333;
  font-weight: bold;
}

.tok-str {
  color: #d14;
}

.tok-builtin {
  color: #0086b3;
}

code.zig {
  color: #777;
  font-style: italic;
}

.tok-fn {
  color: #900;
  font-weight: bold;
}

.tok-null {
  color: #008080;
}

.tok-number {
  color: #008080;
}

.tok-type {
  color: #458;
  font-weight: bold;
}
</style><html><a href="null//fs/file.zig"><h1>/fs/file.zig</h1></a><div class="more-decls"></div><h2 style="color: orange;">types:</h2><div class="more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">File</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>The OS-specific file descriptor or file handle.
</b><pre><code class="zig"><span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><b>On some systems, such as Linux, file system file descriptors are incapable of non-blocking I/O.
This forces us to perform asynchronous I/O on a dedicated thread, to achieve non-blocking
file-system I/O. To do this, `File` must be aware of whether it is a file system file descriptor,
or, more specifically, whether the I/O is always blocking.
</b><pre><code class="zig"><span class="tok">capable_io_mode</span><span class="tok tok-symbol">:</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">ModeOverride</span> <span class="tok tok-symbol">=</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">default_mode</span></code></pre></div><div class="anal-decl"><b>Furthermore, even when `std.io.mode` is async, it is still sometimes desirable to perform blocking I/O,
although not by default. For example, when printing a stack trace to stderr.
This field tracks both by acting as an overriding I/O mode. When not building in async I/O mode,
the type only has the `.blocking` tag, making it a zero-bit type.
</b><pre><code class="zig"><span class="tok">intended_io_mode</span><span class="tok tok-symbol">:</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">ModeOverride</span> <span class="tok tok-symbol">=</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">default_mode</span></code></pre></div></div></details><details><summary>types:</summary><div class="md-types more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Kind</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">BlockDevice</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">CharacterDevice</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Directory</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">NamedPipe</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">SymLink</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">File</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">UnixDomainSocket</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Whiteout</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Unknown</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Lock</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">None</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Shared</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Exclusive</span></code></pre></div></div></details></div><div class="anal-decl"><b>TODO https://github.com/ziglang/zig/issues/3802
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">OpenFlags</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">read</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">true</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">write</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div><div class="anal-decl"><b>Open the file with a lock to prevent other processes from accessing it at the
same time. An exclusive lock will prevent other processes from acquiring a lock.
A shared lock will prevent other processes from acquiring a exclusive lock, but
doesn't prevent other process from getting their own shared locks.

Note that the lock is only advisory on Linux, except in very specific cirsumstances[1].
This means that a process that does not respect the locking API can still get access
to the file, despite the lock.

Windows' file locks are mandatory, and any process attempting to access the file will
receive an error.

[1]: https://www.kernel.org/doc/Documentation/filesystems/mandatory-locking.txt
</b><pre><code class="zig"><span class="tok">lock</span><span class="tok tok-symbol">:</span> <span class="tok">Lock</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">.</span><span class="tok">None</span></code></pre></div><div class="anal-decl"><b>Sets whether or not to wait until the file is locked to return. If set to true,
`error.WouldBlock` will be returned. Otherwise, the file will wait until the file
is available to proceed.
In async I/O mode, non-blocking at the OS level is
determined by `intended_io_mode`, and `true` means `error.WouldBlock` is returned,
and `false` means `error.WouldBlock` is handled by the event loop.
</b><pre><code class="zig"><span class="tok">lock_nonblocking</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div><div class="anal-decl"><b>Setting this to `.blocking` prevents `O_NONBLOCK` from being passed even
if `std.io.is_async`. It allows the use of `nosuspend` when calling functions
related to opening the file, reading, writing, and locking.
</b><pre><code class="zig"><span class="tok">intended_io_mode</span><span class="tok tok-symbol">:</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">ModeOverride</span> <span class="tok tok-symbol">=</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">default_mode</span></code></pre></div><div class="anal-decl"><b>Set this to allow the opened file to automatically become the
controlling TTY for the current process.
</b><pre><code class="zig"><span class="tok">allow_ctty</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div></div></details></div><div class="anal-decl"><b>TODO https://github.com/ziglang/zig/issues/3802
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">CreateFlags</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>Whether the file will be created with read access.
</b><pre><code class="zig"><span class="tok">read</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div><div class="anal-decl"><b>If the file already exists, and is a regular file, and the access
mode allows writing, it will be truncated to length 0.
</b><pre><code class="zig"><span class="tok">truncate</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">true</span></code></pre></div><div class="anal-decl"><b>Ensures that this open call creates the file, otherwise causes
`error.PathAlreadyExists` to be returned.
</b><pre><code class="zig"><span class="tok">exclusive</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div><div class="anal-decl"><b>Open the file with a lock to prevent other processes from accessing it at the
same time. An exclusive lock will prevent other processes from acquiring a lock.
A shared lock will prevent other processes from acquiring a exclusive lock, but
doesn't prevent other process from getting their own shared locks.

Note that the lock is only advisory on Linux, except in very specific cirsumstances[1].
This means that a process that does not respect the locking API can still get access
to the file, despite the lock.

Windows's file locks are mandatory, and any process attempting to access the file will
receive an error.

[1]: https://www.kernel.org/doc/Documentation/filesystems/mandatory-locking.txt
</b><pre><code class="zig"><span class="tok">lock</span><span class="tok tok-symbol">:</span> <span class="tok">Lock</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">.</span><span class="tok">None</span></code></pre></div><div class="anal-decl"><b>Sets whether or not to wait until the file is locked to return. If set to true,
`error.WouldBlock` will be returned. Otherwise, the file will wait until the file
is available to proceed.
In async I/O mode, non-blocking at the OS level is
determined by `intended_io_mode`, and `true` means `error.WouldBlock` is returned,
and `false` means `error.WouldBlock` is handled by the event loop.
</b><pre><code class="zig"><span class="tok">lock_nonblocking</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div><div class="anal-decl"><b>For POSIX systems this is the file system mode the file will
be created with.
</b><pre><code class="zig"><span class="tok">mode</span><span class="tok tok-symbol">:</span> <span class="tok">Mode</span> <span class="tok tok-symbol">=</span> <span class="tok">default_mode</span></code></pre></div><div class="anal-decl"><b>Setting this to `.blocking` prevents `O_NONBLOCK` from being passed even
if `std.io.is_async`. It allows the use of `nosuspend` when calling functions
related to opening the file, reading, writing, and locking.
</b><pre><code class="zig"><span class="tok">intended_io_mode</span><span class="tok tok-symbol">:</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">ModeOverride</span> <span class="tok tok-symbol">=</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">default_mode</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Stat</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>A number that the system uses to point to the file metadata. This number is not guaranteed to be
unique across time, as some file systems may reuse an inode after its file has been deleted.
Some systems may change the inode of a file over time.

On Linux, the inode is a structure that stores the metadata, and the inode _number_ is what
you see here: the index number of the inode.

The FileIndex on Windows is similar. It is a number for a file that is unique to each filesystem.
</b><pre><code class="zig"><span class="tok">inode</span><span class="tok tok-symbol">:</span> <span class="tok">INode</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">mode</span><span class="tok tok-symbol">:</span> <span class="tok">Mode</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">kind</span><span class="tok tok-symbol">:</span> <span class="tok">Kind</span></code></pre></div><div class="anal-decl"><b>Access time in nanoseconds, relative to UTC 1970-01-01.
</b><pre><code class="zig"><span class="tok">atime</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i128</span></code></pre></div><div class="anal-decl"><b>Last modification time in nanoseconds, relative to UTC 1970-01-01.
</b><pre><code class="zig"><span class="tok">mtime</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i128</span></code></pre></div><div class="anal-decl"><b>Creation time in nanoseconds, relative to UTC 1970-01-01.
</b><pre><code class="zig"><span class="tok">ctime</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i128</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">WriteFileOptions</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">in_offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span></code></pre></div><div class="anal-decl"><b>`null` means the entire file. `0` means no bytes from the file.
When this is `null`, trailers must be sent in a separate writev() call
due to a flaw in the BSD sendfile API. Other operating systems, such as
Linux, already do this anyway due to API limitations.
If the size of the source file is known, passing the size here will save one syscall.
</b><pre><code class="zig"><span class="tok">in_len</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">u64</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">headers_and_trailers</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec_const</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">&amp;</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec_const</span><span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>The trailer count is inferred from `headers_and_trailers.len - header_count`
</b><pre><code class="zig"><span class="tok">header_count</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span></code></pre></div></div></details></div></div></details><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><b>Upon success, the stream is in an uninitialized state. To continue using it,
you must use the open() function.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">close</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Test whether the file refers to a terminal.
See also `supportsAnsiEscapeCodes`.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">isTty</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">isatty</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">handle</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Test whether ANSI escape codes will be treated as such.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">supportsAnsiEscapeCodes</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">bool</span></code></pre></div><div class="anal-decl"><b>Shrinks or expands the file.
The file offset after this call is left unchanged.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">setEndPos</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">length</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">SetEndPosError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">try</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">ftruncate</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">handle</span><span class="tok tok-symbol">,</span> <span class="tok">length</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Repositions read/write file offset relative to the current offset.
TODO: integrate with async I/O
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">seekBy</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i64</span><span class="tok tok-symbol">)</span> <span class="tok">SeekError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">lseek_CUR</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">handle</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Repositions read/write file offset relative to the end.
TODO: integrate with async I/O
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">seekFromEnd</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i64</span><span class="tok tok-symbol">)</span> <span class="tok">SeekError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">lseek_END</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">handle</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Repositions read/write file offset relative to the beginning.
TODO: integrate with async I/O
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">seekTo</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">SeekError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">lseek_SET</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">handle</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>TODO: integrate with async I/O
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">getPos</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok">GetSeekPosError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">u64</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">lseek_CUR_get</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">handle</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>TODO: integrate with async I/O
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">getEndPos</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok">GetSeekPosError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">u64</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span> <span class="tok tok-symbol">==</span> <span class="tok tok-symbol">.</span><span class="tok">windows</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok tok-kw">return</span> <span class="tok">windows</span><span class="tok tok-symbol">.</span><span class="tok">GetFileSizeEx</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">handle</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-symbol">}</span>
    <span class="tok tok-kw">return</span> <span class="tok tok-symbol">(</span><span class="tok tok-kw">try</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">stat</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">size</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>TODO: integrate with async I/O
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">mode</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok">ModeError</span><span class="tok tok-symbol">!</span><span class="tok">Mode</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span> <span class="tok tok-symbol">==</span> <span class="tok tok-symbol">.</span><span class="tok">windows</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok tok-kw">return</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-symbol">}</span>
    <span class="tok tok-kw">return</span> <span class="tok tok-symbol">(</span><span class="tok tok-kw">try</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">stat</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">mode</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>TODO: integrate with async I/O
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">stat</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok">StatError</span><span class="tok tok-symbol">!</span><span class="tok">Stat</span></code></pre></div><div class="anal-decl"><b>The underlying file system may have a different granularity than nanoseconds,
and therefore this function cannot guarantee any precision will be stored.
Further, the maximum value is limited by the system ABI. When a value is provided
that exceeds this range, the value is clamped to the maximum.
TODO: integrate with async I/O
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">updateTimes</span><span class="tok tok-symbol">(</span>
    <span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-comment">/// access timestamp in nanoseconds</span>
    <span class="tok">atime</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i128</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-comment">/// last modification timestamp in nanoseconds</span>
    <span class="tok">mtime</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i128</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">UpdateTimesError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Reads all the bytes from the current position to the end of the file.
On success, caller owns returned buffer.
If the file is larger than `max_bytes`, returns `error.FileTooBig`.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">readToEndAlloc</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span> <span class="tok">max_bytes</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">readToEndAllocOptions</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">,</span> <span class="tok">max_bytes</span><span class="tok tok-symbol">,</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">,</span> <span class="tok tok-builtin">@alignOf</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Reads all the bytes from the current position to the end of the file.
On success, caller owns returned buffer.
If the file is larger than `max_bytes`, returns `error.FileTooBig`.
If `size_hint` is specified the initial buffer size is calculated using
that value, otherwise an arbitrary value is used instead.
Allows specifying alignment and a sentinel value.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">readToEndAllocOptions</span><span class="tok tok-symbol">(</span>
    <span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span>
    <span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span>
    <span class="tok">max_bytes</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
    <span class="tok">size_hint</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-kw">comptime</span> <span class="tok">alignment</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u29</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-kw">comptime</span> <span class="tok">optional_sentinel</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">optional_sentinel</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span><span class="tok">s</span><span class="tok tok-symbol">|</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">:</span><span class="tok">s</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok">alignment</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">u8</span> <span class="tok tok-kw">else</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok">alignment</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">read</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">ReadError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>Returns the number of bytes read. If the number read is smaller than `buffer.len`, it
means the file reached the end. Reaching the end of a file is not an error condition.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">readAll</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">ReadError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">pread</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">PReadError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>Returns the number of bytes read. If the number read is smaller than `buffer.len`, it
means the file reached the end. Reaching the end of a file is not an error condition.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">preadAll</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">PReadError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>See https://github.com/ziglang/zig/issues/7699
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">readv</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">iovecs</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec</span><span class="tok tok-symbol">)</span> <span class="tok">ReadError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>Returns the number of bytes read. If the number read is smaller than the total bytes
from all the buffers, it means the file reached the end. Reaching the end of a file
is not an error condition.
The `iovecs` parameter is mutable because this function needs to mutate the fields in
order to handle partial reads from the underlying OS layer.
See https://github.com/ziglang/zig/issues/7699
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">readvAll</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">iovecs</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec</span><span class="tok tok-symbol">)</span> <span class="tok">ReadError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>See https://github.com/ziglang/zig/issues/7699
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">preadv</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">iovecs</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">PReadError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>Returns the number of bytes read. If the number read is smaller than the total bytes
from all the buffers, it means the file reached the end. Reaching the end of a file
is not an error condition.
The `iovecs` parameter is mutable because this function needs to mutate the fields in
order to handle partial reads from the underlying OS layer.
See https://github.com/ziglang/zig/issues/7699
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">preadvAll</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">iovecs</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">PReadError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">write</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">bytes</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">WriteError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">writeAll</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">bytes</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">WriteError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">var</span> <span class="tok">index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok">index</span> <span class="tok tok-symbol">&lt;</span> <span class="tok">bytes</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok">index</span> <span class="tok tok-symbol">+=</span> <span class="tok tok-kw">try</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">write</span><span class="tok tok-symbol">(</span><span class="tok">bytes</span><span class="tok tok-symbol">[</span><span class="tok">index</span><span class="tok tok-symbol">..</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-symbol">}</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">pwrite</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">bytes</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">PWriteError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">pwriteAll</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">bytes</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">PWriteError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">var</span> <span class="tok">index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok">index</span> <span class="tok tok-symbol">&lt;</span> <span class="tok">bytes</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok">index</span> <span class="tok tok-symbol">+=</span> <span class="tok tok-kw">try</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">pwrite</span><span class="tok tok-symbol">(</span><span class="tok">bytes</span><span class="tok tok-symbol">[</span><span class="tok">index</span><span class="tok tok-symbol">..</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span> <span class="tok tok-symbol">+</span> <span class="tok">index</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-symbol">}</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>See https://github.com/ziglang/zig/issues/7699
See equivalent function: `std.net.Stream.writev`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">writev</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">iovecs</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec_const</span><span class="tok tok-symbol">)</span> <span class="tok">WriteError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>The `iovecs` parameter is mutable because this function needs to mutate the fields in
order to handle partial writes from the underlying OS layer.
See https://github.com/ziglang/zig/issues/7699
See equivalent function: `std.net.Stream.writevAll`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">writevAll</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">iovecs</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec_const</span><span class="tok tok-symbol">)</span> <span class="tok">WriteError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>See https://github.com/ziglang/zig/issues/7699
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">pwritev</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">iovecs</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec_const</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">PWriteError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>The `iovecs` parameter is mutable because this function needs to mutate the fields in
order to handle partial writes from the underlying OS layer.
See https://github.com/ziglang/zig/issues/7699
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">pwritevAll</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">iovecs</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">iovec_const</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">PWriteError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">copyRange</span><span class="tok tok-symbol">(</span><span class="tok">in</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">in_offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span> <span class="tok">out</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">out_offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span> <span class="tok">len</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">CopyRangeError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">u64</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">adjusted_len</span> <span class="tok tok-symbol">=</span> <span class="tok">math</span><span class="tok tok-symbol">.</span><span class="tok">cast</span><span class="tok tok-symbol">(</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">len</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok">math</span><span class="tok tok-symbol">.</span><span class="tok">maxInt</span><span class="tok tok-symbol">(</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">const</span> <span class="tok">result</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">copy_file_range</span><span class="tok tok-symbol">(</span><span class="tok">in</span><span class="tok tok-symbol">.</span><span class="tok">handle</span><span class="tok tok-symbol">,</span> <span class="tok">in_offset</span><span class="tok tok-symbol">,</span> <span class="tok">out</span><span class="tok tok-symbol">.</span><span class="tok">handle</span><span class="tok tok-symbol">,</span> <span class="tok">out_offset</span><span class="tok tok-symbol">,</span> <span class="tok">adjusted_len</span><span class="tok tok-symbol">,</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">result</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Returns the number of bytes copied. If the number read is smaller than `buffer.len`, it
means the in file reached the end. Reaching the end of a file is not an error condition.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">copyRangeAll</span><span class="tok tok-symbol">(</span><span class="tok">in</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">in_offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span> <span class="tok">out</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">out_offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span> <span class="tok">len</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">CopyRangeError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">writeFileAll</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">in_file</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok">WriteFileOptions</span><span class="tok tok-symbol">)</span> <span class="tok">WriteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Does not try seeking in either of the File parameters.
See `writeFileAll` as an alternative to calling this.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">writeFileAllUnseekable</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">in_file</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok">WriteFileOptions</span><span class="tok tok-symbol">)</span> <span class="tok">WriteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">reader</span><span class="tok tok-symbol">(</span><span class="tok">file</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok">Reader</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok tok-symbol">.</span><span class="tok tok-symbol">{</span> <span class="tok tok-symbol">.</span><span class="tok">context</span> <span class="tok tok-symbol">=</span> <span class="tok">file</span> <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">writer</span><span class="tok tok-symbol">(</span><span class="tok">file</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok">Writer</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok tok-symbol">.</span><span class="tok tok-symbol">{</span> <span class="tok tok-symbol">.</span><span class="tok">context</span> <span class="tok tok-symbol">=</span> <span class="tok">file</span> <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">seekableStream</span><span class="tok tok-symbol">(</span><span class="tok">file</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok">SeekableStream</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok tok-symbol">.</span><span class="tok tok-symbol">{</span> <span class="tok tok-symbol">.</span><span class="tok">context</span> <span class="tok tok-symbol">=</span> <span class="tok">file</span> <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div></div></details><details><summary>values:</summary><div class="md-vals more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">Mode</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">mode_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">INode</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">ino_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">default_mode</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok tok-symbol">.</span><span class="tok">windows</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-symbol">.</span><span class="tok">wasi</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-number">0o666</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">OpenError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
        <span class="tok">SharingViolation</span><span class="tok tok-symbol">,</span>
        <span class="tok">PathAlreadyExists</span><span class="tok tok-symbol">,</span>
        <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
        <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
        <span class="tok">PipeBusy</span><span class="tok tok-symbol">,</span>
        <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-comment">/// On Windows, file paths must be valid Unicode.</span>
        <span class="tok">InvalidUtf8</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-comment">/// On Windows, file paths cannot contain these characters:</span>
        <span class="tok tok-comment">/// '/', '*', '?', '&quot;', '&lt;', '&gt;', '|'</span>
        <span class="tok">BadPathName</span><span class="tok tok-symbol">,</span>
        <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span> <span class="tok tok-symbol">||</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span> <span class="tok tok-symbol">||</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">FlockError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SetEndPosError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">TruncateError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SeekError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">SeekError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetSeekPosError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">SeekError</span> <span class="tok tok-symbol">||</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">FStatError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ModeError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">FStatError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">StatError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">FStatError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">UpdateTimesError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">FutimensError</span> <span class="tok tok-symbol">||</span> <span class="tok">windows</span><span class="tok tok-symbol">.</span><span class="tok">SetFileTimeError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ReadError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">ReadError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">PReadError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">PReadError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">WriteError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">WriteError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">PWriteError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">PWriteError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">CopyRangeError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">CopyFileRangeError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">WriteFileError</span> <span class="tok tok-symbol">=</span> <span class="tok">ReadError</span> <span class="tok tok-symbol">||</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">EndOfStream</span><span class="tok tok-symbol">}</span> <span class="tok tok-symbol">||</span> <span class="tok">WriteError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">Reader</span> <span class="tok tok-symbol">=</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">Reader</span><span class="tok tok-symbol">(</span><span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">ReadError</span><span class="tok tok-symbol">,</span> <span class="tok">read</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">Writer</span> <span class="tok tok-symbol">=</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">Writer</span><span class="tok tok-symbol">(</span><span class="tok">File</span><span class="tok tok-symbol">,</span> <span class="tok">WriteError</span><span class="tok tok-symbol">,</span> <span class="tok">write</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SeekableStream</span> <span class="tok tok-symbol">=</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">SeekableStream</span><span class="tok tok-symbol">(</span>
        <span class="tok">File</span><span class="tok tok-symbol">,</span>
        <span class="tok">SeekError</span><span class="tok tok-symbol">,</span>
        <span class="tok">GetSeekPosError</span><span class="tok tok-symbol">,</span>
        <span class="tok">seekTo</span><span class="tok tok-symbol">,</span>
        <span class="tok">seekBy</span><span class="tok tok-symbol">,</span>
        <span class="tok">getPos</span><span class="tok tok-symbol">,</span>
        <span class="tok">getEndPos</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">)</span></code></pre></div></div></details></div></div><div class="more-decls"></div><div class="more-decls"></div></html>