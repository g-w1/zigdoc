<style type="text/css" >
.more-decls {
    padding-left: 50px;
}
.anal-decl {
 background-color: #F7A41D77;
}
code {
 background-color: #F7A41D77;
}
</style><style type="text/css" >
pre > code {
  display: block;
  overflow: auto;
  padding: 0.5em;
  color: black;
}

details {
  margin-bottom: 0.5em;
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Old versions of Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome, Edge, Opera and Firefox */
}

.tok {
  color: #333;
  font-style: normal;
}

.code {
  font-family: monospace;
  font-size: 0.8em;
}

.tok-kw {
  color: #333;
  font-weight: bold;
}

.tok-str {
  color: #d14;
}

.tok-builtin {
  color: #0086b3;
}

code.zig {
  color: #777;
  font-style: italic;
}

.tok-fn {
  color: #900;
  font-weight: bold;
}

.tok-null {
  color: #008080;
}

.tok-number {
  color: #008080;
}

.tok-type {
  color: #458;
  font-weight: bold;
}
</style><html><a href="null//fs.zig"><h1>/fs.zig</h1></a><div class="more-decls"></div><h2 style="color: orange;">types:</h2><div class="more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">PrevStatus</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">stale</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">fresh</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">CopyFileOptions</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>When this is `null` the mode is copied from the source file.
</b><pre><code class="zig"><span class="tok">override_mode</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">Mode</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span></code></pre></div></div></details></div><div class="anal-decl"><b>TODO update this API to avoid a getrandom syscall for every operation.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">AtomicFile</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">file</span><span class="tok tok-symbol">:</span> <span class="tok">File</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">tmp_path_buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">TMP_PATH_LEN</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">dest_basename</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">file_open</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">file_exists</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">close_dir_on_deinit</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span></code></pre></div></div></details><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><b>Note that the `Dir.atomicFile` API may be more handy than this lower-level function.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">init</span><span class="tok tok-symbol">(</span>
    <span class="tok">dest_basename</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">mode</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">Mode</span><span class="tok tok-symbol">,</span>
    <span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">close_dir_on_deinit</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">InitError</span><span class="tok tok-symbol">!</span><span class="tok">AtomicFile</span></code></pre></div><div class="anal-decl"><b>always call deinit, even after successful finish()
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">deinit</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">AtomicFile</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">finish</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">AtomicFile</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Dir</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">fd</span><span class="tok tok-symbol">:</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">fd_t</span></code></pre></div></div></details><details><summary>types:</summary><div class="md-types more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Entry</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">kind</span><span class="tok tok-symbol">:</span> <span class="tok">Kind</span></code></pre></div></div></details><details><summary>values:</summary><div class="md-vals more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">Kind</span> <span class="tok tok-symbol">=</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">OpenDirOptions</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>`true` means the opened directory can be used as the `Dir` parameter
for functions which operate based on an open directory handle. When `false`,
such operations are Illegal Behavior.
</b><pre><code class="zig"><span class="tok">access_sub_paths</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">true</span></code></pre></div><div class="anal-decl"><b>`true` means the opened directory can be scanned for the files and sub-directories
of the result. It means the `iterate` function can be called.
</b><pre><code class="zig"><span class="tok">iterate</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div><div class="anal-decl"><b>`true` means it won't dereference the symlinks.
</b><pre><code class="zig"><span class="tok">no_follow</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">AtomicFileOptions</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">mode</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">Mode</span> <span class="tok tok-symbol">=</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">default_mode</span></code></pre></div></div></details></div></div></details><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">iterate</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">)</span> <span class="tok">Iterator</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">close</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Dir</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Opens a file for reading or writing, without attempting to create a new file.
To create a new file, see `createFile`.
Call `File.close` to release the resource.
Asserts that the path parameter has no null bytes.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openFile</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><b>Same as `openFile` but WASI only.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openFileWasi</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><b>Same as `openFile` but the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openFileZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><b>Same as `openFile` but Windows-only and the path parameter is
[WTF-16](https://simonsapin.github.io/wtf-8/#potentially-ill-formed-utf-16) encoded.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openFileW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><b>Creates, opens, or overwrites a file with write access.
Call `File.close` on the result when done.
Asserts that the path parameter has no null bytes.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">createFile</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">CreateFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><b>Same as `createFile` but WASI only.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">createFileWasi</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">CreateFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><b>Same as `createFile` but the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">createFileZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">CreateFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><b>Same as `createFile` but Windows-only and the path parameter is
[WTF-16](https://simonsapin.github.io/wtf-8/#potentially-ill-formed-utf-16) encoded.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">createFileW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">CreateFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">makeDir</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">try</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">mkdirat</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">,</span> <span class="tok">default_new_dir_mode</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">makeDirZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">try</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">mkdiratZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">,</span> <span class="tok">default_new_dir_mode</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">makeDirW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">try</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">mkdiratW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">,</span> <span class="tok">default_new_dir_mode</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Calls makeDir recursively to make an entire path. Returns success if the path
already exists and is a directory.
This function is not atomic, and if it returns an error, the file system may
have been modified regardless.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">makePath</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>This function performs `makePath`, followed by `openDir`.
If supported by the OS, this operation is atomic. It is not atomic on
all operating systems.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">makeOpenPath</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">open_dir_options</span><span class="tok tok-symbol">:</span> <span class="tok">OpenDirOptions</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">Dir</span> <span class="tok tok-symbol">{</span>
    // TODO improve this implementation on Windows; we can avoid 1 call to NtClose
    <span class="tok tok-kw">try</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">makePath</span><span class="tok tok-symbol">(</span><span class="tok">sub_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">openDir</span><span class="tok tok-symbol">(</span><span class="tok">sub_path</span><span class="tok tok-symbol">,</span> <span class="tok">open_dir_options</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>This function returns the canonicalized absolute pathname of
`pathname` relative to this `Dir`. If `pathname` is absolute, ignores this
`Dir` handle and returns the canonicalized absolute pathname of `pathname`
argument.
This function is not universally supported by all platforms.
Currently supported hosts are: Linux, macOS, and Windows.
See also `Dir.realpathZ`, `Dir.realpathW`, and `Dir.realpathAlloc`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">realpath</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">pathname</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">out_buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>Same as `Dir.realpath` except `pathname` is null-terminated.
See also `Dir.realpath`, `realpathZ`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">realpathZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">pathname</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">out_buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>Windows-only. Same as `Dir.realpath` except `pathname` is WTF16 encoded.
See also `Dir.realpath`, `realpathW`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">realpathW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">pathname</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">out_buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>Same as `Dir.realpath` except caller must free the returned memory.
See also `Dir.realpath`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">realpathAlloc</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span> <span class="tok">pathname</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>Changes the current working directory to the open directory handle.
This modifies global state and can have surprising effects in multi-
threaded applications. Most applications and especially libraries should
not call this function as a general rule, however it can have use cases
in, for example, implementing a shell, or child process execution.
Not all targets support this. For example, WASI does not have the concept
of a current working directory.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">setAsCwd</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span> <span class="tok tok-symbol">==</span> <span class="tok tok-symbol">.</span><span class="tok">wasi</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;changing cwd is not currently possible in WASI&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-symbol">}</span>
    <span class="tok tok-kw">try</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">fchdir</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Opens a directory at the given path. The directory is a system resource that remains
open until `close` is called on the result.

Asserts that the path parameter has no null bytes.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openDir</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok">OpenDirOptions</span><span class="tok tok-symbol">)</span> <span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">Dir</span></code></pre></div><div class="anal-decl"><b>Same as `openDir` except only WASI.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openDirWasi</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok">OpenDirOptions</span><span class="tok tok-symbol">)</span> <span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">Dir</span></code></pre></div><div class="anal-decl"><b>Same as `openDir` except the parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openDirZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok">OpenDirOptions</span><span class="tok tok-symbol">)</span> <span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">Dir</span></code></pre></div><div class="anal-decl"><b>Same as `openDir` except the path parameter is WTF-16 encoded, NT-prefixed.
This function asserts the target OS is Windows.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openDirW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok">OpenDirOptions</span><span class="tok tok-symbol">)</span> <span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">Dir</span></code></pre></div><div class="anal-decl"><b>Delete a file name and possibly the file it refers to, based on an open directory handle.
Asserts that the path parameter has no null bytes.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteFile</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">DeleteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `deleteFile` except the parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteFileZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">DeleteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `deleteFile` except the parameter is WTF-16 encoded.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteFileW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok">DeleteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">unlinkatW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">,</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">DirNotEmpty</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span> // not passing AT_REMOVEDIR
        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">|</span><span class="tok">e</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">return</span> <span class="tok">e</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Returns `error.DirNotEmpty` if the directory is not empty.
To delete a directory recursively, see `deleteTree`.
Asserts that the path parameter has no null bytes.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteDir</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">DeleteDirError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `deleteDir` except the parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteDirZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">DeleteDirError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">unlinkatZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_c</span><span class="tok tok-symbol">,</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">AT_REMOVEDIR</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">IsDir</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span> // not possible since we pass AT_REMOVEDIR
        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">|</span><span class="tok">e</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">return</span> <span class="tok">e</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `deleteDir` except the parameter is UTF16LE, NT prefixed.
This function is Windows-only.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteDirW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok">DeleteDirError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">unlinkatW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">,</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">AT_REMOVEDIR</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">IsDir</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span> // not possible since we pass AT_REMOVEDIR
        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">|</span><span class="tok">e</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">return</span> <span class="tok">e</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Change the name or location of a file or directory.
If new_sub_path already exists, it will be replaced.
Renaming a file over an existing directory or a directory
over an existing file will fail with `error.IsDir` or `error.NotDir`
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">rename</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">RenameError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">renameat</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path</span><span class="tok tok-symbol">,</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `rename` except the parameters are null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">renameZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path_z</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path_z</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">RenameError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">renameatZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path_z</span><span class="tok tok-symbol">,</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path_z</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `rename` except the parameters are UTF16LE, NT prefixed.
This function is Windows-only.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">renameW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok">RenameError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">renameatW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path_w</span><span class="tok tok-symbol">,</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Creates a symbolic link named `sym_link_path` which contains the string `target_path`.
A symbolic link (also known as a soft link) may point to an existing file or to a nonexistent
one; the latter case is known as a dangling link.
If `sym_link_path` exists, it will not be overwritten.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">symLink</span><span class="tok tok-symbol">(</span>
    <span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">target_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">sym_link_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">SymLinkFlags</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>WASI-only. Same as `symLink` except targeting WASI.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">symLinkWasi</span><span class="tok tok-symbol">(</span>
    <span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">target_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">sym_link_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">SymLinkFlags</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `symLink`, except the pathname parameters are null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">symLinkZ</span><span class="tok tok-symbol">(</span>
    <span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">target_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">sym_link_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">SymLinkFlags</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Windows-only. Same as `symLink` except the pathname parameters
are null-terminated, WTF16 encoded.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">symLinkW</span><span class="tok tok-symbol">(</span>
    <span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">target_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span>
    <span class="tok">sym_link_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span>
    <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">SymLinkFlags</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Read value of a symbolic link.
The return value is a slice of `buffer`, from index `0`.
Asserts that the path parameter has no null bytes.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">readLink</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>WASI-only. Same as `readLink` except targeting WASI.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">readLinkWasi</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">readlinkatWasi</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `readLink`, except the `pathname` parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">readLinkZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>Windows-only. Same as `readLink` except the pathname parameter
is null-terminated, WTF16 encoded.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">readLinkW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">windows</span><span class="tok tok-symbol">.</span><span class="tok">ReadLink</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Read all of file contents using a preallocated buffer.
The returned slice has the same pointer as `buffer`. If the length matches `buffer.len`
the situation is ambiguous. It could either mean that the entire file was read, and
it exactly fits the buffer, or it could mean the buffer was not big enough for the
entire file.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">readFile</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">file_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>On success, caller owns returned buffer.
If the file is larger than `max_bytes`, returns `error.FileTooBig`.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">readFileAlloc</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span> <span class="tok">file_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">max_bytes</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">readFileAllocOptions</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">,</span> <span class="tok">file_path</span><span class="tok tok-symbol">,</span> <span class="tok">max_bytes</span><span class="tok tok-symbol">,</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">,</span> <span class="tok tok-builtin">@alignOf</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>On success, caller owns returned buffer.
If the file is larger than `max_bytes`, returns `error.FileTooBig`.
If `size_hint` is specified the initial buffer size is calculated using
that value, otherwise the effective file size is used instead.
Allows specifying alignment and a sentinel value.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">readFileAllocOptions</span><span class="tok tok-symbol">(</span>
    <span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span>
    <span class="tok">file_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">max_bytes</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
    <span class="tok">size_hint</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-kw">comptime</span> <span class="tok">alignment</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u29</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-kw">comptime</span> <span class="tok">optional_sentinel</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">optional_sentinel</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span><span class="tok">s</span><span class="tok tok-symbol">|</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">:</span><span class="tok">s</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok">alignment</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">u8</span> <span class="tok tok-kw">else</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok">alignment</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><b>Whether `full_path` describes a symlink, file, or directory, this function
removes it. If it cannot be removed because it is a non-empty directory,
this function recursively removes its entries and then tries again.
This operation is not atomic on most file systems.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteTree</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">DeleteTreeError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Writes content to the file system, creating a new file if it does not exist, truncating
if it already exists.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">writeFile</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">data</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">var</span> <span class="tok">file</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">createFile</span><span class="tok tok-symbol">(</span><span class="tok">sub_path</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">defer</span> <span class="tok">file</span><span class="tok tok-symbol">.</span><span class="tok">close</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">try</span> <span class="tok">file</span><span class="tok tok-symbol">.</span><span class="tok">writeAll</span><span class="tok tok-symbol">(</span><span class="tok">data</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Test accessing `path`.
`path` is UTF8-encoded.
Be careful of Time-Of-Check-Time-Of-Use race conditions when using this function.
For example, instead of testing if a file exists and then opening it, just
open it and handle the error for file not found.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">access</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">AccessError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `access` except the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">accessZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">AccessError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `access` except asserts the target OS is Windows and the path parameter is
* WTF-16 encoded
* null-terminated
* NtDll prefixed
TODO currently this ignores `flags`.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">accessW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">AccessError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">faccessatW</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">,</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">,</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Check the file size, mtime, and mode of `source_path` and `dest_path`. If they are equal, does nothing.
Otherwise, atomically copies `source_path` to `dest_path`. The destination file gains the mtime,
atime, and mode of the source file so that the next call to `updateFile` will not need a copy.
Returns the previous status of the file before updating.
If any of the directories do not exist for dest_path, they are created.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">updateFile</span><span class="tok tok-symbol">(</span>
    <span class="tok">source_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">source_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">dest_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">dest_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">options</span><span class="tok tok-symbol">:</span> <span class="tok">CopyFileOptions</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">PrevStatus</span></code></pre></div><div class="anal-decl"><b>Guaranteed to be atomic.
On Linux, until https://patchwork.kernel.org/patch/9636735/ is merged and readily available,
there is a possibility of power loss or application termination leaving temporary files present
in the same directory as dest_path.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">copyFile</span><span class="tok tok-symbol">(</span>
    <span class="tok">source_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">source_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">dest_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
    <span class="tok">dest_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">options</span><span class="tok tok-symbol">:</span> <span class="tok">CopyFileOptions</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Directly access the `.file` field, and then call `AtomicFile.finish`
to atomically replace `dest_path` with contents.
Always call `AtomicFile.deinit` to clean up, regardless of whether `AtomicFile.finish` succeeded.
`dest_path` must remain valid until `AtomicFile.deinit` is called.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">atomicFile</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">dest_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">options</span><span class="tok tok-symbol">:</span> <span class="tok">AtomicFileOptions</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">AtomicFile</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">stat</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">)</span> <span class="tok">StatError</span><span class="tok tok-symbol">!</span><span class="tok">Stat</span></code></pre></div></div></details><details><summary>values:</summary><div class="md-vals more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">Iterator</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok tok-symbol">.</span><span class="tok">macos</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">ios</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">freebsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">netbsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">dragonfly</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">openbsd</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">struct</span> <span class="tok tok-symbol">{</span>
            <span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
            <span class="tok">seek</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i64</span><span class="tok tok-symbol">,</span>
            <span class="tok">buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-number">8192</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> // TODO align(@alignOf(os.dirent)),
            <span class="tok">index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
            <span class="tok">end_index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>

            <span class="tok tok-kw">const</span> <span class="tok">Self</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Error</span> <span class="tok tok-symbol">=</span> <span class="tok">IteratorError</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-comment">/// Memory such as file names referenced in this returned entry becomes invalid</span>
            <span class="tok tok-comment">/// with subsequent calls to `next`, as well as when this `Dir` is deinitialized.</span>
            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">next</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Self</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">?</span><span class="tok">Entry</span> <span class="tok tok-symbol">{</span>
                <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-symbol">.</span><span class="tok">macos</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">ios</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">nextDarwin</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">.</span><span class="tok">freebsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">netbsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">dragonfly</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">openbsd</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">nextBsd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;unimplemented&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">}</span>
            <span class="tok tok-symbol">}</span>

            <span class="tok tok-kw">fn</span> <span class="tok tok-fn">nextDarwin</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Self</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">?</span><span class="tok">Entry</span> <span class="tok tok-symbol">{</span>
                <span class="tok">start_over</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok tok-null">true</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">&gt;=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">const</span> <span class="tok">rc</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">system</span><span class="tok tok-symbol">.</span><span class="tok">__getdirentries64</span><span class="tok tok-symbol">(</span>
                            <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">,</span>
                            <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">seek</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">rc</span> <span class="tok tok-symbol">==</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">return</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">rc</span> <span class="tok tok-symbol">&lt;</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                            <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">errno</span><span class="tok tok-symbol">(</span><span class="tok">rc</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                                <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EBADF</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span> // Dir is invalid or was opened without iteration ability
                                <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EFAULT</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                                <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">ENOTDIR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                                <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EINVAL</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                                <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">unexpectedErrno</span><span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-symbol">}</span>
                        <span class="tok tok-symbol">}</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@intCast</span><span class="tok tok-symbol">(</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">rc</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>
                    <span class="tok tok-kw">const</span> <span class="tok">darwin_entry</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok tok-number">1</span><span class="tok tok-symbol">)</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">dirent</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">[</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">next_index</span> <span class="tok tok-symbol">=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">+</span> <span class="tok">darwin_entry</span><span class="tok tok-symbol">.</span><span class="tok">reclen</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok">next_index</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">const</span> <span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">darwin_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_name</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok">darwin_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_namlen</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;.&quot;</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">or</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;..&quot;</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">or</span> <span class="tok tok-symbol">(</span><span class="tok">darwin_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_ino</span> <span class="tok tok-symbol">==</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">continue</span> <span class="tok tok-symbol">:</span><span class="tok">start_over</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>

                    <span class="tok tok-kw">const</span> <span class="tok">entry_kind</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">darwin_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_type</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_BLK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">BlockDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_CHR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">CharacterDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_DIR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Directory</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_FIFO</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">NamedPipe</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_LNK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">SymLink</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_REG</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">File</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_SOCK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">UnixDomainSocket</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_WHT</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Whiteout</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Unknown</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">return</span> <span class="tok">Entry</span><span class="tok tok-symbol">{</span>
                        <span class="tok tok-symbol">.</span><span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok">name</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">.</span><span class="tok">kind</span> <span class="tok tok-symbol">=</span> <span class="tok">entry_kind</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span>
            <span class="tok tok-symbol">}</span>

            <span class="tok tok-kw">fn</span> <span class="tok tok-fn">nextBsd</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Self</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">?</span><span class="tok">Entry</span> <span class="tok tok-symbol">{</span>
                <span class="tok">start_over</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok tok-null">true</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">&gt;=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">const</span> <span class="tok">rc</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span> <span class="tok tok-symbol">==</span> <span class="tok tok-symbol">.</span><span class="tok">netbsd</span><span class="tok tok-symbol">)</span>
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">system</span><span class="tok tok-symbol">.</span><span class="tok">__getdents30</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">,</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">)</span>
                        <span class="tok tok-kw">else</span>
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">system</span><span class="tok tok-symbol">.</span><span class="tok">getdents</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">,</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">errno</span><span class="tok tok-symbol">(</span><span class="tok">rc</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                            <span class="tok tok-number">0</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EBADF</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span> // Dir is invalid or was opened without iteration ability
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EFAULT</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">ENOTDIR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EINVAL</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">unexpectedErrno</span><span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">}</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">rc</span> <span class="tok tok-symbol">==</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">return</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@intCast</span><span class="tok tok-symbol">(</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">rc</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>
                    <span class="tok tok-kw">const</span> <span class="tok">bsd_entry</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok tok-number">1</span><span class="tok tok-symbol">)</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">dirent</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">[</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">next_index</span> <span class="tok tok-symbol">=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">+</span> <span class="tok">bsd_entry</span><span class="tok tok-symbol">.</span><span class="tok">reclen</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok">next_index</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">const</span> <span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">bsd_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_name</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok">bsd_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_namlen</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">const</span> <span class="tok">skip_zero_fileno</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        // d_fileno=0 is used to mark invalid entries or deleted files.
                        <span class="tok tok-symbol">.</span><span class="tok">openbsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">netbsd</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">true</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">false</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;.&quot;</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">or</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;..&quot;</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">or</span>
                        <span class="tok tok-symbol">(</span><span class="tok">skip_zero_fileno</span> <span class="tok tok-kw">and</span> <span class="tok">bsd_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_fileno</span> <span class="tok tok-symbol">==</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span>
                    <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">continue</span> <span class="tok tok-symbol">:</span><span class="tok">start_over</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>

                    <span class="tok tok-kw">const</span> <span class="tok">entry_kind</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">bsd_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_type</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_BLK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">BlockDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_CHR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">CharacterDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_DIR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Directory</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_FIFO</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">NamedPipe</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_LNK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">SymLink</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_REG</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">File</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_SOCK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">UnixDomainSocket</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_WHT</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Whiteout</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Unknown</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">return</span> <span class="tok">Entry</span><span class="tok tok-symbol">{</span>
                        <span class="tok tok-symbol">.</span><span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok">name</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">.</span><span class="tok">kind</span> <span class="tok tok-symbol">=</span> <span class="tok">entry_kind</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span>
            <span class="tok tok-symbol">}</span>
        <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-symbol">.</span><span class="tok">haiku</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">struct</span> <span class="tok tok-symbol">{</span>
            <span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
            <span class="tok">buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-number">8192</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> // TODO align(@alignOf(os.dirent64)),
            <span class="tok">index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
            <span class="tok">end_index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>

            <span class="tok tok-kw">const</span> <span class="tok">Self</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Error</span> <span class="tok tok-symbol">=</span> <span class="tok">IteratorError</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-comment">/// Memory such as file names referenced in this returned entry becomes invalid</span>
            <span class="tok tok-comment">/// with subsequent calls to `next`, as well as when this `Dir` is deinitialized.</span>
            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">next</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Self</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">?</span><span class="tok">Entry</span> <span class="tok tok-symbol">{</span>
                <span class="tok">start_over</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok tok-null">true</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    // TODO: find a better max
                    <span class="tok tok-kw">const</span> <span class="tok">HAIKU_MAX_COUNT</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">10000</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">&gt;=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">const</span> <span class="tok">rc</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">system</span><span class="tok tok-symbol">.</span><span class="tok">_kern_read_dir</span><span class="tok tok-symbol">(</span>
                            <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">,</span>
                            <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">,</span>
                            <span class="tok">HAIKU_MAX_COUNT</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">rc</span> <span class="tok tok-symbol">==</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">return</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">rc</span> <span class="tok tok-symbol">&lt;</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                            <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">errno</span><span class="tok tok-symbol">(</span><span class="tok">rc</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                                <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EBADF</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span> // Dir is invalid or was opened without iteration ability
                                <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EFAULT</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                                <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">ENOTDIR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                                <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EINVAL</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                                <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">unexpectedErrno</span><span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-symbol">}</span>
                        <span class="tok tok-symbol">}</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@intCast</span><span class="tok tok-symbol">(</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">rc</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>
                    <span class="tok tok-kw">const</span> <span class="tok">haiku_entry</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok tok-number">1</span><span class="tok tok-symbol">)</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">dirent</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">[</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">next_index</span> <span class="tok tok-symbol">=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">+</span> <span class="tok">haiku_entry</span><span class="tok tok-symbol">.</span><span class="tok">reclen</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok">next_index</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">spanZ</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">haiku_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_name</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;.&quot;</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">or</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;..&quot;</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">or</span> <span class="tok tok-symbol">(</span><span class="tok">haiku_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_ino</span> <span class="tok tok-symbol">==</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">continue</span> <span class="tok tok-symbol">:</span><span class="tok">start_over</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>

                    <span class="tok tok-kw">var</span> <span class="tok">stat_info</span><span class="tok tok-symbol">:</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">libc_stat</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">undefined</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">rc2</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">system</span><span class="tok tok-symbol">.</span><span class="tok">_kern_read_stat</span><span class="tok tok-symbol">(</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">&amp;</span><span class="tok">haiku_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_name</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-null">false</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">&amp;</span><span class="tok">stat_info</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-number">0</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">statmode</span> <span class="tok tok-symbol">=</span> <span class="tok">stat_info</span><span class="tok tok-symbol">.</span><span class="tok">mode</span> <span class="tok tok-symbol">&amp;</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">S_IFMT</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">const</span> <span class="tok">entry_kind</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">statmode</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">S_IFDIR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Directory</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">S_IFBLK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">BlockDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">S_IFCHR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">CharacterDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">S_IFLNK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">SymLink</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">S_IFREG</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">File</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">S_IFIFO</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">NamedPipe</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Unknown</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">return</span> <span class="tok">Entry</span><span class="tok tok-symbol">{</span>
                        <span class="tok tok-symbol">.</span><span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok">name</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">.</span><span class="tok">kind</span> <span class="tok tok-symbol">=</span> <span class="tok">entry_kind</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span>
            <span class="tok tok-symbol">}</span>
        <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-symbol">.</span><span class="tok">linux</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">struct</span> <span class="tok tok-symbol">{</span>
            <span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
            // The if guard is solely there to prevent compile errors from missing `os.linux.dirent64`
            // definition when compiling for other OSes. It doesn't do anything when compiling for Linux.
            <span class="tok">buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-number">8192</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-symbol">.</span><span class="tok">linux</span><span class="tok tok-symbol">)</span> <span class="tok tok-number">1</span> <span class="tok tok-kw">else</span> <span class="tok tok-builtin">@alignOf</span><span class="tok tok-symbol">(</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">linux</span><span class="tok tok-symbol">.</span><span class="tok">dirent64</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
            <span class="tok">index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
            <span class="tok">end_index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>

            <span class="tok tok-kw">const</span> <span class="tok">Self</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Error</span> <span class="tok tok-symbol">=</span> <span class="tok">IteratorError</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-comment">/// Memory such as file names referenced in this returned entry becomes invalid</span>
            <span class="tok tok-comment">/// with subsequent calls to `next`, as well as when this `Dir` is deinitialized.</span>
            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">next</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Self</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">?</span><span class="tok">Entry</span> <span class="tok tok-symbol">{</span>
                <span class="tok">start_over</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok tok-null">true</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">&gt;=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">const</span> <span class="tok">rc</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">linux</span><span class="tok tok-symbol">.</span><span class="tok">getdents64</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">,</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">linux</span><span class="tok tok-symbol">.</span><span class="tok">getErrno</span><span class="tok tok-symbol">(</span><span class="tok">rc</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                            <span class="tok tok-number">0</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EBADF</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span> // Dir is invalid or was opened without iteration ability
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EFAULT</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">ENOTDIR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                            <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">EINVAL</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">unexpectedErrno</span><span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">}</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">rc</span> <span class="tok tok-symbol">==</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">return</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span> <span class="tok tok-symbol">=</span> <span class="tok">rc</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>
                    <span class="tok tok-kw">const</span> <span class="tok">linux_entry</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok tok-number">1</span><span class="tok tok-symbol">)</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">dirent64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">[</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">next_index</span> <span class="tok tok-symbol">=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">+</span> <span class="tok">linux_entry</span><span class="tok tok-symbol">.</span><span class="tok">reclen</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok">next_index</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">const</span> <span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">spanZ</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">linux_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_name</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

                    // skip . and .. entries
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;.&quot;</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">or</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;..&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">continue</span> <span class="tok tok-symbol">:</span><span class="tok">start_over</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>

                    <span class="tok tok-kw">const</span> <span class="tok">entry_kind</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">linux_entry</span><span class="tok tok-symbol">.</span><span class="tok">d_type</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_BLK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">BlockDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_CHR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">CharacterDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_DIR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Directory</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_FIFO</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">NamedPipe</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_LNK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">SymLink</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_REG</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">File</span><span class="tok tok-symbol">,</span>
                        <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">DT_SOCK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">UnixDomainSocket</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Unknown</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">return</span> <span class="tok">Entry</span><span class="tok tok-symbol">{</span>
                        <span class="tok tok-symbol">.</span><span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok">name</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">.</span><span class="tok">kind</span> <span class="tok tok-symbol">=</span> <span class="tok">entry_kind</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span>
            <span class="tok tok-symbol">}</span>
        <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-symbol">.</span><span class="tok">windows</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">struct</span> <span class="tok tok-symbol">{</span>
            <span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
            <span class="tok">buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-number">8192</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@alignOf</span><span class="tok tok-symbol">(</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">windows</span><span class="tok tok-symbol">.</span><span class="tok">FILE_BOTH_DIR_INFORMATION</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
            <span class="tok">index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
            <span class="tok">end_index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
            <span class="tok">first</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">,</span>
            <span class="tok">name_data</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-number">256</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>

            <span class="tok tok-kw">const</span> <span class="tok">Self</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Error</span> <span class="tok tok-symbol">=</span> <span class="tok">IteratorError</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-comment">/// Memory such as file names referenced in this returned entry becomes invalid</span>
            <span class="tok tok-comment">/// with subsequent calls to `next`, as well as when this `Dir` is deinitialized.</span>
            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">next</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Self</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">?</span><span class="tok">Entry</span> <span class="tok tok-symbol">{</span>
                <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok tok-null">true</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">const</span> <span class="tok">w</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">windows</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">&gt;=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">var</span> <span class="tok">io</span><span class="tok tok-symbol">:</span> <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">IO_STATUS_BLOCK</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">undefined</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">const</span> <span class="tok">rc</span> <span class="tok tok-symbol">=</span> <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">ntdll</span><span class="tok tok-symbol">.</span><span class="tok">NtQueryDirectoryFile</span><span class="tok tok-symbol">(</span>
                            <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-null">null</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-null">null</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-null">null</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-symbol">&amp;</span><span class="tok">io</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">,</span>
                            <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-symbol">.</span><span class="tok">FileBothDirectoryInformation</span><span class="tok tok-symbol">,</span>
                            <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FALSE</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-null">null</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">first</span><span class="tok tok-symbol">)</span> <span class="tok tok-builtin">@as</span><span class="tok tok-symbol">(</span><span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">BOOLEAN</span><span class="tok tok-symbol">,</span> <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">TRUE</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">else</span> <span class="tok tok-builtin">@as</span><span class="tok tok-symbol">(</span><span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">BOOLEAN</span><span class="tok tok-symbol">,</span> <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FALSE</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">first</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">Information</span> <span class="tok tok-symbol">==</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">return</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span> <span class="tok tok-symbol">=</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">Information</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">rc</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                            <span class="tok tok-symbol">.</span><span class="tok">SUCCESS</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-symbol">.</span><span class="tok">ACCESS_DENIED</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span> // Double-check that the Dir was opened with iteration ability

                            <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">unexpectedStatus</span><span class="tok tok-symbol">(</span><span class="tok">rc</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">}</span>
                    <span class="tok tok-symbol">}</span>

                    <span class="tok tok-kw">const</span> <span class="tok">aligned_ptr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@alignCast</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@alignOf</span><span class="tok tok-symbol">(</span><span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILE_BOTH_DIR_INFORMATION</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">[</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">dir_info</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">*</span><span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILE_BOTH_DIR_INFORMATION</span><span class="tok tok-symbol">,</span> <span class="tok">aligned_ptr</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">dir_info</span><span class="tok tok-symbol">.</span><span class="tok">NextEntryOffset</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">+=</span> <span class="tok">dir_info</span><span class="tok tok-symbol">.</span><span class="tok">NextEntryOffset</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span> <span class="tok tok-kw">else</span> <span class="tok tok-symbol">{</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>

                    <span class="tok tok-kw">const</span> <span class="tok">name_utf16le</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">dir_info</span><span class="tok tok-symbol">.</span><span class="tok">FileName</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span> <span class="tok tok-symbol">..</span> <span class="tok">dir_info</span><span class="tok tok-symbol">.</span><span class="tok">FileNameLength</span> <span class="tok tok-symbol">/</span> <span class="tok tok-number">2</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">name_utf16le</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok tok-symbol">[</span><span class="tok">_</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">{</span><span class="tok tok-str">'.'</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">or</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">name_utf16le</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok tok-symbol">[</span><span class="tok">_</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">{</span> <span class="tok tok-str">'.'</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">'.'</span> <span class="tok tok-symbol">}</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span>
                        <span class="tok tok-kw">continue</span><span class="tok tok-symbol">;</span>
                    // Trust that Windows gives us valid UTF-16LE
                    <span class="tok tok-kw">const</span> <span class="tok">name_utf8_len</span> <span class="tok tok-symbol">=</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">unicode</span><span class="tok tok-symbol">.</span><span class="tok">utf16leToUtf8</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">name_data</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">,</span> <span class="tok">name_utf16le</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">name_utf8</span> <span class="tok tok-symbol">=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">name_data</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok">name_utf8_len</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">kind</span> <span class="tok tok-symbol">=</span> <span class="tok">blk</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">const</span> <span class="tok">attrs</span> <span class="tok tok-symbol">=</span> <span class="tok">dir_info</span><span class="tok tok-symbol">.</span><span class="tok">FileAttributes</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">attrs</span> <span class="tok tok-symbol">&amp;</span> <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILE_ATTRIBUTE_DIRECTORY</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">break</span> <span class="tok tok-symbol">:</span><span class="tok">blk</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Directory</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">attrs</span> <span class="tok tok-symbol">&amp;</span> <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILE_ATTRIBUTE_REPARSE_POINT</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">break</span> <span class="tok tok-symbol">:</span><span class="tok">blk</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">SymLink</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">break</span> <span class="tok tok-symbol">:</span><span class="tok">blk</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">File</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">return</span> <span class="tok">Entry</span><span class="tok tok-symbol">{</span>
                        <span class="tok tok-symbol">.</span><span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok">name_utf8</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">.</span><span class="tok">kind</span> <span class="tok tok-symbol">=</span> <span class="tok">kind</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span>
            <span class="tok tok-symbol">}</span>
        <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-symbol">.</span><span class="tok">wasi</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">struct</span> <span class="tok tok-symbol">{</span>
            <span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span>
            <span class="tok">buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-number">8192</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> // TODO align(@alignOf(os.wasi.dirent_t)),
            <span class="tok">cookie</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span>
            <span class="tok">index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
            <span class="tok">end_index</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>

            <span class="tok tok-kw">const</span> <span class="tok">Self</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Error</span> <span class="tok tok-symbol">=</span> <span class="tok">IteratorError</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-comment">/// Memory such as file names referenced in this returned entry becomes invalid</span>
            <span class="tok tok-comment">/// with subsequent calls to `next`, as well as when this `Dir` is deinitialized.</span>
            <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">next</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Self</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">?</span><span class="tok">Entry</span> <span class="tok tok-symbol">{</span>
                <span class="tok tok-kw">const</span> <span class="tok">w</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">wasi</span><span class="tok tok-symbol">;</span>
                <span class="tok">start_over</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok tok-null">true</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">&gt;=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">var</span> <span class="tok">bufused</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">undefined</span><span class="tok tok-symbol">;</span>
                        <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">fd_readdir</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">,</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">,</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">cookie</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">bufused</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                            <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">ESUCCESS</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                            <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">EBADF</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span> // Dir is invalid or was opened without iteration ability
                            <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">EFAULT</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                            <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">ENOTDIR</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                            <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">EINVAL</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">,</span>
                            <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">ENOTCAPABLE</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">unexpectedErrno</span><span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">}</span>
                        <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">bufused</span> <span class="tok tok-symbol">==</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">return</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">;</span>
                        <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">end_index</span> <span class="tok tok-symbol">=</span> <span class="tok">bufused</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>
                    <span class="tok tok-kw">const</span> <span class="tok">entry</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">align</span><span class="tok tok-symbol">(</span><span class="tok tok-number">1</span><span class="tok tok-symbol">)</span> <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">dirent_t</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">[</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">entry_size</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@sizeOf</span><span class="tok tok-symbol">(</span><span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">dirent_t</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">name_index</span> <span class="tok tok-symbol">=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">+</span> <span class="tok">entry_size</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">const</span> <span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">span</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">buf</span><span class="tok tok-symbol">[</span><span class="tok">name_index</span> <span class="tok tok-symbol">..</span> <span class="tok">name_index</span> <span class="tok tok-symbol">+</span> <span class="tok">entry</span><span class="tok tok-symbol">.</span><span class="tok">d_namlen</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

                    <span class="tok tok-kw">const</span> <span class="tok">next_index</span> <span class="tok tok-symbol">=</span> <span class="tok">name_index</span> <span class="tok tok-symbol">+</span> <span class="tok">entry</span><span class="tok tok-symbol">.</span><span class="tok">d_namlen</span><span class="tok tok-symbol">;</span>
                    <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">index</span> <span class="tok tok-symbol">=</span> <span class="tok">next_index</span><span class="tok tok-symbol">;</span>
                    <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">cookie</span> <span class="tok tok-symbol">=</span> <span class="tok">entry</span><span class="tok tok-symbol">.</span><span class="tok">d_next</span><span class="tok tok-symbol">;</span>

                    // skip . and .. entries
                    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;.&quot;</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">or</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;..&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">continue</span> <span class="tok tok-symbol">:</span><span class="tok">start_over</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span>

                    <span class="tok tok-kw">const</span> <span class="tok">entry_kind</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">entry</span><span class="tok tok-symbol">.</span><span class="tok">d_type</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILETYPE_BLOCK_DEVICE</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">BlockDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILETYPE_CHARACTER_DEVICE</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">CharacterDevice</span><span class="tok tok-symbol">,</span>
                        <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILETYPE_DIRECTORY</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Directory</span><span class="tok tok-symbol">,</span>
                        <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILETYPE_SYMBOLIC_LINK</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">SymLink</span><span class="tok tok-symbol">,</span>
                        <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILETYPE_REGULAR_FILE</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">File</span><span class="tok tok-symbol">,</span>
                        <span class="tok">w</span><span class="tok tok-symbol">.</span><span class="tok">FILETYPE_SOCKET_STREAM</span><span class="tok tok-symbol">,</span> <span class="tok">wasi</span><span class="tok tok-symbol">.</span><span class="tok">FILETYPE_SOCKET_DGRAM</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">UnixDomainSocket</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span><span class="tok tok-symbol">.</span><span class="tok">Unknown</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-kw">return</span> <span class="tok">Entry</span><span class="tok tok-symbol">{</span>
                        <span class="tok tok-symbol">.</span><span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok">name</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">.</span><span class="tok">kind</span> <span class="tok tok-symbol">=</span> <span class="tok">entry_kind</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span>
            <span class="tok tok-symbol">}</span>
        <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;unimplemented&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">OpenError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
        <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
        <span class="tok">NotDir</span><span class="tok tok-symbol">,</span>
        <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
        <span class="tok">SymLinkLoop</span><span class="tok tok-symbol">,</span>
        <span class="tok">ProcessFdQuotaExceeded</span><span class="tok tok-symbol">,</span>
        <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
        <span class="tok">SystemFdQuotaExceeded</span><span class="tok tok-symbol">,</span>
        <span class="tok">NoDevice</span><span class="tok tok-symbol">,</span>
        <span class="tok">SystemResources</span><span class="tok tok-symbol">,</span>
        <span class="tok">InvalidUtf8</span><span class="tok tok-symbol">,</span>
        <span class="tok">BadPathName</span><span class="tok tok-symbol">,</span>
        <span class="tok">DeviceBusy</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span> <span class="tok tok-symbol">||</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">UnexpectedError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">openFileC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: renamed to openFileZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">createFileC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: renamed to createFileZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">openRead</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated in favor of openFile&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">openReadC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated in favor of openFileZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">openReadW</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated in favor of openFileW&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">openDirC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: renamed to openDirZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">DeleteFileError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">UnlinkError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">deleteFileC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: renamed to deleteFileZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">DeleteDirError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
        <span class="tok">DirNotEmpty</span><span class="tok tok-symbol">,</span>
        <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
        <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
        <span class="tok">FileBusy</span><span class="tok tok-symbol">,</span>
        <span class="tok">FileSystem</span><span class="tok tok-symbol">,</span>
        <span class="tok">SymLinkLoop</span><span class="tok tok-symbol">,</span>
        <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
        <span class="tok">NotDir</span><span class="tok tok-symbol">,</span>
        <span class="tok">SystemResources</span><span class="tok tok-symbol">,</span>
        <span class="tok">ReadOnlyFileSystem</span><span class="tok tok-symbol">,</span>
        <span class="tok">InvalidUtf8</span><span class="tok tok-symbol">,</span>
        <span class="tok">BadPathName</span><span class="tok tok-symbol">,</span>
        <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">RenameError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">RenameError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">readLinkC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: renamed to readLinkZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">DeleteTreeError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
        <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
        <span class="tok">FileTooBig</span><span class="tok tok-symbol">,</span>
        <span class="tok">SymLinkLoop</span><span class="tok tok-symbol">,</span>
        <span class="tok">ProcessFdQuotaExceeded</span><span class="tok tok-symbol">,</span>
        <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
        <span class="tok">SystemFdQuotaExceeded</span><span class="tok tok-symbol">,</span>
        <span class="tok">NoDevice</span><span class="tok tok-symbol">,</span>
        <span class="tok">SystemResources</span><span class="tok tok-symbol">,</span>
        <span class="tok">ReadOnlyFileSystem</span><span class="tok tok-symbol">,</span>
        <span class="tok">FileSystem</span><span class="tok tok-symbol">,</span>
        <span class="tok">FileBusy</span><span class="tok tok-symbol">,</span>
        <span class="tok">DeviceBusy</span><span class="tok tok-symbol">,</span>

        <span class="tok tok-comment">/// One of the path components was not a directory.</span>
        <span class="tok tok-comment">/// This error is unreachable if `sub_path` does not contain a path separator.</span>
        <span class="tok">NotDir</span><span class="tok tok-symbol">,</span>

        <span class="tok tok-comment">/// On Windows, file paths must be valid Unicode.</span>
        <span class="tok">InvalidUtf8</span><span class="tok tok-symbol">,</span>

        <span class="tok tok-comment">/// On Windows, file paths cannot contain these characters:</span>
        <span class="tok tok-comment">/// '/', '*', '?', '&quot;', '&lt;', '&gt;', '|'</span>
        <span class="tok">BadPathName</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span> <span class="tok tok-symbol">||</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">UnexpectedError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">AccessError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">AccessError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">Stat</span> <span class="tok tok-symbol">=</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">Stat</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">StatError</span> <span class="tok tok-symbol">=</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">StatError</span></code></pre></div></div></details></div><div class="anal-decl"><b>Use with `Dir.symLink` and `symLinkAbsolute` to specify whether the symlink
will point to a file or a directory. This value is ignored on all hosts
except Windows where creating symlinks to different resource types, requires
different flags. By default, `symLinkAbsolute` is assumed to point to a file.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">SymLinkFlags</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">is_directory</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Walker</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">stack</span><span class="tok tok-symbol">:</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">ArrayList</span><span class="tok tok-symbol">(</span><span class="tok">StackItem</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">name_buffer</span><span class="tok tok-symbol">:</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">ArrayList</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span></code></pre></div></div></details><details><summary>types:</summary><div class="md-types more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Entry</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>The containing directory. This can be used to operate directly on `basename`
rather than `path`, avoiding `error.NameTooLong` for deeply nested paths.
The directory remains open until `next` or `deinit` is called.
</b><pre><code class="zig"><span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span></code></pre></div><div class="anal-decl"><b>TODO make this null terminated for API convenience
</b><pre><code class="zig"><span class="tok">basename</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">kind</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">Entry</span><span class="tok tok-symbol">.</span><span class="tok">Kind</span></code></pre></div></div></details></div></div></details><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><b>After each call to this function, and on deinit(), the memory returned
from this function becomes invalid. A copy must be made in order to keep
a reference to the path.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">next</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Walker</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">?</span><span class="tok">Entry</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deinit</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Walker</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">stack</span><span class="tok tok-symbol">.</span><span class="tok">popOrNull</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span><span class="tok tok-symbol">*</span><span class="tok">item</span><span class="tok tok-symbol">|</span> <span class="tok">item</span><span class="tok tok-symbol">.</span><span class="tok">dir_it</span><span class="tok tok-symbol">.</span><span class="tok">dir</span><span class="tok tok-symbol">.</span><span class="tok">close</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">stack</span><span class="tok tok-symbol">.</span><span class="tok">deinit</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">name_buffer</span><span class="tok tok-symbol">.</span><span class="tok">deinit</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div></div></details></div></div><h2 style="color: orange;">funcs:</h2><div class="more-decls"><div class="anal-decl"><b>TODO remove the allocator requirement from this API
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">atomicSymLink</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span> <span class="tok">existing_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">new_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `Dir.updateFile`, except asserts that both `source_path` and `dest_path`
are absolute. See `Dir.updateFile` for a function that operates on both
absolute and relative paths.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">updateFileAbsolute</span><span class="tok tok-symbol">(</span>
    <span class="tok">source_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">dest_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok">CopyFileOptions</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">PrevStatus</span></code></pre></div><div class="anal-decl"><b>Same as `Dir.copyFile`, except asserts that both `source_path` and `dest_path`
are absolute. See `Dir.copyFile` for a function that operates on both
absolute and relative paths.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">copyFileAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">source_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">dest_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok">CopyFileOptions</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">source_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">dest_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">const</span> <span class="tok">my_cwd</span> <span class="tok tok-symbol">=</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">copyFile</span><span class="tok tok-symbol">(</span><span class="tok">my_cwd</span><span class="tok tok-symbol">,</span> <span class="tok">source_path</span><span class="tok tok-symbol">,</span> <span class="tok">my_cwd</span><span class="tok tok-symbol">,</span> <span class="tok">dest_path</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Create a new directory, based on an absolute path.
Asserts that the path is absolute. See `Dir.makeDir` for a function that operates
on both absolute and relative paths.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">makeDirAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">mkdir</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">,</span> <span class="tok">default_new_dir_mode</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `makeDirAbsolute` except the parameter is a null-terminated UTF8-encoded string.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">makeDirAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_z</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_z</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">mkdirZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_z</span><span class="tok tok-symbol">,</span> <span class="tok">default_new_dir_mode</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `makeDirAbsolute` except the parameter is a null-terminated WTF-16 encoded string.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">makeDirAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">mkdirW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">,</span> <span class="tok">default_new_dir_mode</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `Dir.deleteDir` except the path is absolute.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteDirAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">dir_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">dir_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">rmdir</span><span class="tok tok-symbol">(</span><span class="tok">dir_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `deleteDirAbsolute` except the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteDirAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">dir_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">dir_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">rmdirZ</span><span class="tok tok-symbol">(</span><span class="tok">dir_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `deleteDirAbsolute` except the path parameter is WTF-16 and target OS is assumed Windows.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteDirAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">dir_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsW</span><span class="tok tok-symbol">(</span><span class="tok">dir_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">rmdirW</span><span class="tok tok-symbol">(</span><span class="tok">dir_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `Dir.rename` except the paths are absolute.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">renameAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">new_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">new_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">rename</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">,</span> <span class="tok">new_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `renameAbsolute` except the path parameters are null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">renameAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">new_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">new_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">renameZ</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">,</span> <span class="tok">new_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `renameAbsolute` except the path parameters are WTF-16 and target OS is assumed Windows.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">renameAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">new_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsW</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsW</span><span class="tok tok-symbol">(</span><span class="tok">new_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">renameW</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">,</span> <span class="tok">new_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `Dir.rename`, except `new_sub_path` is relative to `new_dir`
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">rename</span><span class="tok tok-symbol">(</span><span class="tok">old_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">new_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">renameat</span><span class="tok tok-symbol">(</span><span class="tok">old_dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path</span><span class="tok tok-symbol">,</span> <span class="tok">new_dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `rename` except the parameters are null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">renameZ</span><span class="tok tok-symbol">(</span><span class="tok">old_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path_z</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">new_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path_z</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">renameatZ</span><span class="tok tok-symbol">(</span><span class="tok">old_dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path_z</span><span class="tok tok-symbol">,</span> <span class="tok">new_dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path_z</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `rename` except the parameters are UTF16LE, NT prefixed.
This function is Windows-only.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">renameW</span><span class="tok tok-symbol">(</span><span class="tok">old_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">new_dir</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">renameatW</span><span class="tok tok-symbol">(</span><span class="tok">old_dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">old_sub_path_w</span><span class="tok tok-symbol">,</span> <span class="tok">new_dir</span><span class="tok tok-symbol">.</span><span class="tok">fd</span><span class="tok tok-symbol">,</span> <span class="tok">new_sub_path_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Returns a handle to the current working directory. It is not opened with iteration capability.
Closing the returned `Dir` is checked illegal behavior. Iterating over the result is illegal behavior.
On POSIX targets, this function is comptime-callable.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok">Dir</span></code></pre></div><div class="anal-decl"><b>Opens a directory at the given path. The directory is a system resource that remains
open until `close` is called on the result.
See `openDirAbsoluteZ` for a function that accepts a null-terminated path.

Asserts that the path parameter has no null bytes.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openDirAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">OpenDirOptions</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">Dir</span></code></pre></div><div class="anal-decl"><b>Same as `openDirAbsolute` but the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openDirAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">OpenDirOptions</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">Dir</span></code></pre></div><div class="anal-decl"><b>Same as `openDirAbsolute` but the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openDirAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">OpenDirOptions</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">Dir</span></code></pre></div><div class="anal-decl"><b>Opens a file for reading or writing, without attempting to create a new file, based on an absolute path.
Call `File.close` to release the resource.
Asserts that the path is absolute. See `Dir.openFile` for a function that
operates on both absolute and relative paths.
Asserts that the path parameter has no null bytes. See `openFileAbsoluteZ` for a function
that accepts a null-terminated path.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">openFileAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">openFile</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `openFileAbsolute` but the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">openFileAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">openFileZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `openFileAbsolute` but the path parameter is WTF-16 encoded.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">openFileAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsWTF16</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">openFileW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Test accessing `path`.
`path` is UTF8-encoded.
Be careful of Time-Of-Check-Time-Of-Use race conditions when using this function.
For example, instead of testing if a file exists and then opening it, just
open it and handle the error for file not found.
See `accessAbsoluteZ` for a function that accepts a null-terminated path.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">accessAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">AccessError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `accessAbsolute` but the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">accessAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">AccessError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `accessAbsolute` but the path parameter is WTF-16 encoded.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">accessAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-number">16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">AccessError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Creates, opens, or overwrites a file with write access, based on an absolute path.
Call `File.close` to release the resource.
Asserts that the path is absolute. See `Dir.createFile` for a function that
operates on both absolute and relative paths.
Asserts that the path parameter has no null bytes. See `createFileAbsoluteC` for a function
that accepts a null-terminated path.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">createFileAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">CreateFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">createFile</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `createFileAbsolute` but the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">createFileAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">CreateFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">createFileZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `createFileAbsolute` but the path parameter is WTF-16 encoded.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">createFileAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">CreateFlags</span><span class="tok tok-symbol">)</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">File</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">createFileW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Delete a file name and possibly the file it refers to, based on an absolute path.
Asserts that the path is absolute. See `Dir.deleteFile` for a function that
operates on both absolute and relative paths.
Asserts that the path parameter has no null bytes.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteFileAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">DeleteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">deleteFile</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `deleteFileAbsolute` except the parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteFileAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">DeleteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">deleteFileZ</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_c</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `deleteFileAbsolute` except the parameter is WTF-16 encoded.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteFileAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok">Dir</span><span class="tok tok-symbol">.</span><span class="tok">DeleteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">deleteFileW</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Removes a symlink, file, or directory.
This is equivalent to `Dir.deleteTree` with the base directory.
Asserts that the path is absolute. See `Dir.deleteTree` for a function that
operates on both absolute and relative paths.
Asserts that the path parameter has no null bytes.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">deleteTreeAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">absolute_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Same as `Dir.readLink`, except it asserts the path is absolute.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">readLinkAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">pathname</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-symbol">[</span><span class="tok">MAX_PATH_BYTES</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">pathname</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">readlink</span><span class="tok tok-symbol">(</span><span class="tok">pathname</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Windows-only. Same as `readlinkW`, except the path parameter is null-terminated, WTF16
encoded.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">readlinkAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">pathname_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-symbol">[</span><span class="tok">MAX_PATH_BYTES</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsW</span><span class="tok tok-symbol">(</span><span class="tok">pathname_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">readlinkW</span><span class="tok tok-symbol">(</span><span class="tok">pathname_w</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `readLink`, except the path parameter is null-terminated.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">readLinkAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">pathname_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-symbol">[</span><span class="tok">MAX_PATH_BYTES</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">pathname_c</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">readlinkZ</span><span class="tok tok-symbol">(</span><span class="tok">pathname_c</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Creates a symbolic link named `sym_link_path` which contains the string `target_path`.
A symbolic link (also known as a soft link) may point to an existing file or to a nonexistent
one; the latter case is known as a dangling link.
If `sym_link_path` exists, it will not be overwritten.
See also `symLinkAbsoluteZ` and `symLinkAbsoluteW`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">symLinkAbsolute</span><span class="tok tok-symbol">(</span><span class="tok">target_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">sym_link_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">SymLinkFlags</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Windows-only. Same as `symLinkAbsolute` except the parameters are null-terminated, WTF16 encoded.
Note that this function will by default try creating a symbolic link to a file. If you would
like to create a symbolic link to a directory, specify this with `SymLinkFlags{ .is_directory = true }`.
See also `symLinkAbsolute`, `symLinkAbsoluteZ`.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">symLinkAbsoluteW</span><span class="tok tok-symbol">(</span><span class="tok">target_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">sym_link_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">SymLinkFlags</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsWTF16</span><span class="tok tok-symbol">(</span><span class="tok">target_path_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">isAbsoluteWindowsWTF16</span><span class="tok tok-symbol">(</span><span class="tok">sym_link_path_w</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">windows</span><span class="tok tok-symbol">.</span><span class="tok">CreateSymbolicLink</span><span class="tok tok-symbol">(</span><span class="tok tok-null">null</span><span class="tok tok-symbol">,</span> <span class="tok">sym_link_path_w</span><span class="tok tok-symbol">,</span> <span class="tok">target_path_w</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">.</span><span class="tok">is_directory</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Same as `symLinkAbsolute` except the parameters are null-terminated pointers.
See also `symLinkAbsolute`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">symLinkAbsoluteZ</span><span class="tok tok-symbol">(</span><span class="tok">target_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">sym_link_path_c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">SymLinkFlags</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Recursively iterates over a directory.
Must call `Walker.deinit` when done.
`dir_path` must not end in a path separator.
The order of returned file system entries is undefined.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">walkPath</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span> <span class="tok">dir_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">Walker</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openSelfExe</span><span class="tok tok-symbol">(</span><span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">.</span><span class="tok">OpenFlags</span><span class="tok tok-symbol">)</span> <span class="tok">OpenSelfExeError</span><span class="tok tok-symbol">!</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><b>`selfExePath` except allocates the result on the heap.
Caller owns returned memory.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">selfExePathAlloc</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Allocator</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>Get the path to the current executable.
If you only need the directory, use selfExeDirPath.
If you only want an open file handle, use openSelfExe.
This function may return an error if the current executable
was deleted after spawning.
Returned value is a slice of out_buffer.

On Linux, depends on procfs being mounted. If the currently executing binary has
been deleted, the file path looks something like `/a/b/c/exe (deleted)`.
TODO make the return type of this a null terminated pointer
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">selfExePath</span><span class="tok tok-symbol">(</span><span class="tok">out_buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">SelfExePathError</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>The result is UTF16LE-encoded.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">selfExePathW</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">image_path_name</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">&amp;</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">windows</span><span class="tok tok-symbol">.</span><span class="tok">peb</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">ProcessParameters</span><span class="tok tok-symbol">.</span><span class="tok">ImagePathName</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">spanZ</span><span class="tok tok-symbol">(</span><span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">meta</span><span class="tok tok-symbol">.</span><span class="tok">assumeSentinel</span><span class="tok tok-symbol">(</span><span class="tok">image_path_name</span><span class="tok tok-symbol">.</span><span class="tok">Buffer</span><span class="tok tok-symbol">,</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>`selfExeDirPath` except allocates the result on the heap.
Caller owns returned memory.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">selfExeDirPathAlloc</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Allocator</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>Get the directory path that contains the current executable.
Returned value is a slice of out_buffer.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">selfExeDirPath</span><span class="tok tok-symbol">(</span><span class="tok">out_buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">SelfExePathError</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">self_exe_path</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">selfExePath</span><span class="tok tok-symbol">(</span><span class="tok">out_buffer</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    // Assume that the OS APIs return absolute paths, and therefore dirname
    // will not return null.
    <span class="tok tok-kw">return</span> <span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">dirname</span><span class="tok tok-symbol">(</span><span class="tok">self_exe_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok tok-symbol">?</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>`realpath`, except caller must free the returned memory.
See also `Dir.realpath`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">realpathAlloc</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span> <span class="tok">pathname</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div></div><h2 style="color: orange;">values:</h2><div class="more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">path</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;fs/path.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">File</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;fs/file.zig&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">File</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">wasi</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;fs/wasi.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">realpath</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">realpath</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">realpathZ</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">realpathZ</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">realpathC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: renamed to realpathZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">realpathW</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">realpathW</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">getAppDataDir</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;fs/get_app_data_dir.zig&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">getAppDataDir</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetAppDataDirError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;fs/get_app_data_dir.zig&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">GetAppDataDirError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">Watch</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;fs/watch.zig&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">Watch</span></code></pre></div><div class="anal-decl"><b>This represents the maximum size of a UTF-8 encoded file path that the
operating system will accept. Paths, including those returned from file
system operations, may be longer than this length, but such paths cannot
be successfully passed back in other file system operations. However,
all path components returned by file system operations are assumed to
fit into a UTF-8 encoded array of this length.
The byte count includes room for a null sentinel byte.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">MAX_PATH_BYTES</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-symbol">.</span><span class="tok">linux</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">macos</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">ios</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">freebsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">netbsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">dragonfly</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">openbsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">haiku</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">PATH_MAX</span><span class="tok tok-symbol">,</span>
    // Each UTF-16LE character may be expanded to 3 UTF-8 bytes.
    // If it would require 4 UTF-8 bytes, then there would be a surrogate
    // pair in the UTF-16LE, and we (over)account 3 bytes for it that way.
    // +1 for the null byte at the end, which can be encoded in 1 byte.
    <span class="tok tok-symbol">.</span><span class="tok">windows</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">windows</span><span class="tok tok-symbol">.</span><span class="tok">PATH_MAX_WIDE</span> <span class="tok tok-symbol">*</span> <span class="tok tok-number">3</span> <span class="tok tok-symbol">+</span> <span class="tok tok-number">1</span><span class="tok tok-symbol">,</span>
    // TODO work out what a reasonable value we should use here
    <span class="tok tok-symbol">.</span><span class="tok">wasi</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-number">4096</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;Unsupported OS&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">base64_alphabet</span> <span class="tok tok-symbol">=</span> <span class="tok tok-str">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_&quot;</span><span class="tok tok-symbol">.*</span></code></pre></div><div class="anal-decl"><b>Base64 encoder, replacing the standard `+/` with `-_` so that it can be used in a file name on any filesystem.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">base64_encoder</span> <span class="tok tok-symbol">=</span> <span class="tok">base64</span><span class="tok tok-symbol">.</span><span class="tok">Base64Encoder</span><span class="tok tok-symbol">.</span><span class="tok">init</span><span class="tok tok-symbol">(</span><span class="tok">base64_alphabet</span><span class="tok tok-symbol">,</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><b>Base64 decoder, replacing the standard `+/` with `-_` so that it can be used in a file name on any filesystem.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">base64_decoder</span> <span class="tok tok-symbol">=</span> <span class="tok">base64</span><span class="tok tok-symbol">.</span><span class="tok">Base64Decoder</span><span class="tok tok-symbol">.</span><span class="tok">init</span><span class="tok tok-symbol">(</span><span class="tok">base64_alphabet</span><span class="tok tok-symbol">,</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><b>Whether or not async file system syscalls need a dedicated thread because the operating
system does not support non-blocking I/O on the file system.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">need_async_thread</span> <span class="tok tok-symbol">=</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">is_async</span> <span class="tok tok-kw">and</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">tag</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-symbol">.</span><span class="tok">windows</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">other</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">false</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">true</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">deleteDir</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated; use dir.deleteDir or deleteDirAbsolute&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">deleteDirC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated; use dir.deleteDirZ or deleteDirAbsoluteZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">deleteDirW</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated; use dir.deleteDirW or deleteDirAbsoluteW&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">renameC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: use renameZ, dir.renameZ, or renameAbsoluteZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">openFileAbsoluteC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: renamed to openFileAbsoluteZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">createFileAbsoluteC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: renamed to createFileAbsoluteZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">deleteFileAbsoluteC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: renamed to deleteFileAbsoluteZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">readLink</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated; use Dir.readLink or readLinkAbsolute&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">readLinkC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated; use Dir.readLinkZ or readLinkAbsoluteZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">symLink</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: use Dir.symLink or symLinkAbsolute&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">symLinkC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@compileError</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;deprecated: use Dir.symLinkZ or symLinkAbsoluteZ&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">OpenSelfExeError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">SharingViolation</span><span class="tok tok-symbol">,</span>
    <span class="tok">PathAlreadyExists</span><span class="tok tok-symbol">,</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
    <span class="tok">PipeBusy</span><span class="tok tok-symbol">,</span>
    <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-comment">/// On Windows, file paths must be valid Unicode.</span>
    <span class="tok">InvalidUtf8</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-comment">/// On Windows, file paths cannot contain these characters:</span>
    <span class="tok tok-comment">/// '/', '*', '?', '&quot;', '&lt;', '&gt;', '|'</span>
    <span class="tok">BadPathName</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span> <span class="tok tok-symbol">||</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">OpenError</span> <span class="tok tok-symbol">||</span> <span class="tok">SelfExePathError</span> <span class="tok tok-symbol">||</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">FlockError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SelfExePathError</span> <span class="tok tok-symbol">=</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">ReadLinkError</span> <span class="tok tok-symbol">||</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">SysCtlError</span> <span class="tok tok-symbol">||</span> <span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">RealPathError</span></code></pre></div></div></html>