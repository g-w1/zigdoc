<style type="text/css" >
.more-decls {
    padding-left: 50px;
}
.anal-decl {
 background-color: #F7A41D77;
}
code {
 background-color: #F7A41D77;
}
</style><style type="text/css" >
pre > code {
  display: block;
  overflow: auto;
  padding: 0.5em;
  color: black;
}

details {
  margin-bottom: 0.5em;
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Old versions of Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome, Edge, Opera and Firefox */
}

.tok {
  color: #333;
  font-style: normal;
}

.code {
  font-family: monospace;
  font-size: 0.8em;
}

.tok-kw {
  color: #333;
  font-weight: bold;
}

.tok-str {
  color: #d14;
}

.tok-builtin {
  color: #0086b3;
}

code.zig {
  color: #777;
  font-style: italic;
}

.tok-fn {
  color: #900;
  font-weight: bold;
}

.tok-null {
  color: #008080;
}

.tok-number {
  color: #008080;
}

.tok-type {
  color: #458;
  font-weight: bold;
}
</style><html><a href="null//os/linux/bpf.zig"><h1>/os/linux/bpf.zig</h1></a><div class="more-decls"></div><h2 style="color: orange;">types:</h2><div class="more-decls"><div class="anal-decl"><b>These values correspond to &quot;syscalls&quot; within the BPF program's environment,
each one is documented in std.os.linux.BPF.kern
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Helper</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">unspec</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_lookup_elem</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_update_elem</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_delete_elem</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">probe_read</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">ktime_get_ns</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">trace_printk</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_prandom_u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_smp_processor_id</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_store_bytes</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">l3_csum_replace</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">l4_csum_replace</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">tail_call</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">clone_redirect</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_current_pid_tgid</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_current_uid_gid</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_current_comm</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_cgroup_classid</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_vlan_push</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_vlan_pop</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_get_tunnel_key</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_set_tunnel_key</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">perf_event_read</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">redirect</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_route_realm</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">perf_event_output</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_load_bytes</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_stackid</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">csum_diff</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_get_tunnel_opt</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_set_tunnel_opt</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_change_proto</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_change_type</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_under_cgroup</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_hash_recalc</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_current_task</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">probe_write_user</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">current_task_under_cgroup</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_change_tail</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_pull_data</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">csum_update</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">set_hash_invalid</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_numa_node_id</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_change_head</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">xdp_adjust_head</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">probe_read_str</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_socket_cookie</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_socket_uid</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">set_hash</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">setsockopt</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_adjust_room</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">redirect_map</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_redirect_map</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sock_map_update</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">xdp_adjust_meta</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">perf_event_read_value</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">perf_prog_read_value</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">getsockopt</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">override_return</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sock_ops_cb_flags_set</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">msg_redirect_map</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">msg_apply_bytes</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">msg_cork_bytes</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">msg_pull_data</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">bind</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">xdp_adjust_tail</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_get_xfrm_state</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_stack</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_load_bytes_relative</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">fib_lookup</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sock_hash_update</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">msg_redirect_hash</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_redirect_hash</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">lwt_push_encap</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">lwt_seg6_store_bytes</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">lwt_seg6_adjust_srh</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">lwt_seg6_action</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">rc_repeat</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">rc_keydown</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_cgroup_id</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_current_cgroup_id</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_local_storage</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_select_reuseport</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_ancestor_cgroup_id</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_lookup_tcp</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_lookup_udp</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_release</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_push_elem</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_pop_elem</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_peek_elem</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">msg_push_data</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">msg_pop_data</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">rc_pointer_rel</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">spin_lock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">spin_unlock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_fullsock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">tcp_sock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_ecn_set_ce</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_listener_sock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skc_lookup_tcp</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">tcp_check_syncookie</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sysctl_get_name</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sysctl_get_current_value</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sysctl_get_new_value</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sysctl_set_new_value</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">strtol</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">strtoul</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_storage_get</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_storage_delete</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">send_signal</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">tcp_gen_syncookie</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skb_output</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">probe_read_user</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">probe_read_kernel</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">probe_read_user_str</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">probe_read_kernel_str</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">tcp_send_ack</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">send_signal_thread</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">jiffies64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">read_branch_records</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_ns_current_pid_tgid</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">xdp_output</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_netns_cookie</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_current_ancestor_cgroup_id</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_assign</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">ktime_get_boot_ns</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">seq_printf</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">seq_write</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_cgroup_id</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_ancestor_cgroup_id</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">ringbuf_output</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">ringbuf_reserve</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">ringbuf_submit</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">ringbuf_discard</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">ringbuf_query</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">csum_level</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skc_to_tcp6_sock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skc_to_tcp_sock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skc_to_tcp_timewait_sock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skc_to_tcp_request_sock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">skc_to_udp6_sock</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_task_stack</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">_</span></code></pre></div></div></details></div><div class="anal-decl"><b>a single BPF instruction
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Insn</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">packed</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">code</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u4</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u4</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">imm</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i32</span></code></pre></div></div></details><details><summary>types:</summary><div class="md-types more-decls"><div class="anal-decl"><b>r0 - r9 are general purpose 64-bit registers, r10 points to the stack
frame
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Reg</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">r0</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r1</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r2</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r3</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r4</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r5</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r6</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r7</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r8</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r9</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">r10</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Size</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">byte</span> <span class="tok tok-symbol">=</span> <span class="tok">B</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">half_word</span> <span class="tok tok-symbol">=</span> <span class="tok">H</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">word</span> <span class="tok tok-symbol">=</span> <span class="tok">W</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">double_word</span> <span class="tok tok-symbol">=</span> <span class="tok">DW</span></code></pre></div></div></details></div></div></details><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">mov</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">mov</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">add</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">add</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">sub</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">sub</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">mul</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">mul</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">div</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">div</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">alu_or</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">alu_or</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">alu_and</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">alu_and</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">lsh</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">lsh</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">rsh</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">rsh</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">neg</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">neg</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">mod</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">mod</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">xor</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">xor</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">arsh</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">alu</span><span class="tok tok-symbol">(</span><span class="tok tok-number">64</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">arsh</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">ja</span><span class="tok tok-symbol">(</span><span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">ja</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">r0</span><span class="tok tok-symbol">,</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jeq</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jeq</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jgt</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jgt</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jge</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jge</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jlt</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jlt</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jle</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jle</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jset</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jset</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jne</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jne</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jsgt</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jsgt</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jsge</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jsge</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jslt</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jslt</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">jsle</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">jmp</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">jsle</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">xadd</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">ld_abs</span><span class="tok tok-symbol">(</span><span class="tok">size</span><span class="tok tok-symbol">:</span> <span class="tok">Size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">imm</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i32</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ld</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">abs</span><span class="tok tok-symbol">,</span> <span class="tok">size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">imm</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">ld_ind</span><span class="tok tok-symbol">(</span><span class="tok">size</span><span class="tok tok-symbol">:</span> <span class="tok">Size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">imm</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i32</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ld</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">ind</span><span class="tok tok-symbol">,</span> <span class="tok">size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">,</span> <span class="tok">imm</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">ldx</span><span class="tok tok-symbol">(</span><span class="tok">size</span><span class="tok tok-symbol">:</span> <span class="tok">Size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">ld_dw1</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">imm</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ld_imm_impl1</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">r0</span><span class="tok tok-symbol">,</span> <span class="tok">imm</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">ld_dw2</span><span class="tok tok-symbol">(</span><span class="tok">imm</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ld_imm_impl2</span><span class="tok tok-symbol">(</span><span class="tok">imm</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">ld_map_fd1</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">map_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ld_imm_impl1</span><span class="tok tok-symbol">(</span><span class="tok">dst</span><span class="tok tok-symbol">,</span> <span class="tok tok-builtin">@intToEnum</span><span class="tok tok-symbol">(</span><span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">PSEUDO_MAP_FD</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok tok-builtin">@intCast</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span> <span class="tok">map_fd</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">ld_map_fd2</span><span class="tok tok-symbol">(</span><span class="tok">map_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ld_imm_impl2</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@intCast</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span> <span class="tok">map_fd</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">st</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">comptime</span> <span class="tok">size</span><span class="tok tok-symbol">:</span> <span class="tok">Size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">,</span> <span class="tok">imm</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i32</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">stx</span><span class="tok tok-symbol">(</span><span class="tok">size</span><span class="tok tok-symbol">:</span> <span class="tok">Size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">,</span> <span class="tok">off</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i16</span><span class="tok tok-symbol">,</span> <span class="tok">src</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">le</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">comptime</span> <span class="tok">size</span><span class="tok tok-symbol">:</span> <span class="tok">Size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">endian_swap</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">Little</span><span class="tok tok-symbol">,</span> <span class="tok">size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">be</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">comptime</span> <span class="tok">size</span><span class="tok tok-symbol">:</span> <span class="tok">Size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">:</span> <span class="tok">Reg</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">endian_swap</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">.</span><span class="tok">Big</span><span class="tok tok-symbol">,</span> <span class="tok">size</span><span class="tok tok-symbol">,</span> <span class="tok">dst</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">call</span><span class="tok tok-symbol">(</span><span class="tok">helper</span><span class="tok tok-symbol">:</span> <span class="tok">Helper</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span></code></pre></div><div class="anal-decl"><b>exit BPF program
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">exit</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok">Insn</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Cmd</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>Create  a map and return a file descriptor that refers to the map.  The
close-on-exec file descriptor flag is automatically enabled for the new
file descriptor.

uses MapCreateAttr
</b><pre><code class="zig"><span class="tok">map_create</span></code></pre></div><div class="anal-decl"><b>Look up an element by key in a specified map and return its value.

uses MapElemAttr
</b><pre><code class="zig"><span class="tok">map_lookup_elem</span></code></pre></div><div class="anal-decl"><b>Create or update an element (key/value pair) in a specified map.

uses MapElemAttr
</b><pre><code class="zig"><span class="tok">map_update_elem</span></code></pre></div><div class="anal-decl"><b>Look up and delete an element by key in a specified map.

uses MapElemAttr
</b><pre><code class="zig"><span class="tok">map_delete_elem</span></code></pre></div><div class="anal-decl"><b>Look up an element by key in a specified map and return the key of the
next element.
</b><pre><code class="zig"><span class="tok">map_get_next_key</span></code></pre></div><div class="anal-decl"><b>Verify and load an eBPF program, returning a new file descriptor
associated with  the  program.   The close-on-exec file descriptor flag
is automatically enabled for the new file descriptor.

uses ProgLoadAttr
</b><pre><code class="zig"><span class="tok">prog_load</span></code></pre></div><div class="anal-decl"><b>Pin a map or eBPF program to a path within the minimal BPF filesystem

uses ObjAttr
</b><pre><code class="zig"><span class="tok">obj_pin</span></code></pre></div><div class="anal-decl"><b>Get the file descriptor of a BPF object pinned to a certain path

uses ObjAttr
</b><pre><code class="zig"><span class="tok">obj_get</span></code></pre></div><div class="anal-decl"><b>uses ProgAttachAttr
</b><pre><code class="zig"><span class="tok">prog_attach</span></code></pre></div><div class="anal-decl"><b>uses ProgAttachAttr
</b><pre><code class="zig"><span class="tok">prog_detach</span></code></pre></div><div class="anal-decl"><b>uses TestRunAttr
</b><pre><code class="zig"><span class="tok">prog_test_run</span></code></pre></div><div class="anal-decl"><b>uses GetIdAttr
</b><pre><code class="zig"><span class="tok">prog_get_next_id</span></code></pre></div><div class="anal-decl"><b>uses GetIdAttr
</b><pre><code class="zig"><span class="tok">map_get_next_id</span></code></pre></div><div class="anal-decl"><b>uses GetIdAttr
</b><pre><code class="zig"><span class="tok">prog_get_fd_by_id</span></code></pre></div><div class="anal-decl"><b>uses GetIdAttr
</b><pre><code class="zig"><span class="tok">map_get_fd_by_id</span></code></pre></div><div class="anal-decl"><b>uses InfoAttr
</b><pre><code class="zig"><span class="tok">obj_get_info_by_fd</span></code></pre></div><div class="anal-decl"><b>uses QueryAttr
</b><pre><code class="zig"><span class="tok">prog_query</span></code></pre></div><div class="anal-decl"><b>uses RawTracepointAttr
</b><pre><code class="zig"><span class="tok">raw_tracepoint_open</span></code></pre></div><div class="anal-decl"><b>uses BtfLoadAttr
</b><pre><code class="zig"><span class="tok">btf_load</span></code></pre></div><div class="anal-decl"><b>uses GetIdAttr
</b><pre><code class="zig"><span class="tok">btf_get_fd_by_id</span></code></pre></div><div class="anal-decl"><b>uses TaskFdQueryAttr
</b><pre><code class="zig"><span class="tok">task_fd_query</span></code></pre></div><div class="anal-decl"><b>uses MapElemAttr
</b><pre><code class="zig"><span class="tok">map_lookup_and_delete_elem</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_freeze</span></code></pre></div><div class="anal-decl"><b>uses GetIdAttr
</b><pre><code class="zig"><span class="tok">btf_get_next_id</span></code></pre></div><div class="anal-decl"><b>uses MapBatchAttr
</b><pre><code class="zig"><span class="tok">map_lookup_batch</span></code></pre></div><div class="anal-decl"><b>uses MapBatchAttr
</b><pre><code class="zig"><span class="tok">map_lookup_and_delete_batch</span></code></pre></div><div class="anal-decl"><b>uses MapBatchAttr
</b><pre><code class="zig"><span class="tok">map_update_batch</span></code></pre></div><div class="anal-decl"><b>uses MapBatchAttr
</b><pre><code class="zig"><span class="tok">map_delete_batch</span></code></pre></div><div class="anal-decl"><b>uses LinkCreateAttr
</b><pre><code class="zig"><span class="tok">link_create</span></code></pre></div><div class="anal-decl"><b>uses LinkUpdateAttr
</b><pre><code class="zig"><span class="tok">link_update</span></code></pre></div><div class="anal-decl"><b>uses GetIdAttr
</b><pre><code class="zig"><span class="tok">link_get_fd_by_id</span></code></pre></div><div class="anal-decl"><b>uses GetIdAttr
</b><pre><code class="zig"><span class="tok">link_get_next_id</span></code></pre></div><div class="anal-decl"><b>uses EnableStatsAttr
</b><pre><code class="zig"><span class="tok">enable_stats</span></code></pre></div><div class="anal-decl"><b>uses IterCreateAttr
</b><pre><code class="zig"><span class="tok">iter_create</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">link_detach</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">_</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">MapType</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">unspec</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">hash</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">array</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">prog_array</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">perf_event_array</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">percpu_hash</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">percpu_array</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">stack_trace</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_array</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">lru_hash</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">lru_percpu_hash</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">lpm_trie</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">array_of_maps</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">hash_of_maps</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">devmap</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sockmap</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cpumap</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">xskmap</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sockhash</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_storage</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">reuseport_sockarray</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">percpu_cgroup_storage</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">queue</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">stack</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_storage</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">devmap_hash</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">struct_ops</span></code></pre></div><div class="anal-decl"><b>An ordered and shared CPU version of perf_event_array. They have
similar semantics:
- variable length records
- no blocking: when full, reservation fails
- memory mappable for ease and speed
- epoll notifications for new data, but can busy poll

Ringbufs give BPF programs two sets of APIs:
- ringbuf_output() allows copy data from one place to a ring
buffer, similar to bpf_perf_event_output()
- ringbuf_reserve()/ringbuf_commit()/ringbuf_discard() split the
process into two steps. First a fixed amount of space is reserved,
if that is successful then the program gets a pointer to a chunk of
memory and can be submitted with commit() or discarded with
discard()

ringbuf_output() will incurr an extra memory copy, but allows to submit
records of the length that's not known beforehand, and is an easy
replacement for perf_event_outptu().

ringbuf_reserve() avoids the extra memory copy but requires a known size
of memory beforehand.

ringbuf_query() allows to query properties of the map, 4 are currently
supported:
- BPF_RB_AVAIL_DATA: amount of unconsumed data in ringbuf
- BPF_RB_RING_SIZE: returns size of ringbuf
- BPF_RB_CONS_POS/BPF_RB_PROD_POS returns current logical position
of consumer and producer respectively

key size: 0
value size: 0
max entries: size of ringbuf, must be power of 2
</b><pre><code class="zig"><span class="tok">ringbuf</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">_</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">ProgType</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">unspec</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">socket_filter</span></code></pre></div><div class="anal-decl"><b>context type: bpf_user_pt_regs_t
</b><pre><code class="zig"><span class="tok">kprobe</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">sched_cls</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">sched_act</span></code></pre></div><div class="anal-decl"><b>context type: u64
</b><pre><code class="zig"><span class="tok">tracepoint</span></code></pre></div><div class="anal-decl"><b>context type: xdp_md
</b><pre><code class="zig"><span class="tok">xdp</span></code></pre></div><div class="anal-decl"><b>context type: bpf_perf_event_data
</b><pre><code class="zig"><span class="tok">perf_event</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">cgroup_skb</span></code></pre></div><div class="anal-decl"><b>context type: bpf_sock
</b><pre><code class="zig"><span class="tok">cgroup_sock</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">lwt_in</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">lwt_out</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">lwt_xmit</span></code></pre></div><div class="anal-decl"><b>context type: bpf_sock_ops
</b><pre><code class="zig"><span class="tok">sock_ops</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">sk_skb</span></code></pre></div><div class="anal-decl"><b>context type: bpf_cgroup_dev_ctx
</b><pre><code class="zig"><span class="tok">cgroup_device</span></code></pre></div><div class="anal-decl"><b>context type: sk_msg_md
</b><pre><code class="zig"><span class="tok">sk_msg</span></code></pre></div><div class="anal-decl"><b>context type: bpf_raw_tracepoint_args
</b><pre><code class="zig"><span class="tok">raw_tracepoint</span></code></pre></div><div class="anal-decl"><b>context type: bpf_sock_addr
</b><pre><code class="zig"><span class="tok">cgroup_sock_addr</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">lwt_seg6local</span></code></pre></div><div class="anal-decl"><b>context type: u32
</b><pre><code class="zig"><span class="tok">lirc_mode2</span></code></pre></div><div class="anal-decl"><b>context type: sk_reuseport_md
</b><pre><code class="zig"><span class="tok">sk_reuseport</span></code></pre></div><div class="anal-decl"><b>context type: __sk_buff
</b><pre><code class="zig"><span class="tok">flow_dissector</span></code></pre></div><div class="anal-decl"><b>context type: bpf_sysctl
</b><pre><code class="zig"><span class="tok">cgroup_sysctl</span></code></pre></div><div class="anal-decl"><b>context type: bpf_raw_tracepoint_args
</b><pre><code class="zig"><span class="tok">raw_tracepoint_writable</span></code></pre></div><div class="anal-decl"><b>context type: bpf_sockopt
</b><pre><code class="zig"><span class="tok">cgroup_sockopt</span></code></pre></div><div class="anal-decl"><b>context type: void *
</b><pre><code class="zig"><span class="tok">tracing</span></code></pre></div><div class="anal-decl"><b>context type: void *
</b><pre><code class="zig"><span class="tok">struct_ops</span></code></pre></div><div class="anal-decl"><b>context type: void *
</b><pre><code class="zig"><span class="tok">ext</span></code></pre></div><div class="anal-decl"><b>context type: void *
</b><pre><code class="zig"><span class="tok">lsm</span></code></pre></div><div class="anal-decl"><b>context type: bpf_sk_lookup
</b><pre><code class="zig"><span class="tok">sk_lookup</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">_</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">AttachType</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet_ingress</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet_egress</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet_sock_create</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_sock_ops</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_skb_stream_parser</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_skb_stream_verdict</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_device</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_msg_verdict</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet4_bind</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet6_bind</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet4_connect</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet6_connect</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet4_post_bind</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet6_post_bind</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_udp4_sendmsg</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_udp6_sendmsg</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">lirc_mode2</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">flow_dissector</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_sysctl</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_udp4_recvmsg</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_udp6_recvmsg</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_getsockopt</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_setsockopt</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">trace_raw_tp</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">trace_fentry</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">trace_fexit</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">modify_return</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">lsm_mac</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">trace_iter</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet4_getpeername</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet6_getpeername</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet4_getsockname</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet6_getsockname</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">xdp_devmap</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">cgroup_inet_sock_release</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">xdp_cpumap</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sk_lookup</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">xdp</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">_</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.map_create command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">MapCreateAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>one of MapType
</b><pre><code class="zig"><span class="tok">map_type</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>size of key in bytes
</b><pre><code class="zig"><span class="tok">key_size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>size of value in bytes
</b><pre><code class="zig"><span class="tok">value_size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>max number of entries in a map
</b><pre><code class="zig"><span class="tok">max_entries</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>.map_create related flags
</b><pre><code class="zig"><span class="tok">map_flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>fd pointing to the inner map
</b><pre><code class="zig"><span class="tok">inner_map_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><b>numa node (effective only if MapCreateFlags.numa_node is set)
</b><pre><code class="zig"><span class="tok">numa_node</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">obj_name_len</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>ifindex of netdev to create on
</b><pre><code class="zig"><span class="tok">map_ifindex</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>fd pointing to a BTF type data
</b><pre><code class="zig"><span class="tok">btf_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><b>BTF type_id of the key
</b><pre><code class="zig"><span class="tok">btf_key_type_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>BTF type_id of the value
</b><pre><code class="zig"><span class="tok">bpf_value_type_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>BTF type_id of a kernel struct stored as the map value
</b><pre><code class="zig"><span class="tok">btf_vmlinux_value_type_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.map_*_elem commands
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">MapElemAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">map_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">key</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">result</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">union</span> <span class="tok tok-symbol">{</span>
        <span class="tok">value</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span>
        <span class="tok">next_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.map_*_batch commands
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">MapBatchAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>start batch, NULL to start from beginning
</b><pre><code class="zig"><span class="tok">in_batch</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><b>output: next start batch
</b><pre><code class="zig"><span class="tok">out_batch</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">keys</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">values</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><b>input/output:
input: # of key/value elements
output: # of filled elements
</b><pre><code class="zig"><span class="tok">count</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">elem_flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.prog_load command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">ProgLoadAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>one of ProgType
</b><pre><code class="zig"><span class="tok">prog_type</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">insn_cnt</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">insns</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">license</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><b>verbosity level of verifier
</b><pre><code class="zig"><span class="tok">log_level</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>size of user buffer
</b><pre><code class="zig"><span class="tok">log_size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>user supplied buffer
</b><pre><code class="zig"><span class="tok">log_buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><b>not used
</b><pre><code class="zig"><span class="tok">kern_version</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">prog_flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">prog_name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">obj_name_len</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>ifindex of netdev to prep for.
</b><pre><code class="zig"><span class="tok">prog_ifindex</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>For some prog types expected attach type must be known at load time to
verify attach type specific parts of prog (context accesses, allowed
helpers, etc).
</b><pre><code class="zig"><span class="tok">expected_attach_type</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>fd pointing to BTF type data
</b><pre><code class="zig"><span class="tok">prog_btf_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><b>userspace bpf_func_info size
</b><pre><code class="zig"><span class="tok">func_info_rec_size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">func_info</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><b>number of bpf_func_info records
</b><pre><code class="zig"><span class="tok">func_info_cnt</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>userspace bpf_line_info size
</b><pre><code class="zig"><span class="tok">line_info_rec_size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">line_info</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><b>number of bpf_line_info records
</b><pre><code class="zig"><span class="tok">line_info_cnt</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>in-kernel BTF type id to attach to
</b><pre><code class="zig"><span class="tok">attact_btf_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>0 to attach to vmlinux
</b><pre><code class="zig"><span class="tok">attach_prog_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.obj_* commands
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">ObjAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">pathname</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">bpf_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">file_flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.prog_attach/detach commands
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">ProgAttachAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>container object to attach to
</b><pre><code class="zig"><span class="tok">target_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><b>eBPF program to attach
</b><pre><code class="zig"><span class="tok">attach_bpf_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">attach_type</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">attach_flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>previously attached eBPF program to replace if .replace is used
</b><pre><code class="zig"><span class="tok">replace_bpf_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.prog_test_run command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">TestRunAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">prog_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">retval</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>input: len of data_in
</b><pre><code class="zig"><span class="tok">data_size_in</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>input/output: len of data_out. returns ENOSPC if data_out is too small.
</b><pre><code class="zig"><span class="tok">data_size_out</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">data_in</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">data_out</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">repeat</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">duration</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>input: len of ctx_in
</b><pre><code class="zig"><span class="tok">ctx_size_in</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>input/output: len of ctx_out. returns ENOSPC if ctx_out is too small.
</b><pre><code class="zig"><span class="tok">ctx_size_out</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">ctx_in</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">ctx_out</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.*_get_*_id commands
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">GetIdAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">id</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">union</span> <span class="tok tok-symbol">{</span>
        <span class="tok">start_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span>
        <span class="tok">prog_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span>
        <span class="tok">map_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span>
        <span class="tok">btf_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span>
        <span class="tok">link_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">next_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">open_flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.obj_get_info_by_fd command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">InfoAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">bpf_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">info_len</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">info</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.prog_query command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">QueryAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>container object to query
</b><pre><code class="zig"><span class="tok">target_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">attach_type</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">query_flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">attach_flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">prog_ids</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">prog_cnt</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.raw_tracepoint_open command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">RawTracepointAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">name</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">prog_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.btf_load command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">BtfLoadAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">btf</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">btf_log_buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">btf_size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">btf_log_size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">btf_log_level</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.task_fd_query
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">TaskFdQueryAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>input: pid
</b><pre><code class="zig"><span class="tok">pid</span><span class="tok tok-symbol">:</span> <span class="tok">pid_t</span></code></pre></div><div class="anal-decl"><b>input: fd
</b><pre><code class="zig"><span class="tok">fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><b>input: flags
</b><pre><code class="zig"><span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>input/output: buf len
</b><pre><code class="zig"><span class="tok">buf_len</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>input/output:
tp_name for tracepoint
symbol for kprobe
filename for uprobe
</b><pre><code class="zig"><span class="tok">buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><b>output: prod_id
</b><pre><code class="zig"><span class="tok">prog_id</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>output: BPF_FD_TYPE
</b><pre><code class="zig"><span class="tok">fd_type</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>output: probe_offset
</b><pre><code class="zig"><span class="tok">probe_offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><b>output: probe_addr
</b><pre><code class="zig"><span class="tok">probe_addr</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.link_create command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">LinkCreateAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><b>eBPF program to attach
</b><pre><code class="zig"><span class="tok">prog_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><b>object to attach to
</b><pre><code class="zig"><span class="tok">target_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">attach_type</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>extra flags
</b><pre><code class="zig"><span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.link_update command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">LinkUpdateAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">link_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><b>new program to update link with
</b><pre><code class="zig"><span class="tok">new_prog_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><b>extra flags
</b><pre><code class="zig"><span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><b>expected link's program fd, it is specified only if BPF_F_REPLACE is
set in flags
</b><pre><code class="zig"><span class="tok">old_prog_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.enable_stats command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">EnableStatsAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-type">type</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div></div></details></div><div class="anal-decl"><b>struct used by Cmd.iter_create command
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">IterCreateAttr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">link_fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div></div></details></div><div class="anal-decl"><b>Mega struct that is passed to the bpf() syscall
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Attr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">extern</span> <span class="tok tok-kw">union</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">map_create</span><span class="tok tok-symbol">:</span> <span class="tok">MapCreateAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_elem</span><span class="tok tok-symbol">:</span> <span class="tok">MapElemAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">map_batch</span><span class="tok tok-symbol">:</span> <span class="tok">MapBatchAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">prog_load</span><span class="tok tok-symbol">:</span> <span class="tok">ProgLoadAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">obj</span><span class="tok tok-symbol">:</span> <span class="tok">ObjAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">prog_attach</span><span class="tok tok-symbol">:</span> <span class="tok">ProgAttachAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">test_run</span><span class="tok tok-symbol">:</span> <span class="tok">TestRunAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">get_id</span><span class="tok tok-symbol">:</span> <span class="tok">GetIdAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">info</span><span class="tok tok-symbol">:</span> <span class="tok">InfoAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">query</span><span class="tok tok-symbol">:</span> <span class="tok">QueryAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">raw_tracepoint</span><span class="tok tok-symbol">:</span> <span class="tok">RawTracepointAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">btf_load</span><span class="tok tok-symbol">:</span> <span class="tok">BtfLoadAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">task_fd_query</span><span class="tok tok-symbol">:</span> <span class="tok">TaskFdQueryAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">link_create</span><span class="tok tok-symbol">:</span> <span class="tok">LinkCreateAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">link_update</span><span class="tok tok-symbol">:</span> <span class="tok">LinkUpdateAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">enable_stats</span><span class="tok tok-symbol">:</span> <span class="tok">EnableStatsAttr</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">iter_create</span><span class="tok tok-symbol">:</span> <span class="tok">IterCreateAttr</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Log</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">level</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div></div></details></div></div><h2 style="color: orange;">funcs:</h2><div class="more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">map_create</span><span class="tok tok-symbol">(</span><span class="tok">map_type</span><span class="tok tok-symbol">:</span> <span class="tok">MapType</span><span class="tok tok-symbol">,</span> <span class="tok">key_size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span> <span class="tok">value_size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span> <span class="tok">max_entries</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">fd_t</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">map_lookup_elem</span><span class="tok tok-symbol">(</span><span class="tok">fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span><span class="tok tok-symbol">,</span> <span class="tok">key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">value</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">map_update_elem</span><span class="tok tok-symbol">(</span><span class="tok">fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span><span class="tok tok-symbol">,</span> <span class="tok">key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">value</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">map_delete_elem</span><span class="tok tok-symbol">(</span><span class="tok">fd</span><span class="tok tok-symbol">:</span> <span class="tok">fd_t</span><span class="tok tok-symbol">,</span> <span class="tok">key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">prog_load</span><span class="tok tok-symbol">(</span>
    <span class="tok">prog_type</span><span class="tok tok-symbol">:</span> <span class="tok">ProgType</span><span class="tok tok-symbol">,</span>
    <span class="tok">insns</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok">Insn</span><span class="tok tok-symbol">,</span>
    <span class="tok">log</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">Log</span><span class="tok tok-symbol">,</span>
    <span class="tok">license</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">kern_version</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">fd_t</span></code></pre></div></div><h2 style="color: orange;">values:</h2><div class="more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">btf</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;bpf/btf.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">kern</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;bpf/kern.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">LD</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x00</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">LDX</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x01</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ST</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x02</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">STX</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x03</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ALU</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x04</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JMP</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x05</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">RET</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x06</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">MISC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x07</span></code></pre></div><div class="anal-decl"><b>32-bit
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">W</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x00</span></code></pre></div><div class="anal-decl"><b>16-bit
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">H</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x08</span></code></pre></div><div class="anal-decl"><b>8-bit
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">B</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x10</span></code></pre></div><div class="anal-decl"><b>64-bit
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">DW</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x18</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">IMM</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x00</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ABS</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x20</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">IND</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x40</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">MEM</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x60</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">LEN</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x80</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">MSH</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xa0</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ADD</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x00</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SUB</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x10</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">MUL</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x20</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">DIV</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x30</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">OR</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x40</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">AND</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x50</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">LSH</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x60</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">RSH</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x70</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">NEG</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x80</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">MOD</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x90</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">XOR</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xa0</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JA</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x00</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JEQ</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x10</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JGT</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x20</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JGE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x30</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JSET</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x40</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">K</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x00</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">X</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x08</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">MAXINSNS</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">4096</span></code></pre></div><div class="anal-decl"><b>jmp mode in word width
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JMP32</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x06</span></code></pre></div><div class="anal-decl"><b>alu mode in double word width
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ALU64</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x07</span></code></pre></div><div class="anal-decl"><b>exclusive add
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">XADD</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xc0</span></code></pre></div><div class="anal-decl"><b>mov reg to reg
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">MOV</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xb0</span></code></pre></div><div class="anal-decl"><b>sign extending arithmetic shift right */
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ARSH</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xc0</span></code></pre></div><div class="anal-decl"><b>flags for endianness conversion:
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">END</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xd0</span></code></pre></div><div class="anal-decl"><b>convert to little-endian */
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">TO_LE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x00</span></code></pre></div><div class="anal-decl"><b>convert to big-endian
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">TO_BE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x08</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">FROM_LE</span> <span class="tok tok-symbol">=</span> <span class="tok">TO_LE</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">FROM_BE</span> <span class="tok tok-symbol">=</span> <span class="tok">TO_BE</span></code></pre></div><div class="anal-decl"><b>jump != *
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JNE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x50</span></code></pre></div><div class="anal-decl"><b>LT is unsigned, '&lt;'
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JLT</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xa0</span></code></pre></div><div class="anal-decl"><b>LE is unsigned, '&lt;=' *
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JLE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xb0</span></code></pre></div><div class="anal-decl"><b>SGT is signed '&gt;', GT in x86
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JSGT</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x60</span></code></pre></div><div class="anal-decl"><b>SGE is signed '&gt;=', GE in x86
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JSGE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x70</span></code></pre></div><div class="anal-decl"><b>SLT is signed, '&lt;'
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JSLT</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xc0</span></code></pre></div><div class="anal-decl"><b>SLE is signed, '&lt;='
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">JSLE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0xd0</span></code></pre></div><div class="anal-decl"><b>function call
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">CALL</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x80</span></code></pre></div><div class="anal-decl"><b>function return
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">EXIT</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x90</span></code></pre></div><div class="anal-decl"><b>Flag for prog_attach command. If a sub-cgroup installs some bpf program, the
program in this cgroup yields to sub-cgroup program.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">F_ALLOW_OVERRIDE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x1</span></code></pre></div><div class="anal-decl"><b>Flag for prog_attach command. If a sub-cgroup installs some bpf program,
that cgroup program gets run in addition to the program in this cgroup.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">F_ALLOW_MULTI</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x2</span></code></pre></div><div class="anal-decl"><b>Flag for prog_attach command.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">F_REPLACE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x4</span></code></pre></div><div class="anal-decl"><b>If BPF_F_STRICT_ALIGNMENT is used in BPF_PROG_LOAD command, the verifier
will perform strict alignment checking as if the kernel has been built with
CONFIG_EFFICIENT_UNALIGNED_ACCESS not set, and NET_IP_ALIGN defined to 2.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">F_STRICT_ALIGNMENT</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x1</span></code></pre></div><div class="anal-decl"><b>If BPF_F_ANY_ALIGNMENT is used in BPF_PROF_LOAD command, the verifier will
allow any alignment whatsoever.  On platforms with strict alignment
requirements for loads ands stores (such as sparc and mips) the verifier
validates that all loads and stores provably follow this requirement.  This
flag turns that checking and enforcement off.

It is mostly used for testing when we want to validate the context and
memory access aspects of the verifier, but because of an unaligned access
the alignment check would trigger before the one we are interested in.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">F_ANY_ALIGNMENT</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x2</span></code></pre></div><div class="anal-decl"><b>BPF_F_TEST_RND_HI32 is used in BPF_PROG_LOAD command for testing purpose.
Verifier does sub-register def/use analysis and identifies instructions
whose def only matters for low 32-bit, high 32-bit is never referenced later
through implicit zero extension. Therefore verifier notifies JIT back-ends
that it is safe to ignore clearing high 32-bit for these instructions. This
saves some back-ends a lot of code-gen. However such optimization is not
necessary on some arches, for example x86_64, arm64 etc, whose JIT back-ends
hence hasn't used verifier's analysis result. But, we really want to have a
way to be able to verify the correctness of the described optimization on
x86_64 on which testsuites are frequently exercised.

So, this flag is introduced. Once it is set, verifier will randomize high
32-bit for those instructions who has been identified as safe to ignore
them.  Then, if verifier is not doing correct analysis, such randomization
will regress tests to expose bugs.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">F_TEST_RND_HI32</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x4</span></code></pre></div><div class="anal-decl"><b>When BPF ldimm64's insn[0].src_reg != 0 then this can have two extensions:
insn[0].src_reg:  BPF_PSEUDO_MAP_FD   BPF_PSEUDO_MAP_VALUE
insn[0].imm:      map fd              map fd
insn[1].imm:      0                   offset into value
insn[0].off:      0                   0
insn[1].off:      0                   0
ldimm64 rewrite:  address of map      address of map[0]+offset
verifier type:    CONST_PTR_TO_MAP    PTR_TO_MAP_VALUE
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">PSEUDO_MAP_FD</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">1</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">PSEUDO_MAP_VALUE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">2</span></code></pre></div><div class="anal-decl"><b>when bpf_call-&gt;src_reg == BPF_PSEUDO_CALL, bpf_call-&gt;imm == pc-relative
offset to another bpf function
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">PSEUDO_CALL</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">1</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_UPDATE_ELEM command. create new element or update existing
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ANY</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_UPDATE_ELEM command. create new element if it didn't exist
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">NOEXIST</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">1</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_UPDATE_ELEM command. update existing element
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">EXIST</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">2</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_UPDATE_ELEM command. spin_lock-ed map_lookup/map_update
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">F_LOCK</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">4</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command */
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_NO_PREALLOC</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x1</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command. Instead of having one common LRU list in
the BPF_MAP_TYPE_LRU_[PERCPU_]HASH map, use a percpu LRU list which can
scale and perform better.  Note, the LRU nodes (including free nodes) cannot
be moved across different LRU lists.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_NO_COMMON_LRU</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x2</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command. Specify numa node during map creation
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_NUMA_NODE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x4</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command. Flags for BPF object read access from
syscall side
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_RDONLY</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x8</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command. Flags for BPF object write access from
syscall side
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_WRONLY</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x10</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command. Flag for stack_map, store build_id+offset
instead of pointer
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_STACK_BUILD_ID</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x20</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command. Zero-initialize hash function seed. This
should only be used for testing.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_ZERO_SEED</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x40</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command Flags for accessing BPF object from program
side.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_RDONLY_PROG</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x80</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command. Flags for accessing BPF object from program
side.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_WRONLY_PROG</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x100</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command. Clone map from listener for newly accepted
socket
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_CLONE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x200</span></code></pre></div><div class="anal-decl"><b>flag for BPF_MAP_CREATE command. Enable memory-mapping BPF map
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">BPF_F_MMAPABLE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">0x400</span></code></pre></div></div></html>