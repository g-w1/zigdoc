<style type="text/css" >
.more-decls {
    padding-left: 50px;
}
.anal-decl {
 background-color: #F7A41D77;
}
code {
 background-color: #F7A41D77;
}
</style><style type="text/css" >
pre > code {
  display: block;
  overflow: auto;
  padding: 0.5em;
  color: black;
}

details {
  margin-bottom: 0.5em;
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Old versions of Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome, Edge, Opera and Firefox */
}

.tok {
  color: #333;
  font-style: normal;
}

.code {
  font-family: monospace;
  font-size: 0.8em;
}

.tok-kw {
  color: #333;
  font-weight: bold;
}

.tok-str {
  color: #d14;
}

.tok-builtin {
  color: #0086b3;
}

code.zig {
  color: #777;
  font-style: italic;
}

.tok-fn {
  color: #900;
  font-weight: bold;
}

.tok-null {
  color: #008080;
}

.tok-number {
  color: #008080;
}

.tok-type {
  color: #458;
  font-weight: bold;
}
</style><html><a href="null//os/windows.zig"><h1>/os/windows.zig</h1></a><div class="more-decls"></div><h2 style="color: orange;">types:</h2><div class="more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">OpenFileOptions</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">access_mask</span><span class="tok tok-symbol">:</span> <span class="tok">ACCESS_MASK</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">HANDLE</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">sa</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">SECURITY_ATTRIBUTES</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">share_access</span><span class="tok tok-symbol">:</span> <span class="tok">ULONG</span> <span class="tok tok-symbol">=</span> <span class="tok">FILE_SHARE_WRITE</span> <span class="tok tok-symbol">|</span> <span class="tok">FILE_SHARE_READ</span> <span class="tok tok-symbol">|</span> <span class="tok">FILE_SHARE_DELETE</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">share_access_nonblocking</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">creation</span><span class="tok tok-symbol">:</span> <span class="tok">ULONG</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">io_mode</span><span class="tok tok-symbol">:</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">ModeOverride</span></code></pre></div><div class="anal-decl"><b>If true, tries to open path as a directory.
Defaults to false.
</b><pre><code class="zig"><span class="tok">open_dir</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div><div class="anal-decl"><b>If false, tries to open path as a reparse point without dereferencing it.
Defaults to true.
</b><pre><code class="zig"><span class="tok">follow_symlinks</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">true</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">GetQueuedCompletionStatusResult</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">Normal</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Aborted</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Cancelled</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">EOF</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">DeleteFileOptions</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">HANDLE</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">remove_dir</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">false</span></code></pre></div></div></details></div><div class="anal-decl"><b>Specifies how to format volume path in the result of `GetFinalPathNameByHandle`.
Defaults to DOS volume names.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">GetFinalPathNameByHandleFormat</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">volume_name</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">enum</span> <span class="tok tok-symbol">{</span>
        <span class="tok tok-comment">/// Format as DOS volume name</span>
        <span class="tok">Dos</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-comment">/// Format as NT volume name</span>
        <span class="tok">Nt</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">.</span><span class="tok">Dos</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">PathSpace</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">data</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">PATH_MAX_WIDE</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">len</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span></code></pre></div></div></details><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">span</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok">PathSpace</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">data</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">len</span> <span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div></div></details></div></div><h2 style="color: orange;">funcs:</h2><div class="more-decls"><div class="anal-decl"><b>TODO when share_access_nonblocking is false, this implementation uses
untinterruptible sleep() to block. This is not the final iteration of the API.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">OpenFile</span><span class="tok tok-symbol">(</span><span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">options</span><span class="tok tok-symbol">:</span> <span class="tok">OpenFileOptions</span><span class="tok tok-symbol">)</span> <span class="tok">OpenError</span><span class="tok tok-symbol">!</span><span class="tok">HANDLE</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">CreatePipe</span><span class="tok tok-symbol">(</span><span class="tok">rd</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">wr</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">sattr</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">SECURITY_ATTRIBUTES</span><span class="tok tok-symbol">)</span> <span class="tok">CreatePipeError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">CreateEventEx</span><span class="tok tok-symbol">(</span><span class="tok">attributes</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">SECURITY_ATTRIBUTES</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span> <span class="tok">desired_access</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">HANDLE</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">nameW</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">sliceToPrefixedFileW</span><span class="tok tok-symbol">(</span><span class="tok">name</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">CreateEventExW</span><span class="tok tok-symbol">(</span><span class="tok">attributes</span><span class="tok tok-symbol">,</span> <span class="tok">nameW</span><span class="tok tok-symbol">.</span><span class="tok">span</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">ptr</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">,</span> <span class="tok">desired_access</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">CreateEventExW</span><span class="tok tok-symbol">(</span><span class="tok">attributes</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">SECURITY_ATTRIBUTES</span><span class="tok tok-symbol">,</span> <span class="tok">nameW</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span> <span class="tok">desired_access</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">HANDLE</span></code></pre></div><div class="anal-decl"><b>A Zig wrapper around `NtDeviceIoControlFile` and `NtFsControlFile` syscalls.
It implements similar behavior to `DeviceIoControl` and is meant to serve
as a direct substitute for that call.
TODO work out if we need to expose other arguments to the underlying syscalls.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">DeviceIoControl</span><span class="tok tok-symbol">(</span>
    <span class="tok">h</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">ioControlCode</span><span class="tok tok-symbol">:</span> <span class="tok">ULONG</span><span class="tok tok-symbol">,</span>
    <span class="tok">in</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">out</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">DeviceIoControlError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetOverlappedResult</span><span class="tok tok-symbol">(</span><span class="tok">h</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">overlapped</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">OVERLAPPED</span><span class="tok tok-symbol">,</span> <span class="tok">wait</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">DWORD</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetHandleInformation</span><span class="tok tok-symbol">(</span><span class="tok">h</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">mask</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok">SetHandleInformationError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Call RtlGenRandom() instead of CryptGetRandom() on Windows
https://github.com/rust-lang-nursery/rand/issues/111
https://bugzilla.mozilla.org/show_bug.cgi?id=504270
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">RtlGenRandom</span><span class="tok tok-symbol">(</span><span class="tok">output</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">RtlGenRandomError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">WaitForSingleObject</span><span class="tok tok-symbol">(</span><span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">milliseconds</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok">WaitForSingleObjectError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">WaitForSingleObjectEx</span><span class="tok tok-symbol">(</span><span class="tok">handle</span><span class="tok tok-symbol">,</span> <span class="tok">milliseconds</span><span class="tok tok-symbol">,</span> <span class="tok tok-null">false</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">WaitForSingleObjectEx</span><span class="tok tok-symbol">(</span><span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">milliseconds</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span> <span class="tok">alertable</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">)</span> <span class="tok">WaitForSingleObjectError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">WaitForMultipleObjectsEx</span><span class="tok tok-symbol">(</span><span class="tok">handles</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">waitAll</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">,</span> <span class="tok">milliseconds</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span> <span class="tok">alertable</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">CreateIoCompletionPort</span><span class="tok tok-symbol">(</span>
    <span class="tok">file_handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">existing_completion_port</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">completion_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
    <span class="tok">concurrent_thread_count</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">CreateIoCompletionPortError</span><span class="tok tok-symbol">!</span><span class="tok">HANDLE</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">PostQueuedCompletionStatus</span><span class="tok tok-symbol">(</span>
    <span class="tok">completion_port</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">bytes_transferred_count</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span>
    <span class="tok">completion_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpOverlapped</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">OVERLAPPED</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">PostQueuedCompletionStatusError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetQueuedCompletionStatus</span><span class="tok tok-symbol">(</span>
    <span class="tok">completion_port</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">bytes_transferred_count</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">DWORD</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpCompletionKey</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpOverlapped</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">OVERLAPPED</span><span class="tok tok-symbol">,</span>
    <span class="tok">dwMilliseconds</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">GetQueuedCompletionStatusResult</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetQueuedCompletionStatusEx</span><span class="tok tok-symbol">(</span>
    <span class="tok">completion_port</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">completion_port_entries</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok">OVERLAPPED_ENTRY</span><span class="tok tok-symbol">,</span>
    <span class="tok">timeout_ms</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">DWORD</span><span class="tok tok-symbol">,</span>
    <span class="tok">alertable</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">GetQueuedCompletionStatusError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">u32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">CloseHandle</span><span class="tok tok-symbol">(</span><span class="tok">hObject</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">ntdll</span><span class="tok tok-symbol">.</span><span class="tok">NtClose</span><span class="tok tok-symbol">(</span><span class="tok">hObject</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">==</span> <span class="tok tok-symbol">.</span><span class="tok">SUCCESS</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">FindClose</span><span class="tok tok-symbol">(</span><span class="tok">hFindFile</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">kernel32</span><span class="tok tok-symbol">.</span><span class="tok">FindClose</span><span class="tok tok-symbol">(</span><span class="tok">hFindFile</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>If buffer's length exceeds what a Windows DWORD integer can hold, it will be broken into
multiple non-atomic reads.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">ReadFile</span><span class="tok tok-symbol">(</span><span class="tok">in_hFile</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span> <span class="tok">io_mode</span><span class="tok tok-symbol">:</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">ModeOverride</span><span class="tok tok-symbol">)</span> <span class="tok">ReadFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">WriteFile</span><span class="tok tok-symbol">(</span>
    <span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">bytes</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span>
    <span class="tok">io_mode</span><span class="tok tok-symbol">:</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">ModeOverride</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">WriteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetCurrentDirectory</span><span class="tok tok-symbol">(</span><span class="tok">path_name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok">SetCurrentDirectoryError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>The result is a slice of `buffer`, indexed from 0.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetCurrentDirectory</span><span class="tok tok-symbol">(</span><span class="tok">buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">GetCurrentDirectoryError</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><b>Needs either:
- `SeCreateSymbolicLinkPrivilege` privilege
or
- Developper mode on Windows 10
otherwise fails with `error.AccessDenied`. In which case `sym_link_path` may still
be created on the file system but will lack reparse processing data applied to it.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">CreateSymbolicLink</span><span class="tok tok-symbol">(</span>
    <span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">sym_link_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span>
    <span class="tok">target_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span>
    <span class="tok">is_directory</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">CreateSymbolicLinkError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">ReadLink</span><span class="tok tok-symbol">(</span><span class="tok">dir</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">out_buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">ReadLinkError</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">DeleteFile</span><span class="tok tok-symbol">(</span><span class="tok">sub_path_w</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">options</span><span class="tok tok-symbol">:</span> <span class="tok">DeleteFileOptions</span><span class="tok tok-symbol">)</span> <span class="tok">DeleteFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">MoveFileEx</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">new_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok">MoveFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">old_path_w</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">sliceToPrefixedFileW</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">const</span> <span class="tok">new_path_w</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">sliceToPrefixedFileW</span><span class="tok tok-symbol">(</span><span class="tok">new_path</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">MoveFileExW</span><span class="tok tok-symbol">(</span><span class="tok">old_path_w</span><span class="tok tok-symbol">.</span><span class="tok">span</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">ptr</span><span class="tok tok-symbol">,</span> <span class="tok">new_path_w</span><span class="tok tok-symbol">.</span><span class="tok">span</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">ptr</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">MoveFileExW</span><span class="tok tok-symbol">(</span><span class="tok">old_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">new_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok">MoveFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetStdHandle</span><span class="tok tok-symbol">(</span><span class="tok">handle_id</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok">GetStdHandleError</span><span class="tok tok-symbol">!</span><span class="tok">HANDLE</span></code></pre></div><div class="anal-decl"><b>The SetFilePointerEx function with the `dwMoveMethod` parameter set to `FILE_BEGIN`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetFilePointerEx_BEGIN</span><span class="tok tok-symbol">(</span><span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">)</span> <span class="tok">SetFilePointerError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>The SetFilePointerEx function with the `dwMoveMethod` parameter set to `FILE_CURRENT`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetFilePointerEx_CURRENT</span><span class="tok tok-symbol">(</span><span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i64</span><span class="tok tok-symbol">)</span> <span class="tok">SetFilePointerError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>The SetFilePointerEx function with the `dwMoveMethod` parameter set to `FILE_END`.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetFilePointerEx_END</span><span class="tok tok-symbol">(</span><span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">offset</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i64</span><span class="tok tok-symbol">)</span> <span class="tok">SetFilePointerError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>The SetFilePointerEx function with parameters to get the current offset.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetFilePointerEx_CURRENT_get</span><span class="tok tok-symbol">(</span><span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">)</span> <span class="tok">SetFilePointerError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">QueryObjectName</span><span class="tok tok-symbol">(</span>
    <span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">out_buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span></code></pre></div><div class="anal-decl"><b>Returns canonical (normalized) path of handle.
Use `GetFinalPathNameByHandleFormat` to specify whether the path is meant to include
NT or DOS volume name (e.g., `\Device\HarddiskVolume0\foo.txt` versus `C:\foo.txt`).
If DOS volume name format is selected, note that this function does *not* prepend
`\\?\` prefix to the resultant path.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetFinalPathNameByHandle</span><span class="tok tok-symbol">(</span>
    <span class="tok">hFile</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">fmt</span><span class="tok tok-symbol">:</span> <span class="tok">GetFinalPathNameByHandleFormat</span><span class="tok tok-symbol">,</span>
    <span class="tok">out_buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">GetFinalPathNameByHandleError</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">QueryInformationFile</span><span class="tok tok-symbol">(</span>
    <span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">info_class</span><span class="tok tok-symbol">:</span> <span class="tok">FILE_INFORMATION_CLASS</span><span class="tok tok-symbol">,</span>
    <span class="tok">out_buffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">QueryInformationFileError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetFileSizeEx</span><span class="tok tok-symbol">(</span><span class="tok">hFile</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">)</span> <span class="tok">GetFileSizeError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetFileAttributes</span><span class="tok tok-symbol">(</span><span class="tok">filename</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">GetFileAttributesError</span><span class="tok tok-symbol">!</span><span class="tok">DWORD</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">filename_w</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">sliceToPrefixedFileW</span><span class="tok tok-symbol">(</span><span class="tok">filename</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">GetFileAttributesW</span><span class="tok tok-symbol">(</span><span class="tok">filename_w</span><span class="tok tok-symbol">.</span><span class="tok">span</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">ptr</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetFileAttributesW</span><span class="tok tok-symbol">(</span><span class="tok">lpFileName</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok">GetFileAttributesError</span><span class="tok tok-symbol">!</span><span class="tok">DWORD</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">WSAStartup</span><span class="tok tok-symbol">(</span><span class="tok">majorVersion</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">minorVersion</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">WSADATA</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">WSACleanup</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Microsoft requires WSAStartup to be called to initialize, or else
WSASocketW will return WSANOTINITIALISED.
Since this is a standard library, we do not have the luxury of
putting initialization code anywhere, because we would not want
to pay the cost of calling WSAStartup if there ended up being no
networking. Also, if Zig code is used as a library, Zig is not in
charge of the start code, and we couldn't put in any initialization
code even if we wanted to.
The documentation for WSAStartup mentions that there must be a
matching WSACleanup call. It is not possible for the Zig Standard
Library to honor this for the same reason - there is nowhere to put
deinitialization code.
So, API users of the zig std lib have two options:
* (recommended) The simple, cross-platform way: just call `WSASocketW`
and don't worry about it. Zig will call WSAStartup() in a thread-safe
manner and never deinitialize networking. This is ideal for an
application which has the capability to do networking.
* The getting-your-hands-dirty way: call `WSAStartup()` before doing
networking, so that the error handling code for WSANOTINITIALISED never
gets run, which then allows the application or library to call `WSACleanup()`.
This could make sense for a library, which has init and deinit
functions for the whole library's lifetime.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">WSASocketW</span><span class="tok tok-symbol">(</span>
    <span class="tok">af</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i32</span><span class="tok tok-symbol">,</span>
    <span class="tok">socket_type</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i32</span><span class="tok tok-symbol">,</span>
    <span class="tok">protocol</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i32</span><span class="tok tok-symbol">,</span>
    <span class="tok">protocolInfo</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">WSAPROTOCOL_INFOW</span><span class="tok tok-symbol">,</span>
    <span class="tok">g</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">GROUP</span><span class="tok tok-symbol">,</span>
    <span class="tok">dwFlags</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">bind</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">sockaddr</span><span class="tok tok-symbol">,</span> <span class="tok">namelen</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">socklen_t</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i32</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">bind</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-builtin">@intCast</span><span class="tok tok-symbol">(</span><span class="tok tok-type">i32</span><span class="tok tok-symbol">,</span> <span class="tok">namelen</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">listen</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span> <span class="tok">backlog</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u31</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i32</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">listen</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">,</span> <span class="tok">backlog</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">closesocket</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">accept</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">sockaddr</span><span class="tok tok-symbol">,</span> <span class="tok">namelen</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">socklen_t</span><span class="tok tok-symbol">)</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">(</span><span class="tok">name</span> <span class="tok tok-symbol">==</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">==</span> <span class="tok tok-symbol">(</span><span class="tok">namelen</span> <span class="tok tok-symbol">==</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">accept</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-type">i32</span><span class="tok tok-symbol">,</span> <span class="tok">namelen</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">getsockname</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">sockaddr</span><span class="tok tok-symbol">,</span> <span class="tok">namelen</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">socklen_t</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i32</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">getsockname</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">*</span><span class="tok tok-type">i32</span><span class="tok tok-symbol">,</span> <span class="tok">namelen</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">getpeername</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">sockaddr</span><span class="tok tok-symbol">,</span> <span class="tok">namelen</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">socklen_t</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i32</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">getpeername</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">*</span><span class="tok tok-type">i32</span><span class="tok tok-symbol">,</span> <span class="tok">namelen</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">sendmsg</span><span class="tok tok-symbol">(</span>
    <span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span>
    <span class="tok">msg</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">WSAMSG</span><span class="tok tok-symbol">,</span>
    <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-type">i32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">sendto</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span> <span class="tok">buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">len</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span> <span class="tok">to</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">sockaddr</span><span class="tok tok-symbol">,</span> <span class="tok">to_len</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">socklen_t</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">recvfrom</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span> <span class="tok">buf</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">len</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span><span class="tok tok-symbol">,</span> <span class="tok">from</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">sockaddr</span><span class="tok tok-symbol">,</span> <span class="tok">from_len</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">socklen_t</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i32</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">poll</span><span class="tok tok-symbol">(</span><span class="tok">fds</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">pollfd</span><span class="tok tok-symbol">,</span> <span class="tok">n</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">c_ulong</span><span class="tok tok-symbol">,</span> <span class="tok">timeout</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i32</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i32</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">WSAPoll</span><span class="tok tok-symbol">(</span><span class="tok">fds</span><span class="tok tok-symbol">,</span> <span class="tok">n</span><span class="tok tok-symbol">,</span> <span class="tok">timeout</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">WSAIoctl</span><span class="tok tok-symbol">(</span>
    <span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span>
    <span class="tok">dwIoControlCode</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span>
    <span class="tok">inBuffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">outBuffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
    <span class="tok">overlapped</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">WSAOVERLAPPED</span><span class="tok tok-symbol">,</span>
    <span class="tok">completionRoutine</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">WSAOVERLAPPED_COMPLETION_ROUTINE</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">DWORD</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetModuleFileNameW</span><span class="tok tok-symbol">(</span><span class="tok">hModule</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">HMODULE</span><span class="tok tok-symbol">,</span> <span class="tok">buf_ptr</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">buf_len</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok">GetModuleFileNameError</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">TerminateProcess</span><span class="tok tok-symbol">(</span><span class="tok">hProcess</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">uExitCode</span><span class="tok tok-symbol">:</span> <span class="tok">UINT</span><span class="tok tok-symbol">)</span> <span class="tok">TerminateProcessError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">VirtualAlloc</span><span class="tok tok-symbol">(</span><span class="tok">addr</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">LPVOID</span><span class="tok tok-symbol">,</span> <span class="tok">size</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">alloc_type</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span> <span class="tok">flProtect</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok">VirtualAllocError</span><span class="tok tok-symbol">!</span><span class="tok">LPVOID</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">VirtualFree</span><span class="tok tok-symbol">(</span><span class="tok">lpAddress</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">LPVOID</span><span class="tok tok-symbol">,</span> <span class="tok">dwSize</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">dwFreeType</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">kernel32</span><span class="tok tok-symbol">.</span><span class="tok">VirtualFree</span><span class="tok tok-symbol">(</span><span class="tok">lpAddress</span><span class="tok tok-symbol">,</span> <span class="tok">dwSize</span><span class="tok tok-symbol">,</span> <span class="tok">dwFreeType</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetConsoleTextAttribute</span><span class="tok tok-symbol">(</span><span class="tok">hConsoleOutput</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">wAttributes</span><span class="tok tok-symbol">:</span> <span class="tok">WORD</span><span class="tok tok-symbol">)</span> <span class="tok">SetConsoleTextAttributeError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetConsoleCtrlHandler</span><span class="tok tok-symbol">(</span><span class="tok">handler_routine</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">HANDLER_ROUTINE</span><span class="tok tok-symbol">,</span> <span class="tok">add</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetFileCompletionNotificationModes</span><span class="tok tok-symbol">(</span><span class="tok">handle</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">flags</span><span class="tok tok-symbol">:</span> <span class="tok">UCHAR</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetEnvironmentStringsW</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok">GetEnvironmentStringsError</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">kernel32</span><span class="tok tok-symbol">.</span><span class="tok">GetEnvironmentStringsW</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">orelse</span> <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">OutOfMemory</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">FreeEnvironmentStringsW</span><span class="tok tok-symbol">(</span><span class="tok">penv</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">kernel32</span><span class="tok tok-symbol">.</span><span class="tok">FreeEnvironmentStringsW</span><span class="tok tok-symbol">(</span><span class="tok">penv</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetEnvironmentVariableW</span><span class="tok tok-symbol">(</span><span class="tok">lpName</span><span class="tok tok-symbol">:</span> <span class="tok">LPWSTR</span><span class="tok tok-symbol">,</span> <span class="tok">lpBuffer</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u16</span><span class="tok tok-symbol">,</span> <span class="tok">nSize</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">)</span> <span class="tok">GetEnvironmentVariableError</span><span class="tok tok-symbol">!</span><span class="tok">DWORD</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">CreateProcessW</span><span class="tok tok-symbol">(</span>
    <span class="tok">lpApplicationName</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">LPWSTR</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpCommandLine</span><span class="tok tok-symbol">:</span> <span class="tok">LPWSTR</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpProcessAttributes</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">SECURITY_ATTRIBUTES</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpThreadAttributes</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">SECURITY_ATTRIBUTES</span><span class="tok tok-symbol">,</span>
    <span class="tok">bInheritHandles</span><span class="tok tok-symbol">:</span> <span class="tok">BOOL</span><span class="tok tok-symbol">,</span>
    <span class="tok">dwCreationFlags</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpEnvironment</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-type">c_void</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpCurrentDirectory</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">LPWSTR</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpStartupInfo</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">STARTUPINFOW</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpProcessInformation</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">PROCESS_INFORMATION</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">CreateProcessError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">LoadLibraryW</span><span class="tok tok-symbol">(</span><span class="tok">lpLibFileName</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok">LoadLibraryError</span><span class="tok tok-symbol">!</span><span class="tok">HMODULE</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">FreeLibrary</span><span class="tok tok-symbol">(</span><span class="tok">hModule</span><span class="tok tok-symbol">:</span> <span class="tok">HMODULE</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">kernel32</span><span class="tok tok-symbol">.</span><span class="tok">FreeLibrary</span><span class="tok tok-symbol">(</span><span class="tok">hModule</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">QueryPerformanceFrequency</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">QueryPerformanceCounter</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">InitOnceExecuteOnce</span><span class="tok tok-symbol">(</span><span class="tok">InitOnce</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">INIT_ONCE</span><span class="tok tok-symbol">,</span> <span class="tok">InitFn</span><span class="tok tok-symbol">:</span> <span class="tok">INIT_ONCE_FN</span><span class="tok tok-symbol">,</span> <span class="tok">Parameter</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-type">c_void</span><span class="tok tok-symbol">,</span> <span class="tok">Context</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-type">c_void</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">kernel32</span><span class="tok tok-symbol">.</span><span class="tok">InitOnceExecuteOnce</span><span class="tok tok-symbol">(</span><span class="tok">InitOnce</span><span class="tok tok-symbol">,</span> <span class="tok">InitFn</span><span class="tok tok-symbol">,</span> <span class="tok">Parameter</span><span class="tok tok-symbol">,</span> <span class="tok">Context</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">HeapFree</span><span class="tok tok-symbol">(</span><span class="tok">hHeap</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">dwFlags</span><span class="tok tok-symbol">:</span> <span class="tok">DWORD</span><span class="tok tok-symbol">,</span> <span class="tok">lpMem</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-type">c_void</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">kernel32</span><span class="tok tok-symbol">.</span><span class="tok">HeapFree</span><span class="tok tok-symbol">(</span><span class="tok">hHeap</span><span class="tok tok-symbol">,</span> <span class="tok">dwFlags</span><span class="tok tok-symbol">,</span> <span class="tok">lpMem</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">HeapDestroy</span><span class="tok tok-symbol">(</span><span class="tok">hHeap</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">kernel32</span><span class="tok tok-symbol">.</span><span class="tok">HeapDestroy</span><span class="tok tok-symbol">(</span><span class="tok">hHeap</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">GetFileInformationByHandle</span><span class="tok tok-symbol">(</span>
    <span class="tok">hFile</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">GetFileInformationByHandleError</span><span class="tok tok-symbol">!</span><span class="tok">BY_HANDLE_FILE_INFORMATION</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">SetFileTime</span><span class="tok tok-symbol">(</span>
    <span class="tok">hFile</span><span class="tok tok-symbol">:</span> <span class="tok">HANDLE</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpCreationTime</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">FILETIME</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpLastAccessTime</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">FILETIME</span><span class="tok tok-symbol">,</span>
    <span class="tok">lpLastWriteTime</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">FILETIME</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok">SetFileTimeError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">teb</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">*</span><span class="tok">TEB</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">peb</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">*</span><span class="tok">PEB</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">teb</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">ProcessEnvironmentBlock</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>A file time is a 64-bit value that represents the number of 100-nanosecond
intervals that have elapsed since 12:00 A.M. January 1, 1601 Coordinated
Universal Time (UTC).
This function returns the number of nanoseconds since the canonical epoch,
which is the POSIX one (Jan 01, 1970 AD).
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">fromSysTime</span><span class="tok tok-symbol">(</span><span class="tok">hns</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i64</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i128</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">adjusted_epoch</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i128</span> <span class="tok tok-symbol">=</span> <span class="tok">hns</span> <span class="tok tok-symbol">+</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">time</span><span class="tok tok-symbol">.</span><span class="tok">epoch</span><span class="tok tok-symbol">.</span><span class="tok">windows</span> <span class="tok tok-symbol">*</span> <span class="tok tok-symbol">(</span><span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">time</span><span class="tok tok-symbol">.</span><span class="tok">ns_per_s</span> <span class="tok tok-symbol">/</span> <span class="tok tok-number">100</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">adjusted_epoch</span> <span class="tok tok-symbol">*</span> <span class="tok tok-number">100</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">toSysTime</span><span class="tok tok-symbol">(</span><span class="tok">ns</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i128</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i64</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">hns</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@divFloor</span><span class="tok tok-symbol">(</span><span class="tok">ns</span><span class="tok tok-symbol">,</span> <span class="tok tok-number">100</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok tok-builtin">@intCast</span><span class="tok tok-symbol">(</span><span class="tok tok-type">i64</span><span class="tok tok-symbol">,</span> <span class="tok">hns</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">-</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">time</span><span class="tok tok-symbol">.</span><span class="tok">epoch</span><span class="tok tok-symbol">.</span><span class="tok">windows</span> <span class="tok tok-symbol">*</span> <span class="tok tok-symbol">(</span><span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">time</span><span class="tok tok-symbol">.</span><span class="tok">ns_per_s</span> <span class="tok tok-symbol">/</span> <span class="tok tok-number">100</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">fileTimeToNanoSeconds</span><span class="tok tok-symbol">(</span><span class="tok">ft</span><span class="tok tok-symbol">:</span> <span class="tok">FILETIME</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">i128</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">hns</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">(</span><span class="tok tok-builtin">@as</span><span class="tok tok-symbol">(</span><span class="tok tok-type">i64</span><span class="tok tok-symbol">,</span> <span class="tok">ft</span><span class="tok tok-symbol">.</span><span class="tok">dwHighDateTime</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">&lt;&lt;</span> <span class="tok tok-number">32</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span> <span class="tok">ft</span><span class="tok tok-symbol">.</span><span class="tok">dwLowDateTime</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">fromSysTime</span><span class="tok tok-symbol">(</span><span class="tok">hns</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Converts a number of nanoseconds since the POSIX epoch to a Windows FILETIME.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">nanoSecondsToFileTime</span><span class="tok tok-symbol">(</span><span class="tok">ns</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">i128</span><span class="tok tok-symbol">)</span> <span class="tok">FILETIME</span></code></pre></div><div class="anal-decl"><b>Removes '.' and '..' path components from a &quot;sanitized relative path&quot;.
A &quot;sanitized path&quot; is one where:
1) all forward slashes have been replaced with back slashes
2) all repeating back slashes have been collapsed
3) the path is a relative one (does not start with a back slash)
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">removeDotDirsSanitized</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">comptime</span> <span class="tok">T</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">type</span><span class="tok tok-symbol">,</span> <span class="tok">path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok">T</span><span class="tok tok-symbol">)</span> <span class="tok">RemoveDotDirsError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>Normalizes a Windows path with the following steps:
1) convert all forward slashes to back slashes
2) collapse duplicate back slashes
3) remove '.' and '..' directory parts
Returns the length of the new path.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">normalizePath</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">comptime</span> <span class="tok">T</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">type</span><span class="tok tok-symbol">,</span> <span class="tok">path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok">T</span><span class="tok tok-symbol">)</span> <span class="tok">RemoveDotDirsError</span><span class="tok tok-symbol">!</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><b>Same as `sliceToPrefixedFileW` but accepts a pointer
to a null-terminated path.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">cStrToPrefixedFileW</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">PathSpace</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">sliceToPrefixedFileW</span><span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">spanZ</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Converts the path `s` to WTF16, null-terminated. If the path is absolute,
it will get NT-style prefix `\??\` prepended automatically.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">sliceToPrefixedFileW</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">PathSpace</span></code></pre></div><div class="anal-decl"><b>Assumes an absolute path.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">wToPrefixedFileW</span><span class="tok tok-symbol">(</span><span class="tok">s</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u16</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">PathSpace</span></code></pre></div><div class="anal-decl"><b>Loads a Winsock extension function in runtime specified by a GUID.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">loadWinsockExtensionFunction</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">comptime</span> <span class="tok">T</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">type</span><span class="tok tok-symbol">,</span> <span class="tok">sock</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">SOCKET</span><span class="tok tok-symbol">,</span> <span class="tok">guid</span><span class="tok tok-symbol">:</span> <span class="tok">GUID</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">T</span></code></pre></div><div class="anal-decl"><b>Call this when you made a windows DLL call or something that does SetLastError
and you get an unexpected error.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">unexpectedError</span><span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">:</span> <span class="tok">Win32Error</span><span class="tok tok-symbol">)</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">UnexpectedError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">unexpectedWSAError</span><span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">:</span> <span class="tok">ws2_32</span><span class="tok tok-symbol">.</span><span class="tok">WinsockError</span><span class="tok tok-symbol">)</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">UnexpectedError</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">unexpectedError</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@intToEnum</span><span class="tok tok-symbol">(</span><span class="tok">Win32Error</span><span class="tok tok-symbol">,</span> <span class="tok tok-builtin">@enumToInt</span><span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Call this when you made a windows NtDll call
and you get an unexpected status.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">unexpectedStatus</span><span class="tok tok-symbol">(</span><span class="tok">status</span><span class="tok tok-symbol">:</span> <span class="tok">NTSTATUS</span><span class="tok tok-symbol">)</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">UnexpectedError</span></code></pre></div></div><h2 style="color: orange;">values:</h2><div class="more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">advapi32</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/advapi32.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">kernel32</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/kernel32.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ntdll</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/ntdll.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ole32</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/ole32.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">psapi</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/psapi.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">shell32</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/shell32.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">user32</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/user32.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ws2_32</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/ws2_32.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">gdi32</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/gdi32.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">winmm</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@import</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;windows/winmm.zig&quot;</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">self_process_handle</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@intToPtr</span><span class="tok tok-symbol">(</span><span class="tok">HANDLE</span><span class="tok tok-symbol">,</span> <span class="tok">maxInt</span><span class="tok tok-symbol">(</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">OpenError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">IsDir</span><span class="tok tok-symbol">,</span>
    <span class="tok">NotDir</span><span class="tok tok-symbol">,</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">NoDevice</span><span class="tok tok-symbol">,</span>
    <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
    <span class="tok">PipeBusy</span><span class="tok tok-symbol">,</span>
    <span class="tok">PathAlreadyExists</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
    <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
    <span class="tok">WouldBlock</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">CreatePipeError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">DeviceIoControlError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span> <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span> <span class="tok">Unexpected</span> <span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SetHandleInformationError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">RtlGenRandomError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">WaitForSingleObjectError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">WaitAbandoned</span><span class="tok tok-symbol">,</span>
    <span class="tok">WaitTimeOut</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">CreateIoCompletionPortError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">PostQueuedCompletionStatusError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetQueuedCompletionStatusError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">Aborted</span><span class="tok tok-symbol">,</span>
    <span class="tok">Cancelled</span><span class="tok tok-symbol">,</span>
    <span class="tok">EOF</span><span class="tok tok-symbol">,</span>
    <span class="tok">Timeout</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span> <span class="tok tok-symbol">||</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">os</span><span class="tok tok-symbol">.</span><span class="tok">UnexpectedError</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ReadFileError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">OperationAborted</span><span class="tok tok-symbol">,</span>
    <span class="tok">BrokenPipe</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">WriteFileError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">SystemResources</span><span class="tok tok-symbol">,</span>
    <span class="tok">OperationAborted</span><span class="tok tok-symbol">,</span>
    <span class="tok">BrokenPipe</span><span class="tok tok-symbol">,</span>
    <span class="tok">NotOpenForWriting</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SetCurrentDirectoryError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
    <span class="tok">InvalidUtf8</span><span class="tok tok-symbol">,</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">NotDir</span><span class="tok tok-symbol">,</span>
    <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
    <span class="tok">NoDevice</span><span class="tok tok-symbol">,</span>
    <span class="tok">BadPathName</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetCurrentDirectoryError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">CreateSymbolicLinkError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
    <span class="tok">PathAlreadyExists</span><span class="tok tok-symbol">,</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
    <span class="tok">NoDevice</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ReadLinkError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
    <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
    <span class="tok">UnsupportedReparsePointType</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">DeleteFileError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
    <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-comment">/// Also known as sharing violation.</span>
    <span class="tok">FileBusy</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
    <span class="tok">NotDir</span><span class="tok tok-symbol">,</span>
    <span class="tok">IsDir</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">MoveFileError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span> <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span> <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span> <span class="tok">Unexpected</span> <span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetStdHandleError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">NoStandardHandleAttached</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SetFilePointerError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetFinalPathNameByHandleError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
    <span class="tok">BadPathName</span><span class="tok tok-symbol">,</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">NameTooLong</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">QueryInformationFileError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetFileSizeError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetFileAttributesError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">PermissionDenied</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">TerminateProcessError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">VirtualAllocError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SetConsoleTextAttributeError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetEnvironmentStringsError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">OutOfMemory</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetEnvironmentVariableError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">EnvironmentVariableNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">CreateProcessError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">AccessDenied</span><span class="tok tok-symbol">,</span>
    <span class="tok">InvalidName</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">LoadLibraryError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
    <span class="tok">Unexpected</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">GetFileInformationByHandleError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">SetFileTimeError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">Unexpected</span><span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>The error type for `removeDotDirsSanitized`
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">RemoveDotDirsError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span><span class="tok">TooManyParentDirs</span><span class="tok tok-symbol">}</span></code></pre></div></div></html>