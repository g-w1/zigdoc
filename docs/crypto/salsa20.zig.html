<style type="text/css" >
.more-decls {
    padding-left: 50px;
}
.anal-decl {
 background-color: #F7A41D77;
}
code {
 background-color: #F7A41D77;
}
</style><style type="text/css" >
pre > code {
  display: block;
  overflow: auto;
  padding: 0.5em;
  color: black;
}

details {
  margin-bottom: 0.5em;
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Old versions of Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome, Edge, Opera and Firefox */
}

.tok {
  color: #333;
  font-style: normal;
}

.code {
  font-family: monospace;
  font-size: 0.8em;
}

.tok-kw {
  color: #333;
  font-weight: bold;
}

.tok-str {
  color: #d14;
}

.tok-builtin {
  color: #0086b3;
}

code.zig {
  color: #777;
  font-style: italic;
}

.tok-fn {
  color: #900;
  font-weight: bold;
}

.tok-null {
  color: #008080;
}

.tok-number {
  color: #008080;
}

.tok-type {
  color: #458;
  font-weight: bold;
}
</style><html><a href="https://github.com/ziglang/zig/blob/master/lib/std//crypto/salsa20.zig"><h1>/crypto/salsa20.zig</h1></a><div class="more-decls"></div><h2 style="color: orange;">types:</h2><div class="more-decls"><div class="anal-decl"><b>The Salsa20 stream cipher.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L329">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Salsa20</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><b>Add the output of the Salsa20 stream cipher to `in` and stores the result into `out`.
WARNING: This function doesn't provide authenticated encryption.
Using the AEAD or one of the `box` versions is usually preferred.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L338">src</a><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">xor</span><span class="tok tok-symbol">(</span><span class="tok">out</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">in</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">counter</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span> <span class="tok">key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">key_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">nonce</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">nonce_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div></div></details><details><summary>values:</summary><div class="md-vals more-decls"><div class="anal-decl"><b>Nonce length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L331">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">nonce_length</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">8</span></code></pre></div><div class="anal-decl"><b>Key length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L333">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">key_length</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">32</span></code></pre></div></div></details></div><div class="anal-decl"><b>The XSalsa20 stream cipher.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L351">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">XSalsa20</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><b>Add the output of the XSalsa20 stream cipher to `in` and stores the result into `out`.
WARNING: This function doesn't provide authenticated encryption.
Using the AEAD or one of the `box` versions is usually preferred.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L360">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">xor</span><span class="tok tok-symbol">(</span><span class="tok">out</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">in</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">counter</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span><span class="tok tok-symbol">,</span> <span class="tok">key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">key_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">nonce</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">nonce_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">extended</span> <span class="tok tok-symbol">=</span> <span class="tok">extend</span><span class="tok tok-symbol">(</span><span class="tok">key</span><span class="tok tok-symbol">,</span> <span class="tok">nonce</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">Salsa20</span><span class="tok tok-symbol">.</span><span class="tok">xor</span><span class="tok tok-symbol">(</span><span class="tok">out</span><span class="tok tok-symbol">,</span> <span class="tok">in</span><span class="tok tok-symbol">,</span> <span class="tok">counter</span><span class="tok tok-symbol">,</span> <span class="tok">extended</span><span class="tok tok-symbol">.</span><span class="tok">key</span><span class="tok tok-symbol">,</span> <span class="tok">extended</span><span class="tok tok-symbol">.</span><span class="tok">nonce</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div></div></details><details><summary>values:</summary><div class="md-vals more-decls"><div class="anal-decl"><b>Nonce length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L353">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">nonce_length</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">24</span></code></pre></div><div class="anal-decl"><b>Key length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L355">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">key_length</span> <span class="tok tok-symbol">=</span> <span class="tok tok-number">32</span></code></pre></div></div></details></div><div class="anal-decl"><b>The XSalsa20 stream cipher, combined with the Poly1305 MAC
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L367">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">XSalsa20Poly1305</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><b>c: ciphertext: output buffer should be of size m.len
tag: authentication tag: output MAC
m: message
ad: Associated Data
npub: public nonce
k: private key
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L381">src</a><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">encrypt</span><span class="tok tok-symbol">(</span><span class="tok">c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">tag</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-symbol">[</span><span class="tok">tag_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">m</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">ad</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">npub</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">nonce_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">k</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">key_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>m: message: output buffer should be of size c.len
c: ciphertext
tag: authentication tag
ad: Associated Data
npub: public nonce
k: private key
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L402">src</a><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">decrypt</span><span class="tok tok-symbol">(</span><span class="tok">m</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">tag</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">tag_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">ad</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">npub</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">nonce_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">k</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">key_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div></div></details><details><summary>values:</summary><div class="md-vals more-decls"><div class="anal-decl"><b>Authentication tag length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L369">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">tag_length</span> <span class="tok tok-symbol">=</span> <span class="tok">Poly1305</span><span class="tok tok-symbol">.</span><span class="tok">mac_length</span></code></pre></div><div class="anal-decl"><b>Nonce length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L371">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">nonce_length</span> <span class="tok tok-symbol">=</span> <span class="tok">XSalsa20</span><span class="tok tok-symbol">.</span><span class="tok">nonce_length</span></code></pre></div><div class="anal-decl"><b>Key length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L373">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">key_length</span> <span class="tok tok-symbol">=</span> <span class="tok">XSalsa20</span><span class="tok tok-symbol">.</span><span class="tok">key_length</span></code></pre></div></div></details></div><div class="anal-decl"><b>NaCl-compatible secretbox API.

A secretbox contains both an encrypted message and an authentication tag to verify that it hasn't been tampered with.
A secret key shared by all the recipients must be already known in order to use this API.

Nonces are 192-bit large and can safely be chosen with a random number generator.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L433">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">SecretBox</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><b>Encrypt and authenticate `m` using a nonce `npub` and a key `k`.
`c` must be exactly `tag_length` longer than `m`, as it will store both the ciphertext and the authentication tag.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L443">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">seal</span><span class="tok tok-symbol">(</span><span class="tok">c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">m</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">npub</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">nonce_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">k</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">key_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok">debug</span><span class="tok tok-symbol">.</span><span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">c</span><span class="tok tok-symbol">.</span><span class="tok">len</span> <span class="tok tok-symbol">==</span> <span class="tok">tag_length</span> <span class="tok tok-symbol">+</span> <span class="tok">m</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">XSalsa20Poly1305</span><span class="tok tok-symbol">.</span><span class="tok">encrypt</span><span class="tok tok-symbol">(</span><span class="tok">c</span><span class="tok tok-symbol">[</span><span class="tok">tag_length</span><span class="tok tok-symbol">..</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">,</span> <span class="tok">c</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok">tag_length</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">,</span> <span class="tok">m</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;&quot;</span><span class="tok tok-symbol">,</span> <span class="tok">npub</span><span class="tok tok-symbol">,</span> <span class="tok">k</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Verify and decrypt `c` using a nonce `npub` and a key `k`.
`m` must be exactly `tag_length` smaller than `c`, as `c` includes an authentication tag in addition to the encrypted message.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L450">src</a><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">open</span><span class="tok tok-symbol">(</span><span class="tok">m</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">npub</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">nonce_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">k</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">key_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div></div></details><details><summary>values:</summary><div class="md-vals more-decls"><div class="anal-decl"><b>Key length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L435">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">key_length</span> <span class="tok tok-symbol">=</span> <span class="tok">XSalsa20Poly1305</span><span class="tok tok-symbol">.</span><span class="tok">key_length</span></code></pre></div><div class="anal-decl"><b>Nonce length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L437">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">nonce_length</span> <span class="tok tok-symbol">=</span> <span class="tok">XSalsa20Poly1305</span><span class="tok tok-symbol">.</span><span class="tok">nonce_length</span></code></pre></div><div class="anal-decl"><b>Authentication tag length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L439">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">tag_length</span> <span class="tok tok-symbol">=</span> <span class="tok">XSalsa20Poly1305</span><span class="tok tok-symbol">.</span><span class="tok">tag_length</span></code></pre></div></div></details></div><div class="anal-decl"><b>NaCl-compatible box API.

A secretbox contains both an encrypted message and an authentication tag to verify that it hasn't been tampered with.
This construction uses public-key cryptography. A shared secret doesn't have to be known in advance by both parties.
Instead, a message is encrypted using a sender's secret key and a recipient's public key,
and is decrypted using the recipient's secret key and the sender's public key.

Nonces are 192-bit large and can safely be chosen with a random number generator.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L467">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Box</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><b>Compute a secret suitable for `secretbox` given a recipent's public key and a sender's secret key.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L485">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">createSharedSecret</span><span class="tok tok-symbol">(</span><span class="tok">public_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">public_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">secret_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">secret_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-symbol">[</span><span class="tok">shared_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">p</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">X25519</span><span class="tok tok-symbol">.</span><span class="tok">scalarmult</span><span class="tok tok-symbol">(</span><span class="tok">secret_key</span><span class="tok tok-symbol">,</span> <span class="tok">public_key</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">const</span> <span class="tok">zero</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">[</span><span class="tok">_</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">{</span><span class="tok tok-number">0</span><span class="tok tok-symbol">}</span> <span class="tok tok-symbol">**</span> <span class="tok tok-number">16</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">Salsa20Impl</span><span class="tok tok-symbol">.</span><span class="tok">hsalsa20</span><span class="tok tok-symbol">(</span><span class="tok">zero</span><span class="tok tok-symbol">,</span> <span class="tok">p</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Encrypt and authenticate a message using a recipient's public key `public_key` and a sender's `secret_key`.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L492">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">seal</span><span class="tok tok-symbol">(</span><span class="tok">c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">m</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">npub</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">nonce_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">public_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">public_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">secret_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">secret_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">shared_key</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">createSharedSecret</span><span class="tok tok-symbol">(</span><span class="tok">public_key</span><span class="tok tok-symbol">,</span> <span class="tok">secret_key</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">SecretBox</span><span class="tok tok-symbol">.</span><span class="tok">seal</span><span class="tok tok-symbol">(</span><span class="tok">c</span><span class="tok tok-symbol">,</span> <span class="tok">m</span><span class="tok tok-symbol">,</span> <span class="tok">npub</span><span class="tok tok-symbol">,</span> <span class="tok">shared_key</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Verify and decrypt a message using a recipient's secret key `public_key` and a sender's `public_key`.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L498">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">open</span><span class="tok tok-symbol">(</span><span class="tok">m</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">npub</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">nonce_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">public_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">public_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">secret_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">secret_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">shared_key</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">createSharedSecret</span><span class="tok tok-symbol">(</span><span class="tok">public_key</span><span class="tok tok-symbol">,</span> <span class="tok">secret_key</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">return</span> <span class="tok">SecretBox</span><span class="tok tok-symbol">.</span><span class="tok">open</span><span class="tok tok-symbol">(</span><span class="tok">m</span><span class="tok tok-symbol">,</span> <span class="tok">c</span><span class="tok tok-symbol">,</span> <span class="tok">npub</span><span class="tok tok-symbol">,</span> <span class="tok">shared_key</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div></div></details><details><summary>values:</summary><div class="md-vals more-decls"><div class="anal-decl"><b>Public key length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L469">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">public_length</span> <span class="tok tok-symbol">=</span> <span class="tok">X25519</span><span class="tok tok-symbol">.</span><span class="tok">public_length</span></code></pre></div><div class="anal-decl"><b>Secret key length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L471">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">secret_length</span> <span class="tok tok-symbol">=</span> <span class="tok">X25519</span><span class="tok tok-symbol">.</span><span class="tok">secret_length</span></code></pre></div><div class="anal-decl"><b>Shared key length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L473">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">shared_length</span> <span class="tok tok-symbol">=</span> <span class="tok">XSalsa20Poly1305</span><span class="tok tok-symbol">.</span><span class="tok">key_length</span></code></pre></div><div class="anal-decl"><b>Seed (for key pair creation) length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L475">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">seed_length</span> <span class="tok tok-symbol">=</span> <span class="tok">X25519</span><span class="tok tok-symbol">.</span><span class="tok">seed_length</span></code></pre></div><div class="anal-decl"><b>Nonce length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L477">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">nonce_length</span> <span class="tok tok-symbol">=</span> <span class="tok">XSalsa20Poly1305</span><span class="tok tok-symbol">.</span><span class="tok">nonce_length</span></code></pre></div><div class="anal-decl"><b>Authentication tag length in bytes.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L479">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">tag_length</span> <span class="tok tok-symbol">=</span> <span class="tok">XSalsa20Poly1305</span><span class="tok tok-symbol">.</span><span class="tok">tag_length</span></code></pre></div><div class="anal-decl"><b>A key pair.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L482">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">KeyPair</span> <span class="tok tok-symbol">=</span> <span class="tok">X25519</span><span class="tok tok-symbol">.</span><span class="tok">KeyPair</span></code></pre></div></div></details></div><div class="anal-decl"><b>libsodium-compatible sealed boxes

Sealed boxes are designed to anonymously send messages to a recipient given their public key.
Only the recipient can decrypt these messages, using their private key.
While the recipient can verify the integrity of the message, it cannot verify the identity of the sender.

A message is encrypted using an ephemeral key pair, whose secret part is destroyed right after the encryption process.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L511">src</a><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">SealedBox</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><b>Encrypt a message `m` for a recipient whose public key is `public_key`.
`c` must be `seal_length` bytes larger than `m`, so that the required metadata can be added.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L531">src</a><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">seal</span><span class="tok tok-symbol">(</span><span class="tok">c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">m</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">public_key</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">public_length</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Decrypt a message using a key pair.
`m` must be exactly `seal_length` bytes smaller than `c`, as `c` also includes metadata.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L542">src</a><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">open</span><span class="tok tok-symbol">(</span><span class="tok">m</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">c</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">keypair</span><span class="tok tok-symbol">:</span> <span class="tok">KeyPair</span><span class="tok tok-symbol">)</span> <span class="tok">Error</span><span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div></div></details><details><summary>values:</summary><div class="md-vals more-decls"><div class="anal-decl"><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L512">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">public_length</span> <span class="tok tok-symbol">=</span> <span class="tok">Box</span><span class="tok tok-symbol">.</span><span class="tok">public_length</span></code></pre></div><div class="anal-decl"><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L513">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">secret_length</span> <span class="tok tok-symbol">=</span> <span class="tok">Box</span><span class="tok tok-symbol">.</span><span class="tok">secret_length</span></code></pre></div><div class="anal-decl"><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L514">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">seed_length</span> <span class="tok tok-symbol">=</span> <span class="tok">Box</span><span class="tok tok-symbol">.</span><span class="tok">seed_length</span></code></pre></div><div class="anal-decl"><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L515">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">seal_length</span> <span class="tok tok-symbol">=</span> <span class="tok">Box</span><span class="tok tok-symbol">.</span><span class="tok">public_length</span> <span class="tok tok-symbol">+</span> <span class="tok">Box</span><span class="tok tok-symbol">.</span><span class="tok">tag_length</span></code></pre></div><div class="anal-decl"><b>A key pair.
</b><a href="https://github.com/ziglang/zig/blob/master/lib/std/crypto/salsa20.zig#L518">src</a><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">KeyPair</span> <span class="tok tok-symbol">=</span> <span class="tok">Box</span><span class="tok tok-symbol">.</span><span class="tok">KeyPair</span></code></pre></div></div></details></div></div><div class="more-decls"></div><div class="more-decls"></div></html>