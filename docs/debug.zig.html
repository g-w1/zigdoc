<style type="text/css" >
.more-decls {
    padding-left: 50px;
}
.anal-decl {
 background-color: #F7A41D77;
}
code {
 background-color: #F7A41D77;
}
</style><style type="text/css" >
pre > code {
  display: block;
  overflow: auto;
  padding: 0.5em;
  color: black;
}

details {
  margin-bottom: 0.5em;
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Old versions of Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome, Edge, Opera and Firefox */
}

.tok {
  color: #333;
  font-style: normal;
}

.code {
  font-family: monospace;
  font-size: 0.8em;
}

.tok-kw {
  color: #333;
  font-weight: bold;
}

.tok-str {
  color: #d14;
}

.tok-builtin {
  color: #0086b3;
}

code.zig {
  color: #777;
  font-style: italic;
}

.tok-fn {
  color: #900;
  font-weight: bold;
}

.tok-null {
  color: #008080;
}

.tok-number {
  color: #008080;
}

.tok-type {
  color: #458;
  font-weight: bold;
}
</style><html><a href="null//debug.zig"><h1>/debug.zig</h1></a><div class="more-decls"></div><h2 style="color: orange;">types:</h2><div class="more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">LineInfo</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">line</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">column</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u64</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">file_name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">SymbolInfo</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">symbol_name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span> <span class="tok tok-symbol">=</span> <span class="tok tok-str">&quot;???&quot;</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">compile_unit_name</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span> <span class="tok tok-symbol">=</span> <span class="tok tok-str">&quot;???&quot;</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">line_info</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok">LineInfo</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">StackIterator</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">first_address</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">fp</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span></code></pre></div></div></details><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">init</span><span class="tok tok-symbol">(</span><span class="tok">first_address</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">fp</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span> <span class="tok">StackIterator</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">next</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">StackIterator</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">TTY</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>types:</summary><div class="md-types more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Color</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">Red</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Green</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Cyan</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">White</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Dim</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Bold</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">Reset</span></code></pre></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">Config</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">enum</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">no_color</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">escape_codes</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">windows_api</span></code></pre></div></div></details><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">setColor</span><span class="tok tok-symbol">(</span><span class="tok">conf</span><span class="tok tok-symbol">:</span> <span class="tok">Config</span><span class="tok tok-symbol">,</span> <span class="tok">out_stream</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">color</span><span class="tok tok-symbol">:</span> <span class="tok">Color</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div></div></details></div></div></details></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">const</span> <span class="tok">DebugInfo</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">struct</span></code></pre><details><summary>fields:</summary><div class="md-fields more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok">address_map</span><span class="tok tok-symbol">:</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">AutoHashMap</span><span class="tok tok-symbol">(</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">*</span><span class="tok">ModuleDebugInfo</span><span class="tok tok-symbol">)</span></code></pre></div></div></details><details><summary>funcs</summary><div class="md-funcs more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">init</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span><span class="tok tok-symbol">)</span> <span class="tok">DebugInfo</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok">DebugInfo</span><span class="tok tok-symbol">{</span>
        <span class="tok tok-symbol">.</span><span class="tok">allocator</span> <span class="tok tok-symbol">=</span> <span class="tok">allocator</span><span class="tok tok-symbol">,</span>
        <span class="tok tok-symbol">.</span><span class="tok">address_map</span> <span class="tok tok-symbol">=</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">AutoHashMap</span><span class="tok tok-symbol">(</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">*</span><span class="tok">ModuleDebugInfo</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">init</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">deinit</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">DebugInfo</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    // TODO: resources https://github.com/ziglang/zig/issues/4353
    <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">address_map</span><span class="tok tok-symbol">.</span><span class="tok">deinit</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">getModuleForAddress</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">DebugInfo</span><span class="tok tok-symbol">,</span> <span class="tok">address</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">*</span><span class="tok">ModuleDebugInfo</span></code></pre></div></div></details></div></div><h2 style="color: orange;">funcs:</h2><div class="more-decls"><div class="anal-decl"><b>Print to stderr, unbuffered, and silently returning on failure. Intended
for use in &quot;printf debugging.&quot; Use `std.log` functions for proper logging.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">print</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">comptime</span> <span class="tok">fmt</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">held</span> <span class="tok tok-symbol">=</span> <span class="tok">stderr_mutex</span><span class="tok tok-symbol">.</span><span class="tok">acquire</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">defer</span> <span class="tok">held</span><span class="tok tok-symbol">.</span><span class="tok">release</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">const</span> <span class="tok">stderr</span> <span class="tok tok-symbol">=</span> <span class="tok">io</span><span class="tok tok-symbol">.</span><span class="tok">getStdErr</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">writer</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-kw">nosuspend</span> <span class="tok">stderr</span><span class="tok tok-symbol">.</span><span class="tok">print</span><span class="tok tok-symbol">(</span><span class="tok">fmt</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-kw">return</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">getStderrMutex</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">*</span><span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">Thread</span><span class="tok tok-symbol">.</span><span class="tok">Mutex</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">return</span> <span class="tok tok-symbol">&amp;</span><span class="tok">stderr_mutex</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">getSelfDebugInfo</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-symbol">*</span><span class="tok">DebugInfo</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">detectTTYConfig</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok">TTY</span><span class="tok tok-symbol">.</span><span class="tok">Config</span></code></pre></div><div class="anal-decl"><b>Tries to print the current stack trace to stderr, unbuffered, and ignores any error returned.
TODO multithreaded awareness
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">dumpCurrentStackTrace</span><span class="tok tok-symbol">(</span><span class="tok">start_addr</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Tries to print the stack trace starting from the supplied base pointer to stderr,
unbuffered, and ignores any error returned.
TODO multithreaded awareness
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">dumpStackTraceFromBase</span><span class="tok tok-symbol">(</span><span class="tok">bp</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">ip</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Returns a slice with the same pointer as addresses, with a potentially smaller len.
On Windows, when first_address is not null, we ask for at least 32 stack frames,
and then try to find the first address. If addresses.len is more than 32, we
capture that many stack frames exactly, and then look for the first address,
chopping off the irrelevant frames and shifting so that the returned addresses pointer
equals the passed in addresses pointer.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">captureStackTrace</span><span class="tok tok-symbol">(</span><span class="tok">first_address</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">stack_trace</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">StackTrace</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>Tries to print a stack trace to stderr, unbuffered, and ignores any error returned.
TODO multithreaded awareness
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">dumpStackTrace</span><span class="tok tok-symbol">(</span><span class="tok">stack_trace</span><span class="tok tok-symbol">:</span> <span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">StackTrace</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>This function invokes undefined behavior when `ok` is `false`.
In Debug and ReleaseSafe modes, calls to this function are always
generated, and the `unreachable` statement triggers a panic.
In ReleaseFast and ReleaseSmall modes, calls to this function are
optimized away, and in fact the optimizer is able to use the assertion
in its heuristics.
Inside a test block, it is best to use the `std.testing` module rather
than this function, because this function may not detect a test failure
in ReleaseFast and ReleaseSmall mode. Outside of a test block, this assert
function is the correct function to use.
</b><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">assert</span><span class="tok tok-symbol">(</span><span class="tok">ok</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok tok-symbol">!</span><span class="tok">ok</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">;</span> // assertion failure
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">panic</span><span class="tok tok-symbol">(</span><span class="tok tok-kw">comptime</span> <span class="tok">format</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">noreturn</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-builtin">@setCold</span><span class="tok tok-symbol">(</span><span class="tok tok-null">true</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    // TODO: remove conditional once wasi / LLVM defines __builtin_return_address
    <span class="tok tok-kw">const</span> <span class="tok">first_trace_addr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">native_os</span> <span class="tok tok-symbol">==</span> <span class="tok tok-symbol">.</span><span class="tok">wasi</span><span class="tok tok-symbol">)</span> <span class="tok tok-null">null</span> <span class="tok tok-kw">else</span> <span class="tok tok-builtin">@returnAddress</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">panicExtra</span><span class="tok tok-symbol">(</span><span class="tok tok-null">null</span><span class="tok tok-symbol">,</span> <span class="tok">first_trace_addr</span><span class="tok tok-symbol">,</span> <span class="tok">format</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">panicExtra</span><span class="tok tok-symbol">(</span><span class="tok">trace</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">StackTrace</span><span class="tok tok-symbol">,</span> <span class="tok">first_trace_addr</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok tok-kw">comptime</span> <span class="tok">format</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">args</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">noreturn</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">writeStackTrace</span><span class="tok tok-symbol">(</span>
    <span class="tok">stack_trace</span><span class="tok tok-symbol">:</span> <span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">StackTrace</span><span class="tok tok-symbol">,</span>
    <span class="tok">out_stream</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span>
    <span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span>
    <span class="tok">debug_info</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">DebugInfo</span><span class="tok tok-symbol">,</span>
    <span class="tok">tty_config</span><span class="tok tok-symbol">:</span> <span class="tok">TTY</span><span class="tok tok-symbol">.</span><span class="tok">Config</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">writeCurrentStackTrace</span><span class="tok tok-symbol">(</span>
    <span class="tok">out_stream</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span>
    <span class="tok">debug_info</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">DebugInfo</span><span class="tok tok-symbol">,</span>
    <span class="tok">tty_config</span><span class="tok tok-symbol">:</span> <span class="tok">TTY</span><span class="tok tok-symbol">.</span><span class="tok">Config</span><span class="tok tok-symbol">,</span>
    <span class="tok">start_addr</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">writeCurrentStackTraceWindows</span><span class="tok tok-symbol">(</span>
    <span class="tok">out_stream</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span>
    <span class="tok">debug_info</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">DebugInfo</span><span class="tok tok-symbol">,</span>
    <span class="tok">tty_config</span><span class="tok tok-symbol">:</span> <span class="tok">TTY</span><span class="tok tok-symbol">.</span><span class="tok">Config</span><span class="tok tok-symbol">,</span>
    <span class="tok">start_addr</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>TODO resources https://github.com/ziglang/zig/issues/4353
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">printSourceAtAddress</span><span class="tok tok-symbol">(</span><span class="tok">debug_info</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">DebugInfo</span><span class="tok tok-symbol">,</span> <span class="tok">out_stream</span><span class="tok tok-symbol">:</span> <span class="tok tok-kw">anytype</span><span class="tok tok-symbol">,</span> <span class="tok">address</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span> <span class="tok">tty_config</span><span class="tok tok-symbol">:</span> <span class="tok">TTY</span><span class="tok tok-symbol">.</span><span class="tok">Config</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><b>TODO resources https://github.com/ziglang/zig/issues/4353
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">openSelfDebugInfo</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">anyerror</span><span class="tok tok-symbol">!</span><span class="tok">DebugInfo</span></code></pre></div><div class="anal-decl"><b>This takes ownership of elf_file: users of this function should not close
it themselves, even on error.
TODO resources https://github.com/ziglang/zig/issues/4353
TODO it's weird to take ownership even on error, rework this code.
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">readElfDebugInfo</span><span class="tok tok-symbol">(</span><span class="tok">allocator</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span><span class="tok tok-symbol">,</span> <span class="tok">elf_file</span><span class="tok tok-symbol">:</span> <span class="tok">File</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">ModuleDebugInfo</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">maybeEnableSegfaultHandler</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">enable_segfault_handler</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
        <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">debug</span><span class="tok tok-symbol">.</span><span class="tok">attachSegfaultHandler</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok tok-symbol">}</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Attaches a global SIGSEGV handler which calls @panic(&quot;segmentation fault&quot;);
</b><pre><code class="zig"><span class="tok tok-kw">fn</span> <span class="tok tok-fn">attachSegfaultHandler</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">dumpStackPointerAddr</span><span class="tok tok-symbol">(</span><span class="tok">prefix</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-type">void</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-kw">const</span> <span class="tok">sp</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">asm</span> <span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;&quot;</span>
        <span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok">argc</span><span class="tok tok-symbol">]</span> <span class="tok tok-str">&quot;={rsp}&quot;</span> <span class="tok tok-symbol">(</span><span class="tok tok-symbol">-&gt;</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span>
    <span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
    <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">debug</span><span class="tok tok-symbol">.</span><span class="tok">warn</span><span class="tok tok-symbol">(</span><span class="tok tok-str">&quot;{} sp = 0x{x}\n&quot;</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok tok-symbol">{</span> <span class="tok">prefix</span><span class="tok tok-symbol">,</span> <span class="tok">sp</span> <span class="tok tok-symbol">}</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
<span class="tok tok-symbol">}</span></code></pre></div></div><h2 style="color: orange;">values:</h2><div class="more-decls"><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">runtime_safety</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">builtin</span><span class="tok tok-symbol">.</span><span class="tok">mode</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-symbol">.</span><span class="tok">Debug</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">ReleaseSafe</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">true</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">.</span><span class="tok">ReleaseFast</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">ReleaseSmall</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">false</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Deprecated. Use `std.log` functions for logging or `std.debug.print` for
&quot;printf debugging&quot;.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">warn</span> <span class="tok tok-symbol">=</span> <span class="tok">print</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">OpenSelfDebugInfoError</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">{</span>
    <span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">,</span>
    <span class="tok">OutOfMemory</span><span class="tok tok-symbol">,</span>
    <span class="tok">UnsupportedOperatingSystem</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">ModuleDebugInfo</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">native_os</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-symbol">.</span><span class="tok">macos</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">ios</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">watchos</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">tvos</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">struct</span> <span class="tok tok-symbol">{</span>
        <span class="tok">base_address</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
        <span class="tok">mapped_memory</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
        <span class="tok">symbols</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok">MachoSymbol</span><span class="tok tok-symbol">,</span>
        <span class="tok">strings</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">:</span><span class="tok tok-number">0</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>
        <span class="tok">ofiles</span><span class="tok tok-symbol">:</span> <span class="tok">OFileTable</span><span class="tok tok-symbol">,</span>

        <span class="tok tok-kw">const</span> <span class="tok">OFileTable</span> <span class="tok tok-symbol">=</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">StringHashMap</span><span class="tok tok-symbol">(</span><span class="tok">DW</span><span class="tok tok-symbol">.</span><span class="tok">DwarfInfo</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

        <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">allocator</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span> <span class="tok tok-symbol">{</span>
            <span class="tok tok-kw">return</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">ofiles</span><span class="tok tok-symbol">.</span><span class="tok">allocator</span><span class="tok tok-symbol">;</span>
        <span class="tok tok-symbol">}</span>

        <span class="tok tok-kw">fn</span> <span class="tok tok-fn">loadOFile</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok">o_file_path</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">DW</span><span class="tok tok-symbol">.</span><span class="tok">DwarfInfo</span> <span class="tok tok-symbol">{</span>
            <span class="tok tok-kw">const</span> <span class="tok">o_file</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">fs</span><span class="tok tok-symbol">.</span><span class="tok">cwd</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">.</span><span class="tok">openFile</span><span class="tok tok-symbol">(</span><span class="tok">o_file_path</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok tok-symbol">{</span> <span class="tok tok-symbol">.</span><span class="tok">intended_io_mode</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">.</span><span class="tok">blocking</span> <span class="tok tok-symbol">}</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">const</span> <span class="tok">mapped_mem</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">mapWholeFile</span><span class="tok tok-symbol">(</span><span class="tok">o_file</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">const</span> <span class="tok">hdr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span>
                <span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">mach_header_64</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-builtin">@alignCast</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@alignOf</span><span class="tok tok-symbol">(</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">mach_header_64</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok">mapped_mem</span><span class="tok tok-symbol">.</span><span class="tok">ptr</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
            <span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">hdr</span><span class="tok tok-symbol">.</span><span class="tok">magic</span> <span class="tok tok-symbol">!=</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">MH_MAGIC_64</span><span class="tok tok-symbol">)</span>
                <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">InvalidDebugInfo</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">const</span> <span class="tok">hdr_base</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">hdr</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">var</span> <span class="tok">ptr</span> <span class="tok tok-symbol">=</span> <span class="tok">hdr_base</span> <span class="tok tok-symbol">+</span> <span class="tok tok-builtin">@sizeOf</span><span class="tok tok-symbol">(</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">mach_header_64</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">var</span> <span class="tok">ncmd</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">u32</span> <span class="tok tok-symbol">=</span> <span class="tok">hdr</span><span class="tok tok-symbol">.</span><span class="tok">ncmds</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">const</span> <span class="tok">segcmd</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">while</span> <span class="tok tok-symbol">(</span><span class="tok">ncmd</span> <span class="tok tok-symbol">!=</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">:</span> <span class="tok tok-symbol">(</span><span class="tok">ncmd</span> <span class="tok tok-symbol">-=</span> <span class="tok tok-number">1</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                <span class="tok tok-kw">const</span> <span class="tok">lc</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">load_command</span><span class="tok tok-symbol">,</span> <span class="tok">ptr</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">lc</span><span class="tok tok-symbol">.</span><span class="tok">cmd</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">LC_SEGMENT_64</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">break</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span>
                            <span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">segment_command_64</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-builtin">@alignCast</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@alignOf</span><span class="tok tok-symbol">(</span><span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">segment_command_64</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok">ptr</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">}</span>
                <span class="tok">ptr</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@alignCast</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@alignOf</span><span class="tok tok-symbol">(</span><span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">load_command</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok">ptr</span> <span class="tok tok-symbol">+</span> <span class="tok">lc</span><span class="tok tok-symbol">.</span><span class="tok">cmdsize</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-symbol">}</span> <span class="tok tok-kw">else</span> <span class="tok tok-symbol">{</span>
                <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">var</span> <span class="tok">opt_debug_line</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">section_64</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">var</span> <span class="tok">opt_debug_info</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">section_64</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">var</span> <span class="tok">opt_debug_abbrev</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">section_64</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">var</span> <span class="tok">opt_debug_str</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">section_64</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">var</span> <span class="tok">opt_debug_ranges</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">?</span><span class="tok tok-symbol">*</span><span class="tok tok-kw">const</span> <span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">section_64</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">const</span> <span class="tok">sections</span> <span class="tok tok-symbol">=</span> <span class="tok tok-builtin">@ptrCast</span><span class="tok tok-symbol">(</span>
                <span class="tok tok-symbol">[</span><span class="tok tok-symbol">*</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">section_64</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-builtin">@alignCast</span><span class="tok tok-symbol">(</span><span class="tok tok-builtin">@alignOf</span><span class="tok tok-symbol">(</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">section_64</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok">ptr</span> <span class="tok tok-symbol">+</span> <span class="tok tok-builtin">@sizeOf</span><span class="tok tok-symbol">(</span><span class="tok">std</span><span class="tok tok-symbol">.</span><span class="tok">macho</span><span class="tok tok-symbol">.</span><span class="tok">segment_command_64</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
            <span class="tok tok-symbol">)</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok">segcmd</span><span class="tok tok-symbol">.</span><span class="tok">nsects</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">for</span> <span class="tok tok-symbol">(</span><span class="tok">sections</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span><span class="tok tok-symbol">*</span><span class="tok">sect</span><span class="tok tok-symbol">|</span> <span class="tok tok-symbol">{</span>
                // The section name may not exceed 16 chars and a trailing null may
                // not be present
                <span class="tok tok-kw">const</span> <span class="tok">name</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">indexOfScalar</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">sect</span><span class="tok tok-symbol">.</span><span class="tok">sectname</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">,</span> <span class="tok tok-number">0</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span><span class="tok">last</span><span class="tok tok-symbol">|</span>
                    <span class="tok">sect</span><span class="tok tok-symbol">.</span><span class="tok">sectname</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok">last</span><span class="tok tok-symbol">]</span>
                <span class="tok tok-kw">else</span>
                    <span class="tok">sect</span><span class="tok tok-symbol">.</span><span class="tok">sectname</span><span class="tok tok-symbol">[</span><span class="tok tok-number">0</span><span class="tok tok-symbol">..</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">;</span>

                <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;__debug_line&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok">opt_debug_line</span> <span class="tok tok-symbol">=</span> <span class="tok">sect</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span> <span class="tok tok-kw">else</span> <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;__debug_info&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok">opt_debug_info</span> <span class="tok tok-symbol">=</span> <span class="tok">sect</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span> <span class="tok tok-kw">else</span> <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;__debug_abbrev&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok">opt_debug_abbrev</span> <span class="tok tok-symbol">=</span> <span class="tok">sect</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span> <span class="tok tok-kw">else</span> <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;__debug_str&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok">opt_debug_str</span> <span class="tok tok-symbol">=</span> <span class="tok">sect</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span> <span class="tok tok-kw">else</span> <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">eql</span><span class="tok tok-symbol">(</span><span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span> <span class="tok">name</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;__debug_ranges&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok">opt_debug_ranges</span> <span class="tok tok-symbol">=</span> <span class="tok">sect</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span>
            <span class="tok tok-symbol">}</span>

            <span class="tok tok-kw">const</span> <span class="tok">debug_line</span> <span class="tok tok-symbol">=</span> <span class="tok">opt_debug_line</span> <span class="tok tok-kw">orelse</span>
                <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">const</span> <span class="tok">debug_info</span> <span class="tok tok-symbol">=</span> <span class="tok">opt_debug_info</span> <span class="tok tok-kw">orelse</span>
                <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">const</span> <span class="tok">debug_str</span> <span class="tok tok-symbol">=</span> <span class="tok">opt_debug_str</span> <span class="tok tok-kw">orelse</span>
                <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">const</span> <span class="tok">debug_abbrev</span> <span class="tok tok-symbol">=</span> <span class="tok">opt_debug_abbrev</span> <span class="tok tok-kw">orelse</span>
                <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">var</span> <span class="tok">di</span> <span class="tok tok-symbol">=</span> <span class="tok">DW</span><span class="tok tok-symbol">.</span><span class="tok">DwarfInfo</span><span class="tok tok-symbol">{</span>
                <span class="tok tok-symbol">.</span><span class="tok">endian</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">.</span><span class="tok">Little</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">.</span><span class="tok">debug_info</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">chopSlice</span><span class="tok tok-symbol">(</span><span class="tok">mapped_mem</span><span class="tok tok-symbol">,</span> <span class="tok">debug_info</span><span class="tok tok-symbol">.</span><span class="tok">offset</span><span class="tok tok-symbol">,</span> <span class="tok">debug_info</span><span class="tok tok-symbol">.</span><span class="tok">size</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">.</span><span class="tok">debug_abbrev</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">chopSlice</span><span class="tok tok-symbol">(</span><span class="tok">mapped_mem</span><span class="tok tok-symbol">,</span> <span class="tok">debug_abbrev</span><span class="tok tok-symbol">.</span><span class="tok">offset</span><span class="tok tok-symbol">,</span> <span class="tok">debug_abbrev</span><span class="tok tok-symbol">.</span><span class="tok">size</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">.</span><span class="tok">debug_str</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">chopSlice</span><span class="tok tok-symbol">(</span><span class="tok">mapped_mem</span><span class="tok tok-symbol">,</span> <span class="tok">debug_str</span><span class="tok tok-symbol">.</span><span class="tok">offset</span><span class="tok tok-symbol">,</span> <span class="tok">debug_str</span><span class="tok tok-symbol">.</span><span class="tok">size</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">.</span><span class="tok">debug_line</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">chopSlice</span><span class="tok tok-symbol">(</span><span class="tok">mapped_mem</span><span class="tok tok-symbol">,</span> <span class="tok">debug_line</span><span class="tok tok-symbol">.</span><span class="tok">offset</span><span class="tok tok-symbol">,</span> <span class="tok">debug_line</span><span class="tok tok-symbol">.</span><span class="tok">size</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">.</span><span class="tok">debug_ranges</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">opt_debug_ranges</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span><span class="tok">debug_ranges</span><span class="tok tok-symbol">|</span>
                    <span class="tok tok-kw">try</span> <span class="tok">chopSlice</span><span class="tok tok-symbol">(</span><span class="tok">mapped_mem</span><span class="tok tok-symbol">,</span> <span class="tok">debug_ranges</span><span class="tok tok-symbol">.</span><span class="tok">offset</span><span class="tok tok-symbol">,</span> <span class="tok">debug_ranges</span><span class="tok tok-symbol">.</span><span class="tok">size</span><span class="tok tok-symbol">)</span>
                <span class="tok tok-kw">else</span>
                    <span class="tok tok-null">null</span><span class="tok tok-symbol">,</span>
            <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">try</span> <span class="tok">DW</span><span class="tok tok-symbol">.</span><span class="tok">openDwarfDebugInfo</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">&amp;</span><span class="tok">di</span><span class="tok tok-symbol">,</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">allocator</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            // Add the debug info to the cache
            <span class="tok tok-kw">try</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">ofiles</span><span class="tok tok-symbol">.</span><span class="tok">putNoClobber</span><span class="tok tok-symbol">(</span><span class="tok">o_file_path</span><span class="tok tok-symbol">,</span> <span class="tok">di</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">return</span> <span class="tok">di</span><span class="tok tok-symbol">;</span>
        <span class="tok tok-symbol">}</span>

        <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">getSymbolAtAddress</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok">address</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">SymbolInfo</span> <span class="tok tok-symbol">{</span>
            <span class="tok tok-kw">nosuspend</span> <span class="tok tok-symbol">{</span>
                // Translate the VA into an address into this object
                <span class="tok tok-kw">const</span> <span class="tok">relocated_address</span> <span class="tok tok-symbol">=</span> <span class="tok">address</span> <span class="tok tok-symbol">-</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">base_address</span><span class="tok tok-symbol">;</span>
                <span class="tok">assert</span><span class="tok tok-symbol">(</span><span class="tok">relocated_address</span> <span class="tok tok-symbol">&gt;=</span> <span class="tok tok-number">0x100000000</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

                // Find the .o file where this symbol is defined
                <span class="tok tok-kw">const</span> <span class="tok">symbol</span> <span class="tok tok-symbol">=</span> <span class="tok">machoSearchSymbols</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">symbols</span><span class="tok tok-symbol">,</span> <span class="tok">relocated_address</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">orelse</span>
                    <span class="tok tok-kw">return</span> <span class="tok">SymbolInfo</span><span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>

                // Take the symbol name from the N_FUN STAB entry, we're going to
                // use it if we fail to find the DWARF infos
                <span class="tok tok-kw">const</span> <span class="tok">stab_symbol</span> <span class="tok tok-symbol">=</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">spanZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">strings</span><span class="tok tok-symbol">[</span><span class="tok">symbol</span><span class="tok tok-symbol">.</span><span class="tok">nlist</span><span class="tok tok-symbol">.</span><span class="tok">n_strx</span><span class="tok tok-symbol">..</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

                <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">symbol</span><span class="tok tok-symbol">.</span><span class="tok">ofile</span> <span class="tok tok-symbol">==</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">)</span>
                    <span class="tok tok-kw">return</span> <span class="tok">SymbolInfo</span><span class="tok tok-symbol">{</span> <span class="tok tok-symbol">.</span><span class="tok">symbol_name</span> <span class="tok tok-symbol">=</span> <span class="tok">stab_symbol</span> <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>

                <span class="tok tok-kw">const</span> <span class="tok">o_file_path</span> <span class="tok tok-symbol">=</span> <span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">spanZ</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">strings</span><span class="tok tok-symbol">[</span><span class="tok">symbol</span><span class="tok tok-symbol">.</span><span class="tok">ofile</span><span class="tok tok-symbol">.</span><span class="tok tok-symbol">?</span><span class="tok tok-symbol">.</span><span class="tok">n_strx</span><span class="tok tok-symbol">..</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

                // Check if its debug infos are already in the cache
                <span class="tok tok-kw">var</span> <span class="tok">o_file_di</span> <span class="tok tok-symbol">=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">ofiles</span><span class="tok tok-symbol">.</span><span class="tok">get</span><span class="tok tok-symbol">(</span><span class="tok">o_file_path</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">orelse</span>
                    <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">loadOFile</span><span class="tok tok-symbol">(</span><span class="tok">o_file_path</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">FileNotFound</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">InvalidDebugInfo</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">return</span> <span class="tok">SymbolInfo</span><span class="tok tok-symbol">{</span> <span class="tok tok-symbol">.</span><span class="tok">symbol_name</span> <span class="tok tok-symbol">=</span> <span class="tok">stab_symbol</span> <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">err</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">}</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

                // Translate again the address, this time into an address inside the
                // .o file
                <span class="tok tok-kw">const</span> <span class="tok">relocated_address_o</span> <span class="tok tok-symbol">=</span> <span class="tok">relocated_address</span> <span class="tok tok-symbol">-</span> <span class="tok">symbol</span><span class="tok tok-symbol">.</span><span class="tok">reloc</span><span class="tok tok-symbol">;</span>

                <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">o_file_di</span><span class="tok tok-symbol">.</span><span class="tok">findCompileUnit</span><span class="tok tok-symbol">(</span><span class="tok">relocated_address_o</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span><span class="tok">compile_unit</span><span class="tok tok-symbol">|</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">return</span> <span class="tok">SymbolInfo</span><span class="tok tok-symbol">{</span>
                        <span class="tok tok-symbol">.</span><span class="tok">symbol_name</span> <span class="tok tok-symbol">=</span> <span class="tok">o_file_di</span><span class="tok tok-symbol">.</span><span class="tok">getSymbolName</span><span class="tok tok-symbol">(</span><span class="tok">relocated_address_o</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">orelse</span> <span class="tok tok-str">&quot;???&quot;</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">.</span><span class="tok">compile_unit_name</span> <span class="tok tok-symbol">=</span> <span class="tok">compile_unit</span><span class="tok tok-symbol">.</span><span class="tok">die</span><span class="tok tok-symbol">.</span><span class="tok">getAttrString</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">&amp;</span><span class="tok">o_file_di</span><span class="tok tok-symbol">,</span> <span class="tok">DW</span><span class="tok tok-symbol">.</span><span class="tok">AT_name</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                            <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">,</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">InvalidDebugInfo</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-str">&quot;???&quot;</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">err</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">.</span><span class="tok">line_info</span> <span class="tok tok-symbol">=</span> <span class="tok">o_file_di</span><span class="tok tok-symbol">.</span><span class="tok">getLineNumberInfo</span><span class="tok tok-symbol">(</span><span class="tok">compile_unit</span><span class="tok tok-symbol">.*</span><span class="tok tok-symbol">,</span> <span class="tok">relocated_address_o</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                            <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">,</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">InvalidDebugInfo</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">,</span>
                            <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">err</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span> <span class="tok tok-kw">else</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">,</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">InvalidDebugInfo</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">return</span> <span class="tok">SymbolInfo</span><span class="tok tok-symbol">{</span> <span class="tok tok-symbol">.</span><span class="tok">symbol_name</span> <span class="tok tok-symbol">=</span> <span class="tok">stab_symbol</span> <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">err</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">}</span>

                <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-symbol">}</span>
        <span class="tok tok-symbol">}</span>
    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">.</span><span class="tok">uefi</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">windows</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">struct</span> <span class="tok tok-symbol">{</span>
        <span class="tok">base_address</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
        <span class="tok">pdb</span><span class="tok tok-symbol">:</span> <span class="tok">pdb</span><span class="tok tok-symbol">.</span><span class="tok">Pdb</span><span class="tok tok-symbol">,</span>
        <span class="tok">coff</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">coff</span><span class="tok tok-symbol">.</span><span class="tok">Coff</span><span class="tok tok-symbol">,</span>

        <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">allocator</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">*</span><span class="tok">mem</span><span class="tok tok-symbol">.</span><span class="tok">Allocator</span> <span class="tok tok-symbol">{</span>
            <span class="tok tok-kw">return</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">coff</span><span class="tok tok-symbol">.</span><span class="tok">allocator</span><span class="tok tok-symbol">;</span>
        <span class="tok tok-symbol">}</span>

        <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">getSymbolAtAddress</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok">address</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">SymbolInfo</span> <span class="tok tok-symbol">{</span>
            // Translate the VA into an address into this object
            <span class="tok tok-kw">const</span> <span class="tok">relocated_address</span> <span class="tok tok-symbol">=</span> <span class="tok">address</span> <span class="tok tok-symbol">-</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">base_address</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">var</span> <span class="tok">coff_section</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok">coff</span><span class="tok tok-symbol">.</span><span class="tok">Section</span> <span class="tok tok-symbol">=</span> <span class="tok tok-null">undefined</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">const</span> <span class="tok">mod_index</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">for</span> <span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">pdb</span><span class="tok tok-symbol">.</span><span class="tok">sect_contribs</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span><span class="tok">sect_contrib</span><span class="tok tok-symbol">|</span> <span class="tok tok-symbol">{</span>
                <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">sect_contrib</span><span class="tok tok-symbol">.</span><span class="tok">Section</span> <span class="tok tok-symbol">&gt;</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">coff</span><span class="tok tok-symbol">.</span><span class="tok">sections</span><span class="tok tok-symbol">.</span><span class="tok">items</span><span class="tok tok-symbol">.</span><span class="tok">len</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">continue</span><span class="tok tok-symbol">;</span>
                // Remember that SectionContribEntry.Section is 1-based.
                <span class="tok">coff_section</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">coff</span><span class="tok tok-symbol">.</span><span class="tok">sections</span><span class="tok tok-symbol">.</span><span class="tok">items</span><span class="tok tok-symbol">[</span><span class="tok">sect_contrib</span><span class="tok tok-symbol">.</span><span class="tok">Section</span> <span class="tok tok-symbol">-</span> <span class="tok tok-number">1</span><span class="tok tok-symbol">]</span><span class="tok tok-symbol">;</span>

                <span class="tok tok-kw">const</span> <span class="tok">vaddr_start</span> <span class="tok tok-symbol">=</span> <span class="tok">coff_section</span><span class="tok tok-symbol">.</span><span class="tok">header</span><span class="tok tok-symbol">.</span><span class="tok">virtual_address</span> <span class="tok tok-symbol">+</span> <span class="tok">sect_contrib</span><span class="tok tok-symbol">.</span><span class="tok">Offset</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-kw">const</span> <span class="tok">vaddr_end</span> <span class="tok tok-symbol">=</span> <span class="tok">vaddr_start</span> <span class="tok tok-symbol">+</span> <span class="tok">sect_contrib</span><span class="tok tok-symbol">.</span><span class="tok">Size</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok">relocated_address</span> <span class="tok tok-symbol">&gt;=</span> <span class="tok">vaddr_start</span> <span class="tok tok-kw">and</span> <span class="tok">relocated_address</span> <span class="tok tok-symbol">&lt;</span> <span class="tok">vaddr_end</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">break</span> <span class="tok">sect_contrib</span><span class="tok tok-symbol">.</span><span class="tok">ModuleIndex</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span>
            <span class="tok tok-symbol">}</span> <span class="tok tok-kw">else</span> <span class="tok tok-symbol">{</span>
                // we have no information to add to the address
                <span class="tok tok-kw">return</span> <span class="tok">SymbolInfo</span><span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">const</span> <span class="tok">module</span> <span class="tok tok-symbol">=</span> <span class="tok tok-symbol">(</span><span class="tok tok-kw">try</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">pdb</span><span class="tok tok-symbol">.</span><span class="tok">getModule</span><span class="tok tok-symbol">(</span><span class="tok">mod_index</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">orelse</span>
                <span class="tok tok-kw">return</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">InvalidDebugInfo</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">const</span> <span class="tok">obj_basename</span> <span class="tok tok-symbol">=</span> <span class="tok">fs</span><span class="tok tok-symbol">.</span><span class="tok">path</span><span class="tok tok-symbol">.</span><span class="tok">basename</span><span class="tok tok-symbol">(</span><span class="tok">module</span><span class="tok tok-symbol">.</span><span class="tok">obj_file_name</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">const</span> <span class="tok">symbol_name</span> <span class="tok tok-symbol">=</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">pdb</span><span class="tok tok-symbol">.</span><span class="tok">getSymbolName</span><span class="tok tok-symbol">(</span>
                <span class="tok">module</span><span class="tok tok-symbol">,</span>
                <span class="tok">relocated_address</span> <span class="tok tok-symbol">-</span> <span class="tok">coff_section</span><span class="tok tok-symbol">.</span><span class="tok">header</span><span class="tok tok-symbol">.</span><span class="tok">virtual_address</span><span class="tok tok-symbol">,</span>
            <span class="tok tok-symbol">)</span> <span class="tok tok-kw">orelse</span> <span class="tok tok-str">&quot;???&quot;</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-kw">const</span> <span class="tok">opt_line_info</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">try</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">pdb</span><span class="tok tok-symbol">.</span><span class="tok">getLineNumberInfo</span><span class="tok tok-symbol">(</span>
                <span class="tok">module</span><span class="tok tok-symbol">,</span>
                <span class="tok">relocated_address</span> <span class="tok tok-symbol">-</span> <span class="tok">coff_section</span><span class="tok tok-symbol">.</span><span class="tok">header</span><span class="tok tok-symbol">.</span><span class="tok">virtual_address</span><span class="tok tok-symbol">,</span>
            <span class="tok tok-symbol">)</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">return</span> <span class="tok">SymbolInfo</span><span class="tok tok-symbol">{</span>
                <span class="tok tok-symbol">.</span><span class="tok">symbol_name</span> <span class="tok tok-symbol">=</span> <span class="tok">symbol_name</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">.</span><span class="tok">compile_unit_name</span> <span class="tok tok-symbol">=</span> <span class="tok">obj_basename</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">.</span><span class="tok">line_info</span> <span class="tok tok-symbol">=</span> <span class="tok">opt_line_info</span><span class="tok tok-symbol">,</span>
            <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
        <span class="tok tok-symbol">}</span>
    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">.</span><span class="tok">linux</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">netbsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">freebsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">dragonfly</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">openbsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">haiku</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">struct</span> <span class="tok tok-symbol">{</span>
        <span class="tok">base_address</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">,</span>
        <span class="tok">dwarf</span><span class="tok tok-symbol">:</span> <span class="tok">DW</span><span class="tok tok-symbol">.</span><span class="tok">DwarfInfo</span><span class="tok tok-symbol">,</span>
        <span class="tok">mapped_memory</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">[</span><span class="tok tok-symbol">]</span><span class="tok tok-kw">const</span> <span class="tok tok-type">u8</span><span class="tok tok-symbol">,</span>

        <span class="tok tok-kw">pub</span> <span class="tok tok-kw">fn</span> <span class="tok tok-fn">getSymbolAtAddress</span><span class="tok tok-symbol">(</span><span class="tok">self</span><span class="tok tok-symbol">:</span> <span class="tok tok-symbol">*</span><span class="tok tok-builtin">@This</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span> <span class="tok">address</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">usize</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">!</span><span class="tok">SymbolInfo</span> <span class="tok tok-symbol">{</span>
            // Translate the VA into an address into this object
            <span class="tok tok-kw">const</span> <span class="tok">relocated_address</span> <span class="tok tok-symbol">=</span> <span class="tok">address</span> <span class="tok tok-symbol">-</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">base_address</span><span class="tok tok-symbol">;</span>

            <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok tok-kw">nosuspend</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dwarf</span><span class="tok tok-symbol">.</span><span class="tok">findCompileUnit</span><span class="tok tok-symbol">(</span><span class="tok">relocated_address</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">|</span><span class="tok">compile_unit</span><span class="tok tok-symbol">|</span> <span class="tok tok-symbol">{</span>
                <span class="tok tok-kw">return</span> <span class="tok">SymbolInfo</span><span class="tok tok-symbol">{</span>
                    <span class="tok tok-symbol">.</span><span class="tok">symbol_name</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">nosuspend</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dwarf</span><span class="tok tok-symbol">.</span><span class="tok">getSymbolName</span><span class="tok tok-symbol">(</span><span class="tok">relocated_address</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">orelse</span> <span class="tok tok-str">&quot;???&quot;</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">.</span><span class="tok">compile_unit_name</span> <span class="tok tok-symbol">=</span> <span class="tok">compile_unit</span><span class="tok tok-symbol">.</span><span class="tok">die</span><span class="tok tok-symbol">.</span><span class="tok">getAttrString</span><span class="tok tok-symbol">(</span><span class="tok tok-symbol">&amp;</span><span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dwarf</span><span class="tok tok-symbol">,</span> <span class="tok">DW</span><span class="tok tok-symbol">.</span><span class="tok">AT_name</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">,</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">InvalidDebugInfo</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-str">&quot;???&quot;</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">err</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">.</span><span class="tok">line_info</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">nosuspend</span> <span class="tok">self</span><span class="tok tok-symbol">.</span><span class="tok">dwarf</span><span class="tok tok-symbol">.</span><span class="tok">getLineNumberInfo</span><span class="tok tok-symbol">(</span><span class="tok">compile_unit</span><span class="tok tok-symbol">.*</span><span class="tok tok-symbol">,</span> <span class="tok">relocated_address</span><span class="tok tok-symbol">)</span> <span class="tok tok-kw">catch</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                        <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">,</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">InvalidDebugInfo</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">null</span><span class="tok tok-symbol">,</span>
                        <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">err</span><span class="tok tok-symbol">,</span>
                    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
            <span class="tok tok-symbol">}</span> <span class="tok tok-kw">else</span> <span class="tok tok-symbol">|</span><span class="tok">err</span><span class="tok tok-symbol">|</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">err</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
                <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">MissingDebugInfo</span><span class="tok tok-symbol">,</span> <span class="tok tok-kw">error</span><span class="tok tok-symbol">.</span><span class="tok">InvalidDebugInfo</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-symbol">{</span>
                    <span class="tok tok-kw">return</span> <span class="tok">SymbolInfo</span><span class="tok tok-symbol">{</span><span class="tok tok-symbol">}</span><span class="tok tok-symbol">;</span>
                <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
                <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-kw">return</span> <span class="tok">err</span><span class="tok tok-symbol">,</span>
            <span class="tok tok-symbol">}</span>

            <span class="tok tok-kw">unreachable</span><span class="tok tok-symbol">;</span>
        <span class="tok tok-symbol">}</span>
    <span class="tok tok-symbol">}</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok">DW</span><span class="tok tok-symbol">.</span><span class="tok">DwarfInfo</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><b>Whether or not the current target can print useful debug information when a segfault occurs.
</b><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">have_segfault_handling_support</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">switch</span> <span class="tok tok-symbol">(</span><span class="tok">native_os</span><span class="tok tok-symbol">)</span> <span class="tok tok-symbol">{</span>
    <span class="tok tok-symbol">.</span><span class="tok">linux</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">netbsd</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">true</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">.</span><span class="tok">windows</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">true</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-symbol">.</span><span class="tok">freebsd</span><span class="tok tok-symbol">,</span> <span class="tok tok-symbol">.</span><span class="tok">openbsd</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-builtin">@hasDecl</span><span class="tok tok-symbol">(</span><span class="tok">os</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;ucontext_t&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">,</span>
    <span class="tok tok-kw">else</span> <span class="tok tok-symbol">=&gt;</span> <span class="tok tok-null">false</span><span class="tok tok-symbol">,</span>
<span class="tok tok-symbol">}</span></code></pre></div><div class="anal-decl"><pre><code class="zig"><span class="tok tok-kw">const</span> <span class="tok">enable_segfault_handler</span><span class="tok tok-symbol">:</span> <span class="tok tok-type">bool</span> <span class="tok tok-symbol">=</span> <span class="tok tok-kw">if</span> <span class="tok tok-symbol">(</span><span class="tok tok-builtin">@hasDecl</span><span class="tok tok-symbol">(</span><span class="tok">root</span><span class="tok tok-symbol">,</span> <span class="tok tok-str">&quot;enable_segfault_handler&quot;</span><span class="tok tok-symbol">)</span><span class="tok tok-symbol">)</span>
    <span class="tok">root</span><span class="tok tok-symbol">.</span><span class="tok">enable_segfault_handler</span>
<span class="tok tok-kw">else</span>
    <span class="tok">runtime_safety</span> <span class="tok tok-kw">and</span> <span class="tok">have_segfault_handling_support</span></code></pre></div></div></html>